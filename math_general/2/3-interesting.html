<!doctype html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–ú—è—É-–ê–∫–∞–¥–µ–º—ñ—è: –ú–∞–π—Å—Ç–µ—Ä –†—ñ–≤–µ–Ω—å (Final)</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@700&display=swap");

      :root {
        --bg-gradient: linear-gradient(120deg, #84fab0 0%, #8fd3f4 100%);
        --card-bg: #ffffff;
        --primary: #6c5ce7;
        --secondary: #00cec9;
        --accent: #fd79a8;
        --text: #2d3436;
        --retry: #ff7675;
      }

      body {
        font-family: "Nunito", sans-serif;
        background: var(--bg-gradient);
        margin: 0;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
        user-select: none;
        color: var(--text);
      }

      .container {
        width: 950px;
        height: 700px;
        background: var(--card-bg);
        border-radius: 40px;
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        position: relative;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        border: 8px solid #fff;
      }

      /* --- –°–ª–∞–π–¥–∏ --- */
      .slide {
        flex: 1;
        display: none;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 20px;
        animation: fadeIn 0.6s cubic-bezier(0.25, 1, 0.5, 1);
        position: relative;
      }
      .slide.active {
        display: flex;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: scale(0.95);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      h1 {
        font-family: "Fredoka One";
        color: var(--primary);
        font-size: 3rem;
        margin: 10px;
        text-align: center;
        text-shadow: 2px 2px 0px #eee;
      }
      h2 {
        font-family: "Fredoka One";
        color: var(--text);
        font-size: 2.2rem;
        margin-bottom: 20px;
      }
      p {
        font-size: 1.4rem;
        text-align: center;
        max-width: 800px;
        color: #636e72;
      }

      /* --- –ö–Ω–æ–ø–∫–∏ --- */
      .nav-area {
        position: absolute;
        bottom: 30px;
        right: 40px;
        z-index: 100;
      }

      .btn {
        background: var(--primary);
        color: white;
        border: none;
        padding: 15px 40px;
        font-size: 1.5rem;
        border-radius: 50px;
        cursor: pointer;
        font-family: "Fredoka One";
        box-shadow: 0 6px 0 #4834d4;
        transition: all 0.2s;
        margin: 0 5px;
      }
      .btn:active {
        transform: translateY(4px);
        box-shadow: 0 2px 0 #4834d4;
      }

      .btn-success {
        background: #00b894;
        box-shadow: 0 6px 0 #00896f;
        display: none;
      }
      .btn-success:active {
        box-shadow: 0 2px 0 #00896f;
      }

      .btn-retry {
        background: var(--retry);
        box-shadow: 0 6px 0 #d63031;
        display: none;
      }
      .btn-retry:active {
        box-shadow: 0 2px 0 #d63031;
      }

      /* --- –í–Ü–ó–£–ê–õ–Ü–ó–ê–¶–Ü–Ø 1: –ñ–ê–ë–ö–ê --- */
      .frog-container {
        width: 800px;
        height: 150px;
        position: relative;
        margin-top: 50px;
        border-bottom: 6px solid #b2bec3;
      }
      .tick {
        position: absolute;
        bottom: -40px;
        width: 2px;
        height: 10px;
        background: #b2bec3;
        font-weight: bold;
        display: flex;
        justify-content: center;
      }
      .tick span {
        margin-top: 15px;
        font-size: 1.2rem;
      }
      .frog {
        position: absolute;
        bottom: 10px;
        font-size: 4rem;
        transition:
          left 0.8s cubic-bezier(0.5, 0, 0.5, 1),
          bottom 0.4s ease-in-out;
        z-index: 10;
      }
      @keyframes jumpArc {
        0% {
          bottom: 10px;
        }
        50% {
          bottom: 80px;
        }
        100% {
          bottom: 10px;
        }
      }

      /* --- –í–Ü–ó–£–ê–õ–Ü–ó–ê–¶–Ü–Ø 2: –í–ê–†–ï–ù–ù–Ø --- */
      .jam-zone {
        display: flex;
        gap: 50px;
        align-items: center;
        justify-content: center;
        height: 250px;
      }
      .berry-box {
        width: 200px;
        height: 150px;
        border: 4px dashed var(--accent);
        border-radius: 20px;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        align-content: center;
        padding: 10px;
      }
      .berry {
        font-size: 2rem;
        margin: 2px;
        transition: 0.5s;
      }
      .pot {
        font-size: 7rem;
        cursor: pointer;
        transition: 0.3s;
      }
      .pot:hover {
        transform: scale(1.1) rotate(5deg);
      }
      .shelf {
        width: 150px;
        height: 10px;
        background: #fab1a0;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: flex-end;
      }
      .jar {
        font-size: 4rem;
        position: absolute;
        bottom: 10px;
        animation: popUp 0.5s;
      }

      /* --- –í–Ü–ó–£–ê–õ–Ü–ó–ê–¶–Ü–Ø 3: –ö–û–°–ú–Ü–ß–ù–Ü –ö–†–ò–°–¢–ê–õ–ò --- */
      .space-zone {
        width: 800px;
        height: 300px;
        background: #2d3436;
        border-radius: 20px;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 50px;
      }
      .star {
        font-size: 1.5rem;
        position: absolute;
        color: #ffeaa7;
        transition: all 1s ease;
      }
      .crystal-slot {
        width: 100px;
        height: 100px;
        border: 2px dashed rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        color: white;
      }
      .mega-crystal {
        font-size: 5rem;
        animation: spin 4s linear infinite;
        filter: drop-shadow(0 0 20px #74b9ff);
      }
      @keyframes spin {
        100% {
          transform: rotate(360deg);
        }
      }

      /* --- –ü–†–ê–ö–¢–ò–ö–ê & –ë–õ–Ü–¶ --- */
      .grid-3 {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 30px;
        width: 100%;
      }
      .task-card {
        background: #fff;
        border: 3px solid #dfe6e9;
        border-radius: 25px;
        padding: 25px;
        text-align: center;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
        transition: transform 0.2s;
      }
      .task-card:hover {
        transform: translateY(-5px);
        border-color: var(--secondary);
      }
      .task-text {
        font-size: 2.5rem;
        font-family: "Fredoka One";
        color: var(--text);
        margin-bottom: 15px;
      }

      .blitz-wrapper {
        background: white;
        border: 6px solid var(--accent);
        border-radius: 40px;
        padding: 50px 100px;
        text-align: center;
        box-shadow: 0 20px 0 rgba(0, 0, 0, 0.1);
      }
      .blitz-num {
        font-size: 5rem;
        font-family: "Fredoka One";
        color: var(--text);
        margin-bottom: 20px;
      }

      /* --- Inputs --- */
      input {
        width: 120px;
        height: 70px;
        font-size: 2.5rem;
        text-align: center;
        border: 4px solid #b2bec3;
        border-radius: 15px;
        outline: none;
        font-family: "Fredoka One";
        background: #f1f2f6;
        transition: 0.3s;
      }
      input:focus {
        border-color: var(--primary);
        background: #fff;
      }
      input.correct {
        border-color: #00b894;
        background-color: #dff9fb;
        color: #00b894;
        pointer-events: none;
      }
      input.wrong {
        border-color: #ff7675;
        animation: shake 0.4s;
      }

      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-10px);
        }
        75% {
          transform: translateX(10px);
        }
      }
      @keyframes popUp {
        0% {
          transform: scale(0);
        }
        80% {
          transform: scale(1.2);
        }
        100% {
          transform: scale(1);
        }
      }

      .progress-line {
        position: absolute;
        top: 0;
        left: 0;
        height: 10px;
        background: var(--secondary);
        width: 0%;
        transition: width 0.5s;
      }
      .mascot {
        position: absolute;
        bottom: 20px;
        left: 20px;
        font-size: 6rem;
        z-index: 50;
        transform: rotate(-10deg);
        filter: drop-shadow(5px 5px 0 rgba(0, 0, 0, 0.1));
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="progress-line" id="progress"></div>
      <div class="mascot" id="mascot">üê±</div>

      <div class="slide active" id="slide-1">
        <h1>–ú—è—É-–ê–∫–∞–¥–µ–º—ñ—è: –ü—Ä–æ—Ñ—ñ</h1>
        <p>–ü—Ä–∏–≤—ñ—Ç! –°—å–æ–≥–æ–¥–Ω—ñ –º–∏ –ø—Ä–∞—Ü—é—î–º–æ –∑ <b>–í–ï–õ–ò–ö–ò–ú–ò</b> —á–∏—Å–ª–∞–º–∏.</p>
        <p>–î–≤–æ—Ü–∏—Ñ—Ä–æ–≤—ñ + –î–≤–æ—Ü–∏—Ñ—Ä–æ–≤—ñ. –¢–∏ –≥–æ—Ç–æ–≤–∞?</p>
        <div style="font-size: 6rem; margin: 30px">üöÄüìöüêÜ</div>
        <button class="btn" onclick="nextSlide()">–ü–æ—á–∞—Ç–∏ —É—Ä–æ–∫</button>
      </div>

      <div class="slide" id="slide-2">
        <h2>–ü—Ä–∞–≤–∏–ª–æ 1: –î–æ–ø–æ–≤–Ω–∏ –î–µ—Å—è—Ç–æ–∫</h2>
        <p>–£ –Ω–∞—Å —î —á–∏—Å–ª–æ 28. –©–æ–± —Å—Ç–∞–ª–æ 30, —Ç—Ä–µ–±–∞ —â–µ 2 –ø–∞—Å–∞–∂–∏—Ä–∏.</p>
        <div class="jam-zone">
          <div style="font-size: 8rem">üöå</div>
          <div style="font-size: 3rem">+</div>
          <div style="font-size: 4rem">üêàüêà</div>
        </div>
        <p>–ó–∞–≤–∂–¥–∏ —Å–ø–æ—á–∞—Ç–∫—É —Ä–æ–±–∏–º–æ "–∫—Ä—É–≥–ª–µ" —á–∏—Å–ª–æ!</p>
        <button class="btn" onclick="nextSlide()">–ó—Ä–æ–∑—É–º—ñ–ª–æ</button>
      </div>

      <div class="slide" id="slide-3">
        <h2>–ñ–∞–±–∫–∞-–ú–∞—Ç–µ–º–∞—Ç–∏–∫ üê∏</h2>
        <p>–ü—Ä–∏–∫–ª–∞–¥: <b>28 + 5</b>. –°–ø–æ—á–∞—Ç–∫—É —Å—Ç—Ä–∏–±–∞—î–º–æ –¥–æ 30!</p>

        <div class="frog-container" id="frog-track"></div>

        <h3 id="frog-status" style="margin-top: 20px; color: var(--primary)">
          –°—Ç–∞—Ä—Ç –Ω–∞ 28. –°–∫—ñ–ª—å–∫–∏ –¥–æ 30?
        </h3>

        <div style="margin-top: 20px">
          <button class="btn" id="btn-frog-1" onclick="frogJump1()">
            –°—Ç—Ä–∏–±–Ω—É—Ç–∏ (+2)
          </button>
          <button class="btn btn-success" id="btn-frog-2" onclick="frogJump2()">
            –î–æ—Å—Ç—Ä–∏–±–∞—Ç–∏ —Ä–µ—à—Ç—É (+3)
          </button>
          <button
            class="btn btn-retry"
            id="btn-frog-retry"
            onclick="resetFrog()"
          >
            –©–µ —Ä–∞–∑ ‚Ü∫
          </button>
          <button
            class="btn btn-success"
            id="btn-frog-next"
            onclick="nextSlide()"
          >
            –î–∞–ª—ñ
          </button>
        </div>
      </div>

      <div class="slide" id="slide-4">
        <h2>–í–∞—Ä–µ–Ω–Ω—è –∑ –ü–æ–ª—É–Ω–∏—Ü—å üçì</h2>
        <p>
          –ü—Ä–∏–∫–ª–∞–¥: <b>47 + 6</b>. –£ –Ω–∞—Å 7 —è–≥—ñ–¥, —Ç—Ä–µ–±–∞ —â–µ 3, —â–æ–± –≤–∏–π—à–ª–∞ –±–∞–Ω–∫–∞!
        </p>
        <div class="jam-zone">
          <div class="berry-box" id="berry-box"></div>
          <div class="pot" id="pot" onclick="makeJam()">ü•£</div>
          <div class="shelf" id="shelf"></div>
        </div>
        <p id="jam-hint">–ù–∞—Ç–∏—Å–Ω–∏ –Ω–∞ –º–∏—Å–∫—É, —â–æ–± –∑–≤–∞—Ä–∏—Ç–∏ 10 —è–≥—ñ–¥ —É –±–∞–Ω–∫—É!</p>
        <button class="btn btn-retry" id="btn-jam-retry" onclick="resetJam()">
          –©–µ —Ä–∞–∑ ‚Ü∫
        </button>
        <button class="btn btn-success" id="btn-jam-next" onclick="nextSlide()">
          –°–º–∞–∫–æ—Ç–∞!
        </button>
      </div>

      <div class="slide" id="slide-5">
        <h2>–†—ñ–≤–µ–Ω—å 1: –†–æ–∑–º–∏–Ω–∫–∞</h2>
        <div class="grid-3">
          <div class="task-card">
            <div class="task-text">18 + 5</div>
            <input type="number" oninput="check(this, 23)" />
          </div>
          <div class="task-card">
            <div class="task-text">27 + 4</div>
            <input type="number" oninput="check(this, 31)" />
          </div>
          <div class="task-card">
            <div class="task-text">39 + 2</div>
            <input type="number" oninput="check(this, 41)" />
          </div>
        </div>
      </div>

      <div class="slide" id="slide-6">
        <h2>–†—ñ–≤–µ–Ω—å 2: –ü—Ä–∏—Å–∫–æ—Ä—é—î–º–æ—Å—å</h2>
        <div class="grid-3">
          <div class="task-card">
            <div class="task-text">25 + 16</div>
            <input type="number" oninput="check(this, 41)" />
          </div>
          <div class="task-card">
            <div class="task-text">38 + 14</div>
            <input type="number" oninput="check(this, 52)" />
          </div>
          <div class="task-card">
            <div class="task-text">47 + 15</div>
            <input type="number" oninput="check(this, 62)" />
          </div>
        </div>
      </div>

      <div class="slide" id="slide-7">
        <h2>–†—ñ–≤–µ–Ω—å 3: –ú–∞–π—Å—Ç–µ—Ä</h2>
        <div class="grid-3">
          <div class="task-card">
            <div class="task-text">56 + 25</div>
            <input type="number" oninput="check(this, 81)" />
          </div>
          <div class="task-card">
            <div class="task-text">44 + 38</div>
            <input type="number" oninput="check(this, 82)" />
          </div>
          <div class="task-card">
            <div class="task-text">63 + 29</div>
            <input type="number" oninput="check(this, 92)" />
          </div>
        </div>
      </div>

      <div class="slide" id="slide-8">
        <h2>‚ö° –ë–õ–Ü–¶ 1/10 ‚ö°</h2>
        <div class="blitz-wrapper">
          <div class="blitz-num">28 + 34</div>
          <input type="number" oninput="check(this, 62)" />
        </div>
      </div>
      <div class="slide" id="slide-9">
        <h2>‚ö° –ë–õ–Ü–¶ 2/10 ‚ö°</h2>
        <div class="blitz-wrapper">
          <div class="blitz-num">45 + 27</div>
          <input type="number" oninput="check(this, 72)" />
        </div>
      </div>
      <div class="slide" id="slide-10">
        <h2>‚ö° –ë–õ–Ü–¶ 3/10 ‚ö°</h2>
        <div class="blitz-wrapper">
          <div class="blitz-num">36 + 36</div>
          <input type="number" oninput="check(this, 72)" />
        </div>
      </div>
      <div class="slide" id="slide-11">
        <h2>‚ö° –ë–õ–Ü–¶ 4/10 ‚ö°</h2>
        <div class="blitz-wrapper">
          <div class="blitz-num">59 + 13</div>
          <input type="number" oninput="check(this, 72)" />
        </div>
      </div>
      <div class="slide" id="slide-12">
        <h2>‚ö° –ë–õ–Ü–¶ 5/10 ‚ö°</h2>
        <div class="blitz-wrapper">
          <div class="blitz-num">18 + 44</div>
          <input type="number" oninput="check(this, 62)" />
        </div>
      </div>
      <div class="slide" id="slide-13">
        <h2>‚ö° –ë–õ–Ü–¶ 6/10 ‚ö°</h2>
        <div class="blitz-wrapper">
          <div class="blitz-num">67 + 24</div>
          <input type="number" oninput="check(this, 91)" />
        </div>
      </div>
      <div class="slide" id="slide-14">
        <h2>‚ö° –ë–õ–Ü–¶ 7/10 ‚ö°</h2>
        <div class="blitz-wrapper">
          <div class="blitz-num">35 + 48</div>
          <input type="number" oninput="check(this, 83)" />
        </div>
      </div>
      <div class="slide" id="slide-15">
        <h2>‚ö° –ë–õ–Ü–¶ 8/10 ‚ö°</h2>
        <div class="blitz-wrapper">
          <div class="blitz-num">29 + 52</div>
          <input type="number" oninput="check(this, 81)" />
        </div>
      </div>
      <div class="slide" id="slide-16">
        <h2>‚ö° –ë–õ–Ü–¶ 9/10 ‚ö°</h2>
        <div class="blitz-wrapper">
          <div class="blitz-num">74 + 19</div>
          <input type="number" oninput="check(this, 93)" />
        </div>
      </div>
      <div class="slide" id="slide-17">
        <h2>‚ö° –ë–õ–Ü–¶ 10/10 ‚ö°</h2>
        <div class="blitz-wrapper">
          <div class="blitz-num">55 + 37</div>
          <input type="number" oninput="check(this, 92)" />
        </div>
      </div>

      <div class="slide" id="slide-18">
        <h2>–í—ñ–¥–ø–æ—á–∏–Ω–æ–∫: –ö–æ—Å–º—ñ—á–Ω–∞ –ú–∞–≥—ñ—è ‚ú®</h2>
        <p>–ó'—î–¥–Ω–∞–π 10 –∑—ñ—Ä–æ–∫ –≤ –æ–¥–∏–Ω –ú–µ–≥–∞-–ö—Ä–∏—Å—Ç–∞–ª!</p>
        <div class="space-zone" id="space-zone">
          <div class="crystal-slot" id="blackhole"></div>
          <div style="width: 100px"></div>
          <div
            class="crystal-slot"
            id="crystal-target"
            style="border-color: #74b9ff"
          >
            <span style="font-size: 0.8rem; text-align: center"
              >–°–∫–ª–∞–¥ –î–µ—Å—è—Ç–∫—ñ–≤</span
            >
          </div>
        </div>
        <p style="margin-top: 20px">–£ –Ω–∞—Å 12 –ø–∏–ª–∏–Ω–æ–∫.</p>
        <button class="btn" onclick="animateCrystals()" id="btn-crystal">
          –ú–∞–≥—ñ—è –ó–ª–∏—Ç—Ç—è!
        </button>
        <button
          class="btn btn-retry"
          id="btn-crystal-retry"
          onclick="resetCrystals()"
        >
          –©–µ —Ä–∞–∑ ‚Ü∫
        </button>
        <button
          class="btn btn-success"
          id="btn-crystal-next"
          onclick="nextSlide()"
        >
          –í–∞—É!
        </button>
      </div>

      <div class="slide" id="slide-19">
        <h1>–¢–ò - –ì–ï–ù–Ü–ô –ú–ê–¢–ï–ú–ê–¢–ò–ö–ò! üèÜ</h1>
        <p>–í—Å—ñ –∂–∞–±–∫–∏ –¥–æ—Å—Ç—Ä–∏–±–∞–ª–∏, –≤—Å—ñ –∫—Ä–∏—Å—Ç–∞–ª–∏ –∑—ñ–±—Ä–∞–Ω—ñ!</p>
        <div style="font-size: 8rem; margin: 30px">üëëü¶Ñüéâ</div>
        <button class="btn" onclick="location.reload()">–©–µ —Ä–∞–∑?</button>
      </div>

      <div class="nav-area">
        <button
          class="btn btn-success"
          id="main-next-btn"
          onclick="nextSlide()"
        >
          –î–∞–ª—ñ ‚ûî
        </button>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <script>
      let currentSlide = 1;
      const totalSlides = 19;
      const mascot = document.getElementById("mascot");
      const nextBtn = document.getElementById("main-next-btn");

      // --- FROG LOGIC ---
      function initFrog() {
        const track = document.getElementById("frog-track");
        track.innerHTML = '<div class="frog" id="frog">üê∏</div>';

        const startNum = 25;
        const endNum = 35;
        const totalTicks = endNum - startNum;

        for (let i = 0; i <= totalTicks; i++) {
          let num = startNum + i;
          let tick = document.createElement("div");
          tick.className = "tick";
          tick.style.left = i * (100 / totalTicks) + "%";

          let span = document.createElement("span");
          span.innerText = num;
          if (num === 28) {
            span.style.color = "blue";
            span.style.transform = "scale(1.5)";
          }
          if (num === 30) {
            span.style.color = "red";
            span.style.transform = "scale(1.5)";
          }
          tick.appendChild(span);
          track.appendChild(tick);
        }
        let startPercent = 3 * (100 / totalTicks);
        document.getElementById("frog").style.left = startPercent + "%";
      }

      function frogJump1() {
        const totalTicks = 10;
        const targetPercent = 5 * (100 / totalTicks);
        let f = document.getElementById("frog");
        f.style.animation = "jumpArc 0.8s";
        f.style.left = targetPercent + "%";
        document.getElementById("btn-frog-1").style.display = "none";
        document.getElementById("btn-frog-2").style.display = "inline-block";
        document.getElementById("frog-status").innerText =
          "–£—Ä–∞! –ú–∏ –Ω–∞ 30. –õ–∏—à–∏–ª–æ—Å—å –¥–æ–¥–∞—Ç–∏ —â–µ 3!";
      }

      function frogJump2() {
        const totalTicks = 10;
        const targetPercent = 8 * (100 / totalTicks);
        let f = document.getElementById("frog");
        f.style.animation = "none";
        void f.offsetWidth;
        f.style.animation = "jumpArc 0.8s";
        f.style.left = targetPercent + "%";

        document.getElementById("btn-frog-2").style.display = "none";
        document.getElementById("btn-frog-next").style.display = "inline-block";
        document.getElementById("btn-frog-retry").style.display =
          "inline-block";
        document.getElementById("frog-status").innerText = "–§—ñ–Ω—ñ—à! 28 + 5 = 33";
        confetti({ particleCount: 50, origin: { y: 0.6 } });
      }

      function resetFrog() {
        initFrog();
        document.getElementById("btn-frog-1").style.display = "inline-block";
        document.getElementById("btn-frog-2").style.display = "none";
        document.getElementById("btn-frog-next").style.display = "none";
        document.getElementById("btn-frog-retry").style.display = "none";
        document.getElementById("frog-status").innerText =
          "–°—Ç–∞—Ä—Ç –Ω–∞ 28. –°–∫—ñ–ª—å–∫–∏ –¥–æ 30?";
      }

      // --- JAM LOGIC ---
      function initJam() {
        const box = document.getElementById("berry-box");
        box.innerHTML = "";
        for (let i = 0; i < 13; i++) {
          let b = document.createElement("div");
          b.className = "berry";
          b.innerText = "üçì";
          b.id = "b-" + i;
          if (i >= 7) b.style.opacity = "0.5";
          box.appendChild(b);
        }
      }

      function makeJam() {
        for (let i = 0; i < 10; i++) {
          let b = document.getElementById("b-" + i);
          b.style.transform = "translate(150px, 0) scale(0)";
          b.style.opacity = "0";
        }
        setTimeout(() => {
          let jar = document.createElement("div");
          jar.className = "jar";
          jar.innerText = "üè∫";
          document.getElementById("shelf").appendChild(jar);
          document.getElementById("jam-hint").innerText =
            "–£ –Ω–∞—Å 1 –±–∞–Ω–∫–∞ (10) —ñ –ª–∏—à–∏–ª–æ—Å—è 3 —è–≥–æ–¥–∏. –†–∞–∑–æ–º 13!";
          document.getElementById("btn-jam-next").style.display =
            "inline-block";
          document.getElementById("btn-jam-retry").style.display =
            "inline-block";
          confetti({ particleCount: 30, origin: { x: 0.5, y: 0.5 } });
        }, 600);
      }

      function resetJam() {
        initJam();
        document.getElementById("shelf").innerHTML = "";
        document.getElementById("jam-hint").innerText =
          "–ù–∞—Ç–∏—Å–Ω–∏ –Ω–∞ –º–∏—Å–∫—É, —â–æ–± –∑–≤–∞—Ä–∏—Ç–∏ 10 —è–≥—ñ–¥ —É –±–∞–Ω–∫—É!";
        document.getElementById("btn-jam-next").style.display = "none";
        document.getElementById("btn-jam-retry").style.display = "none";
      }

      // --- CRYSTAL LOGIC ---
      function initCrystals() {
        const zone = document.getElementById("space-zone");
        let oldStars = zone.querySelectorAll(".star");
        oldStars.forEach((s) => s.remove());

        for (let i = 0; i < 12; i++) {
          let s = document.createElement("div");
          s.className = "star";
          s.innerText = "‚≠ê";
          s.style.left = Math.random() * 300 + "px";
          s.style.top = Math.random() * 250 + "px";
          s.id = "star-" + i;
          zone.appendChild(s);
        }
        let c = document.getElementById("final-crystal");
        if (c) c.remove();
      }

      function animateCrystals() {
        document.getElementById("btn-crystal").style.display = "none";
        for (let i = 0; i < 10; i++) {
          let s = document.getElementById("star-" + i);
          s.style.left = "50px";
          s.style.top = "120px";
          s.style.opacity = "0";
          s.style.transform = "scale(0)";
        }
        setTimeout(() => {
          let mega = document.createElement("div");
          mega.className = "mega-crystal";
          mega.innerText = "üíé";
          mega.id = "final-crystal";
          document.getElementById("crystal-target").appendChild(mega);
          document.getElementById("btn-crystal-next").style.display =
            "inline-block";
          document.getElementById("btn-crystal-retry").style.display =
            "inline-block";
          confetti({ particleCount: 100, spread: 70 });
        }, 1000);
      }

      function resetCrystals() {
        initCrystals();
        document.getElementById("btn-crystal").style.display = "inline-block";
        document.getElementById("btn-crystal-next").style.display = "none";
        document.getElementById("btn-crystal-retry").style.display = "none";
      }

      // --- GENERAL ---
      function nextSlide() {
        document
          .getElementById(`slide-${currentSlide}`)
          .classList.remove("active");
        currentSlide++;

        if (currentSlide > totalSlides) currentSlide = 1;

        let nextS = document.getElementById(`slide-${currentSlide}`);
        nextS.classList.add("active");

        if (currentSlide === 3) initFrog();
        if (currentSlide === 4) initJam();
        if (currentSlide === 18) initCrystals();
        if (currentSlide === 19) confetti({ particleCount: 300, spread: 200 });

        let p = ((currentSlide - 1) / (totalSlides - 1)) * 100;
        document.getElementById("progress").style.width = p + "%";
        nextBtn.style.display = "none";

        if (currentSlide >= 8 && currentSlide <= 17) mascot.innerText = "üêØ";
        else if (currentSlide === 19) mascot.innerText = "ü¶Å";
        else mascot.innerText = "üê±";
      }

      function check(input, correct) {
        if (parseInt(input.value) === correct) {
          input.classList.add("correct");
          input.classList.remove("wrong");
          input.blur();

          let slide = input.closest(".slide");
          let allInputs = slide.querySelectorAll("input");
          let correctInputs = slide.querySelectorAll("input.correct");

          if (allInputs.length === correctInputs.length) {
            confetti({ particleCount: 40, origin: { y: 0.7 } });
            nextBtn.style.display = "inline-block";
            if (currentSlide >= 8 && currentSlide <= 17) {
              setTimeout(() => nextSlide(), 800);
            }
          }
        } else {
          if (input.value.length >= String(correct).length) {
            input.classList.add("wrong");
            setTimeout(() => input.classList.remove("wrong"), 500);
          }
        }
      }
    </script>
  </body>
</html>
