<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∞ –ü—Ä–∏–≥–æ–¥–∞</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Mali:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --primary: #ff9aa2;
        --secondary: #b5ead7;
        --accent: #ffdac1;
        --text: #555;
        --bg: #fff9fa;
        --correct: #95d5b2;
        --wrong: #ffb7b2;
      }

      body {
        font-family: "Mali", cursive;
        background-color: var(--bg);
        color: var(--text);
        margin: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        background: white;
        border-radius: 25px;
        box-shadow: 0 10px 25px rgba(255, 154, 162, 0.3);
        width: 100%;
        max-width: 600px;
        padding: 30px;
        text-align: center;
        position: relative;
        overflow: hidden;
        border: 4px solid var(--secondary);
      }

      h1 {
        color: var(--primary);
        font-size: 2.2em;
        margin-bottom: 10px;
      }

      .progress-bar {
        width: 100%;
        height: 15px;
        background-color: #f0f0f0;
        border-radius: 10px;
        margin-bottom: 20px;
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        background-color: var(--primary);
        width: 0%;
        transition: width 0.5s ease;
      }

      .question-box {
        font-size: 1.8em;
        margin: 30px 0;
        padding: 20px;
        background-color: var(--accent);
        border-radius: 15px;
        font-weight: bold;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100px;
        white-space: nowrap;
        overflow-x: auto;
      }

      .options-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
      }

      button.option-btn {
        background: white;
        border: 3px solid var(--secondary);
        border-radius: 15px;
        padding: 15px;
        font-size: 1.4em;
        font-family: "Mali", cursive;
        cursor: pointer;
        transition: transform 0.2s, background 0.3s;
        color: var(--text);
      }

      button.option-btn:hover {
        transform: scale(1.05);
        background-color: #f0fff4;
      }

      button.option-btn:active {
        transform: scale(0.95);
      }

      button.start-btn,
      button.restart-btn {
        background: var(--primary);
        color: white;
        border: none;
        padding: 15px 40px;
        font-size: 1.5em;
        border-radius: 50px;
        cursor: pointer;
        box-shadow: 0 5px 15px rgba(255, 154, 162, 0.4);
        font-family: "Mali", cursive;
        margin-top: 20px;
      }

      button.start-btn:hover {
        transform: scale(1.05);
      }

      .hidden {
        display: none;
      }

      .correct-anim {
        background-color: var(--correct) !important;
        border-color: #52b788 !important;
        color: white !important;
        animation: bounce 0.5s;
      }

      .wrong-anim {
        background-color: var(--wrong) !important;
        border-color: #ff6b6b !important;
        color: white !important;
        animation: shake 0.5s;
      }

      @keyframes bounce {
        0%,
        20%,
        50%,
        80%,
        100% {
          transform: translateY(0);
        }
        40% {
          transform: translateY(-10px);
        }
        60% {
          transform: translateY(-5px);
        }
      }

      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-10px);
        }
        75% {
          transform: translateX(10px);
        }
      }

      .mascot {
        font-size: 3em;
        margin-bottom: 10px;
        display: block;
      }

      .feedback-text {
        font-size: 1.2em;
        height: 30px;
        margin-top: 10px;
        color: var(--primary);
        font-weight: bold;
      }

      .emoji-equ {
        letter-spacing: 5px;
      }
    </style>
  </head>
  <body>
    <div class="container" id="start-screen">
      <span class="mascot">ü¶Ñ</span>
      <h1>–ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∞ –ü—Ä–∏–≥–æ–¥–∞</h1>
      <p>–ü—Ä–∏–≤—ñ—Ç! –î–æ–ø–æ–º–æ–∂–∏ –∑–Ω–∞–π—Ç–∏ –∑–∞—Ö–æ–≤–∞–Ω—ñ —á–∏—Å–ª–∞.</p>
      <p>–ù–∞ —Ç–µ–±–µ —á–µ–∫–∞—î 30 —Ü—ñ–∫–∞–≤–∏—Ö –∑–∞–≤–¥–∞–Ω—å!</p>
      <button class="start-btn" onclick="startGame()">–ü–æ—á–∞—Ç–∏ –≥—Ä—É!</button>
    </div>

    <div class="container hidden" id="quiz-screen">
      <div class="progress-bar">
        <div class="progress-fill" id="progress"></div>
      </div>
      <div
        id="question-number"
        style="color: #aaa; font-size: 0.9em; margin-bottom: 5px"
      >
        –ü–∏—Ç–∞–Ω–Ω—è 1 –∑ 30
      </div>

      <div class="question-box" id="question-text">Loading...</div>

      <div class="options-grid" id="options-container"></div>

      <div class="feedback-text" id="feedback"></div>
    </div>

    <div class="container hidden" id="result-screen">
      <span class="mascot">üèÜ</span>
      <h1>–¢–∏ –º–æ–ª–æ–¥–µ—Ü—å!</h1>
      <p>–¢–≤—ñ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</p>
      <h2
        id="final-score"
        style="font-size: 3em; color: var(--primary); margin: 10px 0"
      ></h2>
      <p id="final-message"></p>
      <button class="restart-btn" onclick="location.reload()">
        –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ —â–µ —Ä–∞–∑
      </button>
    </div>

    <script>
      const totalQuestions = 30;
      let currentQuestionIndex = 0;
      let score = 0;
      let questions = [];

      const emojis = ["üçé", "üç¨", "üéà", "üê±", "‚≠êÔ∏è", "üå∏"];

      function generateQuestions() {
        const q = [];

        // 1-5: –ú–∞–ª—é–Ω–∫–∏
        for (let i = 0; i < 5; i++) {
          let icon = emojis[Math.floor(Math.random() * emojis.length)];
          let a = Math.floor(Math.random() * 4) + 1;
          let b = Math.floor(Math.random() * 4) + 1;
          let sum = a + b;

          let strA = icon.repeat(a);
          let strSum = icon.repeat(sum);

          q.push({
            type: "image",
            text: `${strA} + ‚ùì = ${strSum}`,
            correct: b,
            options: generateDistractors(b, 10),
          });
        }

        // 6-10: –ß–∏—Å–ª–∞ –¥–æ 20
        for (let i = 0; i < 5; i++) {
          let sum = Math.floor(Math.random() * 9) + 11;
          let a = Math.floor(Math.random() * (sum - 2)) + 1;
          let b = sum - a;

          let hideFirst = Math.random() > 0.5;

          q.push({
            type: "text",
            text: hideFirst ? `‚ùì + ${b} = ${sum}` : `${a} + ‚ùì = ${sum}`,
            correct: hideFirst ? a : b,
            options: generateDistractors(hideFirst ? a : b, 20),
          });
        }

        // 11-20: –°–µ—Ä–µ–¥–Ω—ñ —Ä—ñ–≤–Ω—è–Ω–Ω—è (–±–µ–∑ –ø–µ—Ä–µ—Ö–æ–¥—É)
        for (let i = 0; i < 10; i++) {
          q.push(generateSafeEquation(20, 50));
        }

        // 21-30: –°–∫–ª–∞–¥–Ω—ñ—à—ñ —Ä—ñ–≤–Ω—è–Ω–Ω—è (–±–µ–∑ –ø–µ—Ä–µ—Ö–æ–¥—É)
        for (let i = 0; i < 10; i++) {
          q.push(generateSafeEquation(50, 99));
        }

        return q;
      }

      function generateSafeEquation(minSum, maxSum) {
        // 1. –ì–µ–Ω–µ—Ä—É—î–º–æ —Å—É–º—É
        let sum = Math.floor(Math.random() * (maxSum - minSum + 1)) + minSum;

        let sumTens = Math.floor(sum / 10);
        let sumUnits = sum % 10;

        // 2. –ì–µ–Ω–µ—Ä—É—î–º–æ –¥–µ—Å—è—Ç–∫–∏ –ø–µ—Ä—à–æ–≥–æ –¥–æ–¥–∞–Ω–∫–∞ (–Ω–µ –±—ñ–ª—å—à–µ –¥–µ—Å—è—Ç–∫—ñ–≤ —Å—É–º–∏)
        let aTens = Math.floor(Math.random() * (sumTens + 1));
        // –ó–∞–ø–æ–±—ñ–∂–Ω–∏–∫: —è–∫—â–æ –¥–µ—Å—è—Ç–∫–∏ —Ä—ñ–≤–Ω—ñ, —Ç–æ –æ–¥–∏–Ω–∏—Ü—ñ –Ω–µ –º–æ–∂—É—Ç—å –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –ø–µ—Ä–µ–±–æ—Ä—É
        if (aTens === sumTens && sumUnits === 0) aTens = sumTens - 1;
        if (aTens === 0 && sumTens > 1) aTens = 1;

        // 3. –ì–µ–Ω–µ—Ä—É—î–º–æ –æ–¥–∏–Ω–∏—Ü—ñ –ø–µ—Ä—à–æ–≥–æ –¥–æ–¥–∞–Ω–∫–∞ (–Ω–µ –±—ñ–ª—å—à–µ –æ–¥–∏–Ω–∏—Ü—å —Å—É–º–∏ - –¶–ï –ì–û–õ–û–í–ù–ï –î–õ–Ø "–ë–ï–ó –ü–ï–†–ï–•–û–î–£")
        let aUnits = Math.floor(Math.random() * (sumUnits + 1));

        let valA = aTens * 10 + aUnits;

        // –ó–∞–ø–æ–±—ñ–∂–Ω–∏–∫–∏ –Ω–∞ –Ω—É–ª—å —ñ —Ä—ñ–≤–Ω—ñ—Å—Ç—å —Å—É–º—ñ
        if (valA === 0) valA = 1;
        if (valA === sum) valA = sum - 1;

        let valB = sum - valA;

        let hideFirst = Math.random() > 0.5;
        let correctVal = hideFirst ? valA : valB;

        return {
          type: "text",
          text: hideFirst ? `x + ${valB} = ${sum}` : `${valA} + x = ${sum}`,
          correct: correctVal,
          options: generateSmartDistractors(correctVal, sum),
        };
      }

      // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø—Ä–æ—Å—Ç–∏—Ö –ø–∏—Ç–∞–Ω—å (–≥–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–æ 4 –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º)
      function generateDistractors(correct, maxRange) {
        let opts = new Set();
        while (opts.size < 3) {
          // –®—É–∫–∞—î–º–æ —Ç—ñ–ª—å–∫–∏ 3 –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö
          let offset = Math.floor(Math.random() * 5) + 1;
          let direction = Math.random() > 0.5 ? 1 : -1;
          let wrong = correct + offset * direction;

          if (wrong > 0 && wrong < maxRange + 10 && wrong !== correct) {
            opts.add(wrong);
          }
        }
        // –î–æ–¥–∞—î–º–æ –ø—Ä–∞–≤–∏–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å –¥–æ –º–∞—Å–∏–≤—É
        let result = Array.from(opts);
        result.push(correct);

        // –ü–µ—Ä–µ–º—ñ—à—É—î–º–æ
        return result.sort(() => Math.random() - 0.5);
      }

      // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è —Å–∫–ª–∞–¥–Ω–∏—Ö –ø–∏—Ç–∞–Ω—å (–≥–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å + —Ä–æ–∑—É–º–Ω—ñ –ø–æ–º–∏–ª–∫–∏)
      function generateSmartDistractors(correct, sum) {
        let incorrectOpts = new Set();

        // –°—Ç–≤–æ—Ä—é—î–º–æ –ø—É–ª –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫
        let potentialWrongs = [
          correct + 10,
          correct - 10,
          correct + 1,
          correct - 1,
          correct + 2,
          correct - 2,
          // –ü–æ–º–∏–ª–∫–∞: –¥–∏—Ç–∏–Ω–∞ –¥–æ–¥–∞—î —á–∏—Å–ª–∞ –∑–∞–º—ñ—Å—Ç—å –≤—ñ–¥–Ω—ñ–º–∞–Ω–Ω—è (—è–∫—â–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π)
          sum + (sum - correct),
        ];

        // –§—ñ–ª—å—Ç—Ä—É—î–º–æ —ñ –¥–æ–¥–∞—î–º–æ —É –º–Ω–æ–∂–∏–Ω—É –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö
        potentialWrongs.forEach((val) => {
          if (val > 0 && val !== correct && val < 150) {
            // —Ä–æ–∑—É–º–Ω—ñ –º–µ–∂—ñ
            incorrectOpts.add(val);
          }
        });

        // –Ø–∫—â–æ –ø–æ–º–∏–ª–æ–∫ –∑–∞–º–∞–ª–æ, –¥–æ–¥–∞—î–º–æ –≤–∏–ø–∞–¥–∫–æ–≤—ñ
        while (incorrectOpts.size < 3) {
          let wrong = correct + Math.floor(Math.random() * 20) - 10;
          if (wrong > 0 && wrong !== correct) incorrectOpts.add(wrong);
        }

        // –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ –Ω–∞ –º–∞—Å–∏–≤, –ø–µ—Ä–µ–º—ñ—à—É—î–º–æ —ñ –±–µ—Ä–µ–º–æ –¢–Ü–õ–¨–ö–ò 3 –ù–ï–ü–†–ê–í–ò–õ–¨–ù–ò–•
        let finalOpts = Array.from(incorrectOpts)
          .sort(() => Math.random() - 0.5)
          .slice(0, 3);

        // –î–æ–¥–∞—î–º–æ –ü–†–ê–í–ò–õ–¨–ù–£ –≤—ñ–¥–ø–æ–≤—ñ–¥—å (—Ç–µ–ø–µ—Ä –≤–æ–Ω–∞ —Ç–æ—á–Ω–æ —î)
        finalOpts.push(correct);

        // –ü–µ—Ä–µ–º—ñ—à—É—î–º–æ —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π –Ω–∞–±—ñ—Ä –∑ 4 –∫–Ω–æ–ø–æ–∫
        return finalOpts.sort(() => Math.random() - 0.5);
      }

      function startGame() {
        questions = generateQuestions();
        document.getElementById("start-screen").classList.add("hidden");
        document.getElementById("quiz-screen").classList.remove("hidden");
        renderQuestion();
      }

      function renderQuestion() {
        const q = questions[currentQuestionIndex];
        document.getElementById("question-number").innerText = `–ó–∞–≤–¥–∞–Ω–Ω—è ${
          currentQuestionIndex + 1
        } –∑ ${totalQuestions}`;

        const progressPercent = (currentQuestionIndex / totalQuestions) * 100;
        document.getElementById("progress").style.width = `${progressPercent}%`;

        const qBox = document.getElementById("question-text");
        qBox.innerText = q.text;
        if (q.type === "image") {
          qBox.classList.add("emoji-equ");
        } else {
          qBox.classList.remove("emoji-equ");
        }

        const container = document.getElementById("options-container");
        container.innerHTML = "";
        document.getElementById("feedback").innerText = "";

        q.options.forEach((opt) => {
          const btn = document.createElement("button");
          btn.className = "option-btn";
          btn.innerText = opt;

          btn.onclick = () => checkAnswer(btn, opt, q.correct);
          container.appendChild(btn);
        });
      }

      function checkAnswer(btn, selected, correct) {
        const allBtns = document.querySelectorAll(".option-btn");
        allBtns.forEach((b) => (b.disabled = true));

        if (selected === correct) {
          btn.classList.add("correct-anim");
          document.getElementById("feedback").innerText = "–ß—É–¥–æ–≤–æ! üéâ";
          score++;
          setTimeout(nextQuestion, 1500);
        } else {
          btn.classList.add("wrong-anim");
          document.getElementById(
            "feedback"
          ).innerText = `–ü—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å: ${correct}`;

          allBtns.forEach((b) => {
            let val = parseInt(b.innerText);
            if (val === correct) b.classList.add("correct-anim");
          });

          setTimeout(nextQuestion, 2000);
        }
      }

      function nextQuestion() {
        currentQuestionIndex++;
        if (currentQuestionIndex < totalQuestions) {
          renderQuestion();
        } else {
          showResults();
        }
      }

      function showResults() {
        document.getElementById("quiz-screen").classList.add("hidden");
        document.getElementById("result-screen").classList.remove("hidden");

        const scoreEl = document.getElementById("final-score");
        const msgEl = document.getElementById("final-message");

        scoreEl.innerText = `${score} / ${totalQuestions}`;

        if (score === totalQuestions) {
          msgEl.innerText = "–ù–µ–π–º–æ–≤—ñ—Ä–Ω–æ! –¢–∏ —Å–ø—Ä–∞–≤–∂–Ω—è –∫–æ—Ä–æ–ª–µ–≤–∞ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏! üëë";
        } else if (score > 25) {
          msgEl.innerText = "–î—É–∂–µ –≥–∞—Ä–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –¢–∏ –º–∞–π–∂–µ –≤—Å–µ –∑–Ω–∞—î—à! üåü";
        } else if (score > 15) {
          msgEl.innerText = "–•–æ—Ä–æ—à–∞ —Ä–æ–±–æ—Ç–∞! –¢—Ä–µ–Ω—É–π—Å—è —â–µ, —ñ –±—É–¥–µ —ñ–¥–µ–∞–ª—å–Ω–æ! üí™";
        } else {
          msgEl.innerText = "–ù–µ –∑–∞—Å–º—É—á—É–π—Å—è! –°–ø—Ä–æ–±—É–π —â–µ —Ä–∞–∑, —Ç–∏ –∑–º–æ–∂–µ—à! ‚òÄÔ∏è";
        }
      }
    </script>
  </body>
</html>
