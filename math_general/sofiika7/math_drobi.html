<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π —É—Ä–æ–∫: –°–≤—ñ—Ç –î—Ä–æ–±—ñ–≤</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f0f2f5; height: 100vh; overflow: hidden; }
        .split-container { display: flex; height: 100vh; }
        .content-area { width: 55%; overflow-y: auto; padding: 2rem; background: white; box-shadow: 2px 0 10px rgba(0,0,0,0.1); }
        .whiteboard-area { width: 45%; background: #2c3e50; position: relative; display: flex; flex-direction: column; }
        .canvas-container { flex-grow: 1; position: relative; cursor: crosshair; }
        #whiteboard { background: white; width: 100%; height: 100%; }
        .theory-block { border-left: 4px solid #3498db; background: #ebf5fb; padding: 1rem; margin-bottom: 1.5rem; border-radius: 0 8px 8px 0; }
        .task-card { background: #fff; border: 1px solid #e1e8ed; padding: 1rem; border-radius: 12px; margin-bottom: 1rem; transition: transform 0.2s; }
        .task-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        .correct { border: 2px solid #27ae60 !important; background-color: #eafaf1; }
        .wrong { border: 2px solid #e74c3c !important; background-color: #fdedec; }
        .hidden { display: none; }
        .btn-hint { color: #7f8c8d; font-size: 0.85rem; text-decoration: underline; cursor: pointer; }
        .btn-hint:hover { color: #34495e; }
        .tools-panel { padding: 10px; background: #34495e; display: flex; gap: 10px; justify-content: center; }
        input[type="text"] { border: 1px solid #ccc; border-radius: 4px; padding: 4px 8px; width: 80px; text-align: center; }
    </style>
</head>
<body>

<div class="split-container">
    <div class="content-area" id="content">
        <header class="mb-8">
            <h1 class="text-3xl font-bold text-gray-800">–ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∞ –ø–æ–¥–æ—Ä–æ–∂: –î—Ä–æ–±–∏</h1>
            <p class="text-gray-600">–ö–ª–∞—Å: 5-6 | –ß–∞—Å: 1 –≥–æ–¥–∏–Ω–∞ | –†—ñ–≤–µ–Ω—å: –°–µ—Ä–µ–¥–Ω—ñ–π</p>
            <div class="mt-4 p-4 bg-yellow-50 rounded-lg border border-yellow-200">
                üí° <strong>–ü–æ—Ä–∞–¥–∞:</strong> –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π —á–µ—Ä–Ω–µ—Ç–∫—É –ø—Ä–∞–≤–æ—Ä—É—á –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤!
            </div>
        </header>

        <section class="mb-12">
            <h2 class="text-2xl font-semibold mb-4 text-blue-700">1. –©–æ —Ç–∞–∫–µ –¥—Ä—ñ–±?</h2>
            <div class="theory-block">
                –£—è–≤–∏ –ø—ñ—Ü—É. –î—Ä—ñ–± ‚Äî —Ü–µ —á–∞—Å—Ç–∏–Ω–∞ —Ü—ñ—î—ó –ø—ñ—Ü–∏. 
                –í–µ—Ä—Ö–Ω—î —á–∏—Å–ª–æ (\(—á–∏—Å–µ–ª—å–Ω–∏–∫\)) –ø–æ–∫–∞–∑—É—î, —Å–∫—ñ–ª—å–∫–∏ —à–º–∞—Ç–∫—ñ–≤ –º–∏ –≤–∑—è–ª–∏.
                –ù–∏–∂–Ω—î —á–∏—Å–ª–æ (\(–∑–Ω–∞–º–µ–Ω–Ω–∏–∫\)) –ø–æ–∫–∞–∑—É—î, –Ω–∞ —Å–∫—ñ–ª—å–∫–∏ —Ä—ñ–≤–Ω–∏—Ö —á–∞—Å—Ç–∏–Ω —Ä–æ–∑—Ä—ñ–∑–∞–ª–∏ —Ü—ñ–ª—É –ø—ñ—Ü—É.
                <div class="mt-2 flex justify-center">
                    <svg width="100" height="100" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="45" fill="#ddd" stroke="#333" />
                        <path d="M50,50 L50,5 A45,45 0 0,1 95,50 Z" fill="#f1c40f" stroke="#333" />
                    </svg>
                </div>
            </div>

            <div id="tasks-basic">
                <script>
                    const basicTasks = [
                        { q: "–ó–∞–ø–∏—à—ñ—Ç—å –¥—Ä—ñ–±: —Ç—Ä–∏ –≤–æ—Å—å–º–∏—Ö", a: "3/8", h: "–ß–∏—Å–µ–ª—å–Ω–∏–∫ –∑–≤–µ—Ä—Ö—É, –∑–Ω–∞–º–µ–Ω–Ω–∏–∫ –∑–Ω–∏–∑—É", s: "–¢—Ä–∏ - —á–∏—Å–µ–ª—å–Ω–∏–∫, –≤—ñ—Å—ñ–º - –∑–Ω–∞–º–µ–Ω–Ω–∏–∫: 3/8" },
                        { q: "–°–∫—ñ–ª—å–∫–∏ —á–∞—Å—Ç–∏–Ω —É –¥—Ä–æ–±—ñ \\(\\frac{5}{12}\\)?", a: "5", h: "–î–∏–≤–∏—Å—å –Ω–∞ –≤–µ—Ä—Ö–Ω—î —á–∏—Å–ª–æ", s: "–ß–∏—Å–µ–ª—å–Ω–∏–∫ 5 –≤–∫–∞–∑—É—î –Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤–∑—è—Ç–∏—Ö —á–∞—Å—Ç–∏–Ω." },
                        { q: "–Ø–∫–∏–π –∑–Ω–∞–º–µ–Ω–Ω–∏–∫ —É –¥—Ä–æ–±—ñ \\(\\frac{7}{10}\\)?", a: "10", h: "–î–∏–≤–∏—Å—å –Ω–∞ –Ω–∏–∂–Ω—î —á–∏—Å–ª–æ", s: "–ó–Ω–∞–º–µ–Ω–Ω–∏–∫ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –∑–Ω–∏–∑—É –ª—ñ–Ω—ñ—ó –¥—Ä–æ–±—É." },
                        { q: "–Ø–∫ –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è –¥—Ä—ñ–±, –¥–µ —á–∏—Å–µ–ª—å–Ω–∏–∫ –º–µ–Ω—à–∏–π –∑–∞ –∑–Ω–∞–º–µ–Ω–Ω–∏–∫? (—Å–ª–æ–≤–æ)", a: "–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π", h: "–ù–∞–ø—Ä–∏–∫–ª–∞–¥ 1/2, 2/3...", s: "–¶–µ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –¥—Ä—ñ–±." },
                        { q: "–ó–∞–ø–∏—à—ñ—Ç—å —á–∏—Å–ª–æ '–æ–¥–Ω–∞ —Ü—ñ–ª–∞ –¥–≤—ñ –ø'—è—Ç–∏—Ö' —è–∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –¥—Ä—ñ–±", a: "7/5", h: "(1 * 5 + 2) / 5", s: "1*5 + 2 = 7. –û—Ç–∂–µ 7/5" }
                    ];
                </script>
            </div>
        </section>

        <section class="mb-12">
            <h2 class="text-2xl font-semibold mb-4 text-blue-700">2. –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤ –¥–µ—Å—è—Ç–∫–æ–≤—ñ –¥—Ä–æ–±–∏</h2>
            <div class="theory-block">
                –î–µ—Å—è—Ç–∫–æ–≤–∏–π –¥—Ä—ñ–± ‚Äî —Ü–µ "—Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∑–∞–ø–∏—Å". –Ø–∫—â–æ –∑–Ω–∞–º–µ–Ω–Ω–∏–∫ 10, 100 –∞–±–æ 1000, –º–∏ –ø—Ä–æ—Å—Ç–æ –ø–∏—à–µ–º–æ –∫–æ–º—É.
                –ù–∞–ø—Ä–∏–∫–ª–∞–¥: \(\frac{3}{10} = 0,3\); \(\frac{7}{100} = 0,07\).
                –Ø–∫—â–æ –∑–Ω–∞–º–µ–Ω–Ω–∏–∫ —ñ–Ω—à–∏–π ‚Äî —Ç—Ä–µ–±–∞ –ø–æ–¥—ñ–ª–∏—Ç–∏ —á–∏—Å–µ–ª—å–Ω–∏–∫ –Ω–∞ –∑–Ω–∞–º–µ–Ω–Ω–∏–∫ "—É —Å—Ç–æ–≤–ø—á–∏–∫".
            </div>
            <div id="tasks-decimal">
                </div>
        </section>

        <section class="mb-12">
            <h2 class="text-2xl font-semibold mb-4 text-blue-700">3. –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ç–∞ –≤—ñ–¥–Ω—ñ–º–∞–Ω–Ω—è</h2>
            <div class="theory-block">
                <strong>–ü—Ä–∞–≤–∏–ª–æ 1:</strong> –Ø–∫—â–æ –∑–Ω–∞–º–µ–Ω–Ω–∏–∫–∏ –æ–¥–Ω–∞–∫–æ–≤—ñ, –ø—Ä–æ—Å—Ç–æ –¥–æ–¥–∞—î–º–æ —á–∏—Å–µ–ª—å–Ω–∏–∫–∏.
                <strong>–ü—Ä–∞–≤–∏–ª–æ 2:</strong> –Ø–∫—â–æ —Ä—ñ–∑–Ω—ñ ‚Äî —à—É–∫–∞—î–º–æ —Å–ø—ñ–ª—å–Ω–∏–π –∑–Ω–∞–º–µ–Ω–Ω–∏–∫ (–ù–°–ö)!
            </div>
            <div id="tasks-add-sub">
                </div>
        </section>

        <section class="mb-12">
            <h2 class="text-2xl font-semibold mb-4 text-blue-700">4. –ú–Ω–æ–∂–µ–Ω–Ω—è —Ç–∞ –¥—ñ–ª–µ–Ω–Ω—è</h2>
            <div class="theory-block">
                –ú–Ω–æ–∂–∏—Ç–∏ –Ω–∞–π–ø—Ä–æ—Å—Ç—ñ—à–µ: —á–∏—Å–µ–ª—å–Ω–∏–∫ –Ω–∞ —á–∏—Å–µ–ª—å–Ω–∏–∫, –∑–Ω–∞–º–µ–Ω–Ω–∏–∫ –Ω–∞ –∑–Ω–∞–º–µ–Ω–Ω–∏–∫.
                –ü—Ä–∏ –¥—ñ–ª–µ–Ω–Ω—ñ: –ø–µ—Ä—à–∏–π –¥—Ä—ñ–± –∑–∞–ª–∏—à–∞—î–º–æ, —Å—Ç–∞–≤–∏–º–æ –º–Ω–æ–∂–µ–Ω–Ω—è —ñ <strong>–ø–µ—Ä–µ–≤–µ—Ä—Ç–∞—î–º–æ</strong> –¥—Ä—É–≥–∏–π –¥—Ä—ñ–±!
            </div>
            <div id="tasks-mul-div">
                </div>
        </section>

        <section id="final-test-section" class="mt-12 p-6 bg-purple-50 rounded-xl border-2 border-purple-200">
            <h2 class="text-2xl font-bold mb-4 text-purple-800">üèÅ –ü—ñ–¥—Å—É–º–∫–æ–≤–∏–π —Ç–µ—Å—Ç</h2>
            <div id="test-container"></div>
            <button onclick="finishLesson()" id="finish-btn" class="mt-6 bg-purple-600 text-white px-8 py-3 rounded-full font-bold hover:bg-purple-700 transition">–ó–∞–≤–µ—Ä—à–∏—Ç–∏ —É—Ä–æ–∫</button>
        </section>

        <div id="result-modal" class="hidden mt-6 p-6 bg-white border-4 border-green-500 rounded-2xl text-center">
            <h3 class="text-3xl font-bold text-green-600 mb-2">–ß—É–¥–æ–≤–∞ —Ä–æ–±–æ—Ç–∞! üåü</h3>
            <p id="final-score" class="text-xl mb-4"></p>
            <p id="motivation" class="italic text-gray-600"></p>
        </div>
    </div>

    <div class="whiteboard-area">
        <div class="tools-panel">
            <button onclick="setTool('pencil')" class="bg-blue-500 text-white px-3 py-1 rounded">‚úèÔ∏è –û–ª—ñ–≤–µ—Ü—å</button>
            <button onclick="setTool('eraser')" class="bg-gray-500 text-white px-3 py-1 rounded">üßº –ì—É–º–∫–∞</button>
            <button onclick="drawGrid()" class="bg-green-600 text-white px-3 py-1 rounded">üìè –°—ñ—Ç–∫–∞</button>
            <button onclick="drawCircle()" class="bg-yellow-600 text-white px-3 py-1 rounded">‚≠ï –ö–æ–ª–æ</button>
            <button onclick="clearCanvas()" class="bg-red-500 text-white px-3 py-1 rounded">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏</button>
        </div>
        <div class="canvas-container">
            <canvas id="whiteboard"></canvas>
        </div>
        <div class="p-2 text-white text-xs text-center opacity-50">–ß–µ—Ä–Ω–µ—Ç–∫–∞ –¥–ª—è —Ç–≤–æ—ó—Ö –¥—É–º–æ–∫</div>
    </div>
</div>

<script>
    // --- –î–ê–ù–Ü –ó–ê–í–î–ê–ù–¨ ---
    const tasksData = [
        // –ë–ª–æ–∫ 1 –≤–∂–µ —î –≤ –º–∞—Å–∏–≤—ñ basicTasks (5)
        { q: "–ó–∞–ø–∏—à—ñ—Ç—å \\(\\frac{15}{10}\\) –¥–µ—Å—è—Ç–∫–æ–≤–∏–º –¥—Ä–æ–±–æ–º", a: "1.5", h: "–û–¥–Ω–∞ —Ü–∏—Ñ—Ä–∞ –ø—ñ—Å–ª—è –∫–æ–º–∏", s: "15 –ø–æ–¥—ñ–ª–∏—Ç–∏ –Ω–∞ 10 = 1,5", group: "decimal" },
        { q: "–ó–∞–ø–∏—à—ñ—Ç—å \\(\\frac{4}{100}\\) –¥–µ—Å—è—Ç–∫–æ–≤–∏–º –¥—Ä–æ–±–æ–º", a: "0.04", h: "–î–≤—ñ —Ü–∏—Ñ—Ä–∏ –ø—ñ—Å–ª—è –∫–æ–º–∏", s: "0 —Ü—ñ–ª–∏—Ö —Ç–∞ 04", group: "decimal" },
        { q: "–ü–µ—Ä–µ—Ç–≤–æ—Ä—ñ—Ç—å \\(\\frac{1}{2}\\) —É –¥–µ—Å—è—Ç–∫–æ–≤–∏–π", a: "0.5", h: "–ü–æ–º–Ω–æ–∂ —ñ —á–∏—Å–µ–ª—å–Ω–∏–∫, —ñ –∑–Ω–∞–º–µ–Ω–Ω–∏–∫ –Ω–∞ 5", s: "5/10 = 0,5", group: "decimal" },
        { q: "–°–∫—ñ–ª—å–∫–∏ –±—É–¥–µ 0,25 —É –≤–∏–≥–ª—è–¥—ñ –∑–≤–∏—á–∞–π–Ω–æ–≥–æ –¥—Ä–æ–±—É? (—á–µ—Ä–µ–∑ /)", a: "1/4", h: "–¶–µ 25/100, —Å–∫–æ—Ä–æ—Ç–∏ –Ω–∞ 25", s: "25/100 = 1/4", group: "decimal" },
        { q: "–ó–∞–ø–∏—à—ñ—Ç—å \\(\\frac{2}{5}\\) —è–∫ –¥–µ—Å—è—Ç–∫–æ–≤–∏–π", a: "0.4", h: "–ó—Ä–æ–±–∏ –∑–Ω–∞–º–µ–Ω–Ω–∏–∫ 10", s: "2*2 / 5*2 = 4/10 = 0,4", group: "decimal" },
        
        { q: "\\(\\frac{1}{5} + \\frac{2}{5} = ?\\)", a: "3/5", h: "–î–æ–¥–∞–π —Ç—ñ–ª—å–∫–∏ –≤–µ—Ä—Ö–Ω—ñ —á–∏—Å–ª–∞", s: "(1+2)/5 = 3/5", group: "add" },
        { q: "\\(\\frac{7}{9} - \\frac{4}{9} = ?\\)", a: "3/9", h: "–í—ñ–¥–Ω—ñ–º–∏ —á–∏—Å–µ–ª—å–Ω–∏–∫–∏", s: "3/9 (–º–æ–∂–Ω–∞ —Å–∫–æ—Ä–æ—Ç–∏—Ç–∏ –¥–æ 1/3)", group: "add" },
        { q: "\\(\\frac{1}{2} + \\frac{1}{4} = ?\\)", a: "3/4", h: "–°–ø—ñ–ª—å–Ω–∏–π –∑–Ω–∞–º–µ–Ω–Ω–∏–∫ 4", s: "2/4 + 1/4 = 3/4", group: "add" },
        { q: "\\(\\frac{1}{3} + \\frac{1}{6} = ?\\)", a: "3/6", h: "–°–ø—ñ–ª—å–Ω–∏–π –∑–Ω–∞–º–µ–Ω–Ω–∏–∫ 6", s: "2/6 + 1/6 = 3/6 –∞–±–æ 1/2", group: "add" },
        { q: "\\(1 - \\frac{1}{3} = ?\\)", a: "2/3", h: "–£—è–≤–∏ 1 —è–∫ 3/3", s: "3/3 - 1/3 = 2/3", group: "add" },
        { q: "\\(\\frac{5}{12} + \\frac{1}{12} = ?\\) (—Å–∫–æ—Ä–æ—Ç—ñ—Ç—å)", a: "1/2", h: "6/12 - –Ω–∞ —â–æ –¥—ñ–ª–∏—Ç—å—Å—è?", s: "6/12 = 1/2", group: "add" },
        { q: "\\(2 + \\frac{1}{2} = ?\\) (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–º –¥—Ä–æ–±–æ–º)", a: "5/2", h: "2 —Ü–µ 4/2", s: "4/2 + 1/2 = 5/2", group: "add" },
        { q: "\\(\\frac{10}{11} - \\frac{1}{11} = ?\\)", a: "9/11", h: "–ü—Ä–æ—Å—Ç–µ –≤—ñ–¥–Ω—ñ–º–∞–Ω–Ω—è", s: "9/11", group: "add" },
        { q: "\\(\\frac{1}{5} + \\frac{1}{2} = ?\\)", a: "7/10", h: "–°–ø—ñ–ª—å–Ω–∏–π –∑–Ω–∞–º–µ–Ω–Ω–∏–∫ 10", s: "2/10 + 5/10 = 7/10", group: "add" },
        { q: "\\(\\frac{3}{4} - \\frac{1}{2} = ?\\)", a: "1/4", h: "1/2 —Ü–µ 2/4", s: "3/4 - 2/4 = 1/4", group: "add" },

        { q: "\\(\\frac{1}{2} \\cdot \\frac{1}{3} = ?\\)", a: "1/6", h: "–í–µ—Ä—Ö –Ω–∞ –≤–µ—Ä—Ö, –Ω–∏–∑ –Ω–∞ –Ω–∏–∑", s: "1*1 / 2*3 = 1/6", group: "mul" },
        { q: "\\(\\frac{2}{5} \\cdot \\frac{3}{4} = ?\\)", a: "6/20", h: "–ü–µ—Ä–µ–º–Ω–æ–∂ —á–∏—Å–ª–∞", s: "6/20 –∞–±–æ 3/10", group: "mul" },
        { q: "\\(5 \\cdot \\frac{1}{5} = ?\\)", a: "1", h: "5 —Ü—ñ–ª–∏—Ö —Ü–µ 5/1", s: "5/5 = 1", group: "mul" },
        { q: "\\(\\frac{2}{3} \\cdot \\frac{3}{2} = ?\\)", a: "1", h: "–í—Å–µ —Å–∫–æ—Ä–æ—á—É—î—Ç—å—Å—è", s: "6/6 = 1", group: "mul" },
        { q: "\\(\\frac{1}{4} \\cdot 4 = ?\\)", a: "1", h: "–ß–≤–µ—Ä—Ç—å –≤—ñ–¥ —á–æ—Ç–∏—Ä—å–æ—Ö", s: "4/4 = 1", group: "mul" },
        { q: "\\(\\frac{1}{2} : \\frac{1}{2} = ?\\)", a: "1", h: "–ß–∏—Å–ª–æ –ø–æ–¥—ñ–ª–∏—Ç–∏ –Ω–∞ —Å–∞–º–µ —Å–µ–±–µ", s: "1/2 * 2/1 = 1", group: "mul" },
        { q: "\\(\\frac{1}{2} : 2 = ?\\)", a: "1/4", h: "–ü–µ—Ä–µ–≤–µ—Ä–Ω–∏ 2/1 —É 1/2", s: "1/2 * 1/2 = 1/4", group: "mul" },
        { q: "\\(\\frac{3}{5} : \\frac{1}{5} = ?\\)", a: "3", h: "–ü–æ–º–Ω–æ–∂ –Ω–∞ 5/1", s: "3/5 * 5/1 = 3", group: "mul" },
        { q: "\\(10 : \\frac{1}{2} = ?\\)", a: "20", h: "–°–∫—ñ–ª—å–∫–∏ –ø–æ–ª–æ–≤–∏–Ω–æ–∫ —É 10?", s: "10 * 2/1 = 20", group: "mul" },
        { q: "\\(\\frac{4}{9} : \\frac{2}{3} = ?\\)", a: "12/18", h: "4/9 * 3/2", s: "12/18 –∞–±–æ 2/3", group: "mul" }
    ];

    const testTasks = [
        { q: "–©–æ –±—ñ–ª—å—à–µ: \\(\\frac{1}{2}\\) —á–∏ 0,6?", a: "0.6", h: "1/2 = 0,5" },
        { q: "–†–µ–∑—É–ª—å—Ç–∞—Ç \\(\\frac{1}{3} + \\frac{1}{3} + \\frac{1}{3}\\)", a: "1", h: "3/3" },
        { q: "–ó–Ω–∞–π–¥—ñ—Ç—å \\(\\frac{1}{2}\\) –≤—ñ–¥ 100", a: "50", h: "100 –ø–æ–¥—ñ–ª–∏—Ç–∏ –Ω–∞ 2" },
        { q: "–û–±—á–∏—Å–ª—ñ—Ç—å: \\(0,5 \\cdot 4\\)", a: "2", h: "–ü—ñ–≤ –∫–æ–ø—ñ–π–∫–∏ –Ω–∞ —á–æ—Ç–∏—Ä–∏" },
        { q: "–°–∫—ñ–ª—å–∫–∏ –±—É–¥–µ \\(\\frac{2}{3}\\) –≤—ñ–¥ 9?", a: "6", h: "(9/3)*2" }
    ];

    let correctAnswers = 0;
    let totalTasks = basicTasks.length + tasksData.length + testTasks.length;

    function renderTasks() {
        const createCard = (task, index, containerId) => {
            const div = document.createElement('div');
            div.className = 'task-card';
            div.innerHTML = `
                <p class="font-medium mb-2">${task.q}</p>
                <div class="flex items-center gap-2">
                    <input type="text" id="ans-${containerId}-${index}" placeholder="...">
                    <button onclick="checkTask('${task.a}', 'ans-${containerId}-${index}', this)" class="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
                </div>
                <div class="mt-2">
                    <span class="btn-hint" onclick="toggleVisibility('hint-${containerId}-${index}')">–ü—ñ–¥–∫–∞–∑–∫–∞</span> | 
                    <span class="btn-hint" onclick="toggleVisibility('sol-${containerId}-${index}')">–†–æ–∑–≤'—è–∑–∞–Ω–Ω—è</span>
                </div>
                <p id="hint-${containerId}-${index}" class="hidden text-sm text-gray-500 italic mt-1">üí° ${task.h}</p>
                <p id="sol-${containerId}-${index}" class="hidden text-sm text-blue-600 font-bold mt-1">‚úÖ ${task.s || '–î–∏–≤–∏—Å—å –ø—ñ–¥–∫–∞–∑–∫—É'}</p>
            `;
            document.getElementById(containerId).appendChild(div);
        };

        basicTasks.forEach((t, i) => createCard(t, i, 'tasks-basic'));
        tasksData.filter(t => t.group === 'decimal').forEach((t, i) => createCard(t, i, 'tasks-decimal'));
        tasksData.filter(t => t.group === 'add').forEach((t, i) => createCard(t, i, 'tasks-add-sub'));
        tasksData.filter(t => t.group === 'mul').forEach((t, i) => createCard(t, i, 'tasks-mul-div'));

        const testCont = document.getElementById('test-container');
        testTasks.forEach((t, i) => {
            const div = document.createElement('div');
            div.className = 'mb-4 p-3 bg-white rounded shadow-sm';
            div.innerHTML = `<p class="mb-1">${i+1}. ${t.q}</p><input type="text" id="test-ans-${i}" class="w-full border p-2 rounded">`;
            testCont.appendChild(div);
        });
    }

    function toggleVisibility(id) {
        const el = document.getElementById(id);
        el.classList.toggle('hidden');
    }

    function checkTask(correct, inputId, btn) {
        const input = document.getElementById(inputId);
        const val = input.value.trim().replace(',', '.');
        const card = input.parentElement.parentElement;
        
        if (val === correct || (val.includes('/') && eval(val) === eval(correct))) {
            card.classList.add('correct');
            card.classList.remove('wrong');
            btn.disabled = true;
            btn.innerText = "–í—ñ—Ä–Ω–æ!";
            correctAnswers++;
        } else {
            card.classList.add('wrong');
            setTimeout(() => card.classList.remove('wrong'), 500);
        }
    }

    function finishLesson() {
        let testScore = 0;
        testTasks.forEach((t, i) => {
            const val = document.getElementById(`test-ans-${i}`).value.trim().replace(',', '.');
            if (val === t.a) testScore++;
        });

        const totalScore = correctAnswers + testScore;
        const maxScore = totalTasks;
        const percent = Math.round((totalScore / maxScore) * 100);

        document.getElementById('final-test-section').classList.add('hidden');
        const result = document.getElementById('result-modal');
        result.classList.remove('hidden');
        
        document.getElementById('final-score').innerText = `–¢–≤—ñ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${percent}% (${totalScore} –∑ ${maxScore})`;
        
        let motivation = "";
        if (percent > 80) motivation = "–¢–∏ ‚Äî —Å–ø—Ä–∞–≤–∂–Ω—ñ–π –º–∞–≥—ñ—Å—Ç—Ä –¥—Ä–æ–±—ñ–≤! –¢–≤–æ—ó –∑–Ω–∞–Ω–Ω—è –º—ñ—Ü–Ω—ñ, —è–∫ –≥—Ä–∞–Ω—ñ—Ç!";
        else if (percent > 50) motivation = "–ì–∞—Ä–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –î—Ä–æ–±–∏ —Ç–µ–ø–µ—Ä —Ç–≤–æ—ó –¥—Ä—É–∑—ñ, –ø—Ä–æ–¥–æ–≤–∂—É–π —É —Ç–æ–º—É –∂ –¥—É—Å—ñ!";
        else motivation = "–ü–æ—á–∞—Ç–æ–∫ –ø–æ–∫–ª–∞–¥–µ–Ω–æ! –ì–æ–ª–æ–≤–Ω–µ ‚Äî –Ω–µ –∑–¥–∞–≤–∞—Ç–∏—Å—è, —Ç–∏ –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø—ñ–¥–∫–æ—Ä–∏—à —Ü—é —Ç–µ–º—É!";
        
        document.getElementById('motivation').innerText = motivation;
        result.scrollIntoView({ behavior: 'smooth' });
    }

    // --- –õ–û–ì–Ü–ö–ê –î–û–®–ö–ò (WHITEBOARD) ---
    const canvas = document.getElementById('whiteboard');
    const ctx = canvas.getContext('2d');
    let drawing = false;
    let tool = 'pencil';

    function resizeCanvas() {
        canvas.width = canvas.parentElement.clientWidth;
        canvas.height = canvas.parentElement.clientHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    canvas.addEventListener('mousedown', () => drawing = true);
    canvas.addEventListener('mouseup', () => { drawing = false; ctx.beginPath(); });
    canvas.addEventListener('mousemove', draw);

    function setTool(t) { tool = t; }

    function draw(e) {
        if (!drawing) return;
        const rect = canvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;

        ctx.lineWidth = tool === 'eraser' ? 20 : 3;
        ctx.lineCap = 'round';
        ctx.strokeStyle = tool === 'eraser' ? 'white' : '#2c3e50';

        ctx.lineTo(x, y);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(x, y);
    }

    function clearCanvas() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

    function drawGrid() {
        ctx.strokeStyle = '#e0e0e0';
        ctx.lineWidth = 1;
        for (let x = 0; x <= canvas.width; x += 30) {
            ctx.moveTo(x, 0); ctx.lineTo(x, canvas.height);
        }
        for (let y = 0; y <= canvas.height; y += 30) {
            ctx.moveTo(0, y); ctx.lineTo(canvas.width, y);
        }
        ctx.stroke();
    }

    function drawCircle() {
        ctx.strokeStyle = '#2c3e50';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.arc(canvas.width/2, canvas.height/2, 50, 0, Math.PI * 2);
        ctx.stroke();
    }

    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
    renderTasks();
</script>

</body>
</html>