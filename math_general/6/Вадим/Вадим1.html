<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–£—Ä–æ–∫: –ö–æ–ª–æ, –ö—Ä—É–≥, –°–µ–∫—Ç–æ—Ä–∏ (6 –∫–ª–∞—Å)</title>

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
    />
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
    ></script>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    ></script>

    <style>
      :root {
        --primary: #4f46e5; /* Indigo */
        --primary-light: #e0e7ff;
        --theory-bg: #f0f9ff; /* Light Blue for theory */
        --theory-border: #0ea5e9;
        --success: #16a34a;
        --error: #dc2626;
        --text: #1e293b;
        --bg: #f8fafc;
        --border: #cbd5e1;
      }

      body {
        font-family: "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        background-color: var(--bg);
        color: var(--text);
        margin: 0;
        height: 100vh;
        display: flex;
        overflow: hidden;
      }

      /* --- –õ–Ü–í–ê –ß–ê–°–¢–ò–ù–ê (–¢–ï–û–†–Ü–Ø + –ó–ê–í–î–ê–ù–ù–Ø) --- */
      #lesson-section {
        flex: 1;
        overflow-y: auto;
        border-right: 1px solid var(--border);
        display: flex;
        flex-direction: column;
        background: white;
      }

      header {
        background: white;
        padding: 15px 20px;
        border-bottom: 2px solid var(--primary);
        position: sticky;
        top: 0;
        z-index: 100;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .lesson-title { font-weight: 800; font-size: 1.2rem; color: var(--primary); }
      .score-box { font-weight: 600; font-size: 1rem; }

      .content-wrapper {
        padding: 20px;
        padding-bottom: 80px;
        max-width: 850px;
        margin: 0 auto;
        width: 100%;
      }

      /* –°—Ç–∏–ª—ñ —Ç–µ–æ—Ä—ñ—ó */
      .theory-block {
        background: var(--theory-bg);
        border-left: 5px solid var(--theory-border);
        padding: 20px;
        margin-bottom: 30px;
        border-radius: 0 8px 8px 0;
      }
      .theory-title {
        margin-top: 0;
        color: #0369a1;
        font-size: 1.3rem;
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .theory-content {
        line-height: 1.6;
        font-size: 1.05rem;
      }
      .important-formula {
        background: white;
        padding: 10px;
        border-radius: 8px;
        border: 2px solid var(--primary-light);
        text-align: center;
        font-weight: bold;
        margin: 15px 0;
        font-size: 1.2rem;
      }
      .concept-svg {
        display: block;
        margin: 15px auto;
        max-width: 100%;
        height: auto;
      }

      /* –°—Ç–∏–ª—ñ –∑–∞–≤–¥–∞–Ω—å */
      .tasks-group {
        margin-bottom: 40px;
      }
      .task-card {
        border: 1px solid var(--border);
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 15px;
        background: white;
        transition: 0.3s;
      }
      .task-card.solved-correct { border-color: var(--success); background: #f0fdf4; }
      .task-card.solved-wrong { border-color: var(--error); background: #fef2f2; }

      .task-q { font-weight: 500; font-size: 1.1rem; margin-bottom: 10px; }
      
      .input-area { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px; }
      .ans-input {
        padding: 8px 12px;
        border: 2px solid var(--border);
        border-radius: 6px;
        font-size: 1rem;
        width: 120px;
      }
      .btn-check {
        background: var(--primary); color: white; border: none;
        padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: 600;
      }
      .btn-check:hover { background: #4338ca; }

      .help-area { margin-top: 10px; font-size: 0.9rem; }
      .help-btn {
        background: none; border: none; color: #64748b; 
        cursor: pointer; text-decoration: underline; margin-right: 15px;
      }
      .hint-text, .sol-text { 
        display: none; margin-top: 5px; padding: 8px; border-radius: 5px; 
      }
      .hint-text { background: #fffbeb; color: #b45309; }
      .sol-text { background: #f1f5f9; color: #334155; }

      /* --- –ü–†–ê–í–ê –ß–ê–°–¢–ò–ù–ê (–î–û–®–ö–ê) --- */
      #board-section {
        flex: 1;
        position: relative;
        background-image: radial-gradient(#cbd5e1 1px, transparent 1px);
        background-size: 20px 20px;
        background-color: white;
      }
      .tools-panel {
        position: absolute; top: 15px; left: 15px;
        background: white; padding: 8px; border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1); display: flex; gap: 8px;
        z-index: 10;
      }
      .tool-btn {
        width: 40px; height: 40px; border: 1px solid var(--border);
        border-radius: 6px; cursor: pointer; background: white; font-size: 1.2rem;
      }
      .tool-btn.active { background: var(--primary); color: white; border-color: var(--primary); }

      /* –ú–û–î–ê–õ–ö–ê */
      .modal {
        display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.5); justify-content: center; align-items: center; z-index: 1000;
      }
      .modal-content {
        background: white; padding: 30px; border-radius: 15px; text-align: center; max-width: 400px;
        animation: popIn 0.3s ease;
      }
      @keyframes popIn { from {transform: scale(0.8); opacity: 0;} to {transform: scale(1); opacity: 1;} }

      @media (max-width: 768px) {
        body { flex-direction: column; }
        #board-section { height: 35vh; order: 1; border-bottom: 2px solid var(--border); }
        #lesson-section { height: 65vh; order: 2; }
      }
    </style>
  </head>
  <body>

    <div id="lesson-section">
      <header>
        <div class="lesson-title">üîµ –ö–æ–ª–æ, –ö—Ä—É–≥ —Ç–∞ –°–µ–∫—Ç–æ—Ä–∏</div>
        <div class="score-box">
          <span style="color:var(--success)">‚úÖ <span id="s-correct">0</span></span>
          <span style="color:var(--error); margin-left:10px;">‚ùå <span id="s-wrong">0</span></span>
        </div>
      </header>

      <div class="content-wrapper" id="content-root">
        </div>
      
      <div style="text-align:center; padding: 20px;">
        <button onclick="finishLesson()" style="padding:15px 40px; background:var(--text); color:white; border:none; border-radius:30px; font-size:1.1rem; cursor:pointer;">üèÅ –ó–∞–≤–µ—Ä—à–∏—Ç–∏ —É—Ä–æ–∫</button>
      </div>
    </div>

    <div id="board-section">
      <div class="tools-panel">
        <button class="tool-btn active" onclick="setTool('pen')" id="btn-pen" title="–û–ª—ñ–≤–µ—Ü—å">‚úèÔ∏è</button>
        <button class="tool-btn" onclick="setTool('eraser')" id="btn-eraser" title="–ì—É–º–∫–∞">üßπ</button>
        <div style="width:1px; background:#ddd; margin:0 5px;"></div>
        <button class="tool-btn" onclick="drawGrid()" title="–°—ñ—Ç–∫–∞">‚ñ¶</button>
        <button class="tool-btn" onclick="drawCircleTool()" title="–ù–∞–º–∞–ª—é–≤–∞—Ç–∏ –∫–æ–ª–æ">‚≠ï</button>
        <button class="tool-btn" onclick="clearBoard()" style="color:red" title="–û—á–∏—Å—Ç–∏—Ç–∏">üóëÔ∏è</button>
      </div>
      <canvas id="board"></canvas>
    </div>

    <div id="result-modal" class="modal">
      <div class="modal-content">
        <h2 id="modal-h"></h2>
        <div id="modal-t" style="margin: 20px 0; font-size:1.1rem; color:#555;"></div>
        <button onclick="document.getElementById('result-modal').style.display='none'" class="btn-check">–î–æ–±—Ä–µ</button>
      </div>
    </div>

    <script>
      /* ================= –î–ê–ù–Ü –£–†–û–ö–£ ================= */
      
      const lessonModules = [
        {
          id: "m1",
          type: "theory",
          title: "1. –ö–æ–ª–æ —Ç–∞ –ö—Ä—É–≥: –£ —á–æ–º—É —Ä—ñ–∑–Ω–∏—Ü—è?",
          html: `
            <p>–£—è–≤–∏ —Å–æ–±—ñ <b>–æ–±—Ä—É—á</b> –¥–ª—è –≥—ñ–º–Ω–∞—Å—Ç–∏–∫–∏. –¶–µ ‚Äî <b>–ö–û–õ–û</b>. –ö–æ–ª–æ ‚Äî —Ü–µ –ª—ñ–Ω—ñ—è.</p>
            <p>–ê —Ç–µ–ø–µ—Ä —É—è–≤–∏ <b>–º–æ–Ω–µ—Ç—É</b> –∞–±–æ <b>–ø—ñ—Ü—É</b>. –¶–µ ‚Äî <b>–ö–†–£–ì</b>. –ö—Ä—É–≥ ‚Äî —Ü–µ —á–∞—Å—Ç–∏–Ω–∞ –ø–ª–æ—â–∏–Ω–∏, –æ–±–º–µ–∂–µ–Ω–∞ –∫–æ–ª–æ–º.</p>
            
            <div style="display:flex; justify-content:space-around; align-items:center; margin: 20px 0;">
              <svg width="150" height="150" viewBox="0 0 100 100">
                <circle cx="50" cy="50" r="45" stroke="#4f46e5" stroke-width="3" fill="none" />
                <circle cx="50" cy="50" r="2" fill="black" />
                <text x="48" y="55" font-size="10">O</text>
                <text x="40" y="10" font-size="10" fill="#4f46e5">–ö–æ–ª–æ (–ª—ñ–Ω—ñ—è)</text>
              </svg>
              <svg width="150" height="150" viewBox="0 0 100 100">
                <circle cx="50" cy="50" r="45" stroke="none" fill="#e0e7ff" />
                <circle cx="50" cy="50" r="45" stroke="#4f46e5" stroke-width="1" fill="none" />
                <text x="35" y="55" font-size="10" fill="#4f46e5">–ö—Ä—É–≥ (—Ñ—ñ–≥—É—Ä–∞)</text>
              </svg>
            </div>

            <p><b>–û—Å–Ω–æ–≤–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏:</b></p>
            <ul>
              <li><b>–†–∞–¥—ñ—É—Å ($r$)</b> ‚Äî –≤—ñ–¥—Ä—ñ–∑–æ–∫ –≤—ñ–¥ —Ü–µ–Ω—Ç—Ä–∞ –¥–æ –±—É–¥—å-—è–∫–æ—ó —Ç–æ—á–∫–∏ –∫–æ–ª–∞.</li>
              <li><b>–î—ñ–∞–º–µ—Ç—Ä ($d$)</b> ‚Äî –≤—ñ–¥—Ä—ñ–∑–æ–∫, —â–æ —Å–ø–æ–ª—É—á–∞—î –¥–≤—ñ —Ç–æ—á–∫–∏ –∫–æ–ª–∞ —ñ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ —Ü–µ–Ω—Ç—Ä.</li>
            </ul>
            <div class="important-formula">$$d = 2r$$ (–î—ñ–∞–º–µ—Ç—Ä —É–¥–≤—ñ—á—ñ –±—ñ–ª—å—à–∏–π –∑–∞ —Ä–∞–¥—ñ—É—Å)</div>
          `
        },
        {
          id: "t1",
          type: "tasks",
          items: [
            { q: "–†–∞–¥—ñ—É—Å –∫–æ–ª–∞ $r = 5$ —Å–º. –ß–æ–º—É –¥–æ—Ä—ñ–≤–Ω—é—î –¥—ñ–∞–º–µ—Ç—Ä $d$?", a: "10", hint: "$d = 2 \\cdot r$", sol: "$d = 2 \\cdot 5 = 10$ —Å–º." },
            { q: "–î—ñ–∞–º–µ—Ç—Ä –∫—Ä—É–≥–∞ $d = 18$ –º. –ó–Ω–∞–π–¥–∏ —Ä–∞–¥—ñ—É—Å $r$.", a: "9", hint: "$r = d : 2$", sol: "$r = 18 : 2 = 9$ –º." },
            { q: "–ù–∞–π–±—ñ–ª—å—à–∞ —Ö–æ—Ä–¥–∞ –∫–æ–ª–∞ –¥–æ—Ä—ñ–≤–Ω—é—î 20 —Å–º. –Ø–∫–∞ –¥–æ–≤–∂–∏–Ω–∞ —Ä–∞–¥—ñ—É—Å–∞?", a: "10", hint: "–ù–∞–π–±—ñ–ª—å—à–∞ —Ö–æ—Ä–¥–∞ ‚Äî —Ü–µ –¥—ñ–∞–º–µ—Ç—Ä.", sol: "–î—ñ–∞–º–µ—Ç—Ä = 20 —Å–º, –æ—Ç–∂–µ —Ä–∞–¥—ñ—É—Å = 10 —Å–º." },
            { q: "–†–∞–¥—ñ—É—Å –∑–±—ñ–ª—å—à–∏–ª–∏ —É 3 —Ä–∞–∑–∏. –£ —Å–∫—ñ–ª—å–∫–∏ —Ä–∞–∑—ñ–≤ –∑–±—ñ–ª—å—à–∏–≤—Å—è –¥—ñ–∞–º–µ—Ç—Ä?", a: "3", hint: "–î—ñ–∞–º–µ—Ç—Ä –ø—Ä—è–º–æ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ä–∞–¥—ñ—É—Å–∞.", sol: "–£ 3 —Ä–∞–∑–∏, –±–æ $d=2r$." },
            { q: "–ß–æ–º—É –¥–æ—Ä—ñ–≤–Ω—é—î $r$, —è–∫—â–æ $d = 2.4$ –¥–º?", a: "1.2", hint: "–ü–æ–¥—ñ–ª–∏ 2.4 –Ω–∞–≤–ø—ñ–ª.", sol: "$1.2$ –¥–º." }
          ]
        },
        {
          id: "m2",
          type: "theory",
          title: "2. –ß–∏—Å–ª–æ $\\pi$ —ñ –î–æ–≤–∂–∏–Ω–∞ –∫–æ–ª–∞",
          html: `
            <p>–Ø–∫—â–æ –≤–∏–º—ñ—Ä—è—Ç–∏ –¥–æ–≤–∂–∏–Ω—É –±—É–¥—å-—è–∫–æ–≥–æ –∫–æ–ª–∞ (–Ω–∏—Ç–∫–æ—é) —ñ –ø–æ–¥—ñ–ª–∏—Ç–∏ —ó—ó –Ω–∞ –¥—ñ–∞–º–µ—Ç—Ä, –º–∏ –∑–∞–≤–∂–¥–∏ –æ—Ç—Ä–∏–º–∞—î–º–æ –æ–¥–Ω–µ –π —Ç–µ —Å–∞–º–µ —á–∏—Å–ª–æ.</p>
            <p>–¶–µ —á–∏—Å–ª–æ –ø–æ–∑–Ω–∞—á–∞—é—Ç—å –≥—Ä–µ—Ü—å–∫–æ—é –±—É–∫–≤–æ—é <b>$\\pi$ (–ø—ñ)</b>.</p>
            <div class="important-formula">$$\\pi \\approx 3.14$$</div>
            <p><b>–§–æ—Ä–º—É–ª–∞ –¥–æ–≤–∂–∏–Ω–∏ –∫–æ–ª–∞ ($C$):</b></p>
            <p>–û—Å–∫—ñ–ª—å–∫–∏ –¥–æ–≤–∂–∏–Ω–∞ —Ç—Ä–æ—Ö–∏ –±—ñ–ª—å—à–µ –Ω—ñ–∂ 3 –¥—ñ–∞–º–µ—Ç—Ä–∏:</p>
            <div class="important-formula">$$C = \\pi d$$ –∞–±–æ $$C = 2\\pi r$$</div>
          `
        },
        {
          id: "t2",
          type: "tasks",
          items: [
            { q: "–ó–Ω–∞–π–¥–∏ –¥–æ–≤–∂–∏–Ω—É –∫–æ–ª–∞, —è–∫—â–æ $d = 10$ —Å–º. ($\\pi \\approx 3.14$)", a: "31.4", hint: "$C = 3.14 \\cdot 10$", sol: "$31.4$ —Å–º." },
            { q: "–ó–Ω–∞–π–¥–∏ $C$, —è–∫—â–æ —Ä–∞–¥—ñ—É—Å $r = 100$ –º.", a: "628", hint: "$C = 2 \\cdot 3.14 \\cdot 100$", sol: "$2 \\cdot 100 = 200$. $200 \\cdot 3.14 = 628$." },
            { q: "–î–æ–≤–∂–∏–Ω–∞ –∫–æ–ª–∞ $C = 31.4$ –¥–º. –ó–Ω–∞–π–¥–∏ –¥—ñ–∞–º–µ—Ç—Ä $d$.", a: "10", hint: "$d = C : \\pi$", sol: "$31.4 : 3.14 = 10$." },
            { q: "–û–±—á–∏—Å–ª–∏ –¥–æ–≤–∂–∏–Ω—É –∫–æ–ª–∞, —è–∫—â–æ $r = 0.5$ —Å–º.", a: "3.14", hint: "$d = 1$, —Ç–æ–º—É $C = \\pi$", sol: "$2 \\cdot 0.5 = 1$. $1 \\cdot 3.14 = 3.14$." },
            { q: "–Ø–∫ –∑–º—ñ–Ω–∏—Ç—å—Å—è –¥–æ–≤–∂–∏–Ω–∞ –∫–æ–ª–∞, —è–∫—â–æ —Ä–∞–¥—ñ—É—Å –∑–±—ñ–ª—å—à–∏—Ç–∏ –≤ 2 —Ä–∞–∑–∏?", opts: ["–ó–±—ñ–ª—å—à–∏—Ç—å—Å—è –≤ 2 —Ä–∞–∑–∏", "–ó–±—ñ–ª—å—à–∏—Ç—å—Å—è –≤ 4 —Ä–∞–∑–∏", "–ù–µ –∑–º—ñ–Ω–∏—Ç—å—Å—è"], a: "–ó–±—ñ–ª—å—à–∏—Ç—å—Å—è –≤ 2 —Ä–∞–∑–∏", hint: "–§–æ—Ä–º—É–ª–∞ –ª—ñ–Ω—ñ–π–Ω–∞: $2\\pi r$", sol: "–ü—Ä—è–º–∞ –ø—Ä–æ–ø–æ—Ä—Ü—ñ–π–Ω—ñ—Å—Ç—å." }
          ]
        },
        {
          id: "m3",
          type: "theory",
          title: "3. –ü–ª–æ—â–∞ –ö—Ä—É–≥–∞",
          html: `
            <p>–©–æ–± –∑–Ω–∞–π—Ç–∏, —Å–∫—ñ–ª—å–∫–∏ –º—ñ—Å—Ü—è –∑–∞–π–º–∞—î –∫—Ä—É–≥ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Å–∫—ñ–ª—å–∫–∏ —Ç–∫–∞–Ω–∏–Ω–∏ —Ç—Ä–µ–±–∞ –Ω–∞ –∫—Ä—É–≥–ª—É —Å–∫–∞—Ç–µ—Ä—Ç–∏–Ω—É), —à—É–∫–∞—î–º–æ –ø–ª–æ—â—É ($S$).</p>
            <p>–¢—É—Ç —Ä–∞–¥—ñ—É—Å —Ç—Ä–µ–±–∞ –ø—ñ–¥–Ω–æ—Å–∏—Ç–∏ –¥–æ <b>–∫–≤–∞–¥—Ä–∞—Ç–∞</b>!</p>
            <div class="important-formula">$$S = \\pi r^2$$</div>
            <p><i>–ü–∞–º'—è—Ç–∞–π:</i> –°–ø–æ—á–∞—Ç–∫—É –ø—ñ–¥–Ω–æ—Å–∏–º–æ –¥–æ –∫–≤–∞–¥—Ä–∞—Ç–∞, –ø–æ—Ç—ñ–º –º–Ω–æ–∂–∏–º–æ –Ω–∞ 3.14.</p>
          `
        },
        {
          id: "t3",
          type: "tasks",
          items: [
            { q: "–ó–Ω–∞–π–¥–∏ –ø–ª–æ—â—É –∫—Ä—É–≥–∞, —è–∫—â–æ $r=10$ —Å–º.", a: "314", hint: "$S = 3.14 \\cdot 10^2$", sol: "$100 \\cdot 3.14 = 314$ —Å–º$^2$." },
            { q: "–û–±—á–∏—Å–ª–∏ $S$, —è–∫—â–æ —Ä–∞–¥—ñ—É—Å $r=1$ –º.", a: "3.14", hint: "$1^2 = 1$", sol: "$3.14$ –º$^2$." },
            { q: "–î—ñ–∞–º–µ—Ç—Ä $d=20$ —Å–º. –ó–Ω–∞–π–¥–∏ –ø–ª–æ—â—É.", a: "314", hint: "–°–ø–æ—á–∞—Ç–∫—É –∑–Ω–∞–π–¥–∏ $r$!", sol: "$r=10$. $S = 314$." },
            { q: "–ü–ª–æ—â–∞ –∫—Ä—É–≥–∞ $314$ —Å–º$^2$. –ß–æ–º—É –¥–æ—Ä—ñ–≤–Ω—é—î $r^2$?", a: "100", hint: "$r^2 = S : 3.14$", sol: "$314 : 3.14 = 100$." },
            { q: "–ß–æ–º—É –¥–æ—Ä—ñ–≤–Ω—é—î –ø–ª–æ—â–∞, —è–∫—â–æ $r=0$?", a: "0", hint: "–¢–æ—á–∫–∞ –Ω–µ –º–∞—î –ø–ª–æ—â—ñ.", sol: "0." }
          ]
        },
        {
          id: "m4",
          type: "theory",
          title: "4. –°–µ–∫—Ç–æ—Ä–∏ —Ç–∞ –í—ñ–¥—Å–æ—Ç–∫–∏",
          html: `
            <p><b>–°–µ–∫—Ç–æ—Ä</b> ‚Äî —Ü–µ —á–∞—Å—Ç–∏–Ω–∞ –∫—Ä—É–≥–∞, —Å—Ö–æ–∂–∞ –Ω–∞ —à–º–∞—Ç–æ–∫ –ø—ñ—Ü–∏. –í—ñ–Ω –æ–±–º–µ–∂–µ–Ω–∏–π –¥–≤–æ–º–∞ —Ä–∞–¥—ñ—É—Å–∞–º–∏ —ñ –¥—É–≥–æ—é.</p>
            
            <svg width="120" height="120" viewBox="0 0 100 100" style="display:block; margin:10px auto;">
              <path d="M50,50 L90,50 A40,40 0 0,0 60,15 Z" fill="#fca5a5" stroke="none" />
              <circle cx="50" cy="50" r="40" stroke="#333" fill="none" opacity="0.2"/>
              <path d="M50,50 L90,50" stroke="#333"/>
              <path d="M50,50 L60,15" stroke="#333"/>
              <text x="60" y="40" font-size="8">–°–µ–∫—Ç–æ—Ä</text>
            </svg>

            <p>–ü–æ–≤–Ω–∏–π –∫—Ä—É–≥ ‚Äî —Ü–µ <b>$360^\\circ$</b> –∞–±–æ <b>$100\\%$</b>.</p>
            <p>–©–æ–± –ø–æ–±—É–¥—É–≤–∞—Ç–∏ –∫—Ä—É–≥–æ–≤—É –¥—ñ–∞–≥—Ä–∞–º—É, —Ç—Ä–µ–±–∞ –∑–Ω–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª–æ:</p>
            <div class="important-formula">$$1\\% = 3.6^\\circ$$</div>
            <p>(–ë–æ $360 : 100 = 3.6$)</p>
          `
        },
        {
          id: "t4",
          type: "tasks",
          items: [
            { q: "–Ø–∫—É —á–∞—Å—Ç–∏–Ω—É –∫—Ä—É–≥–∞ —Å–∫–ª–∞–¥–∞—î —Å–µ–∫—Ç–æ—Ä –∑ –∫—É—Ç–æ–º $180^\\circ$?", opts: ["–ü–æ–ª–æ–≤–∏–Ω—É", "–¢—Ä–µ—Ç–∏–Ω–∞", "–ß–≤–µ—Ä—Ç—å"], a: "–ü–æ–ª–æ–≤–∏–Ω—É", hint: "$180$ ‚Äî –ø–æ–ª–æ–≤–∏–Ω–∞ –≤—ñ–¥ $360$.", sol: "$\\frac{180}{360} = \\frac{1}{2}$" },
            { q: "–ö—É—Ç —Å–µ–∫—Ç–æ—Ä–∞ $90^\\circ$. –°–∫—ñ–ª—å–∫–∏ —Ü–µ –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤ –ø–ª–æ—â—ñ –∫—Ä—É–≥–∞?", a: "25", hint: "–¶–µ —á–≤–µ—Ä—Ç—å.", sol: "$25\\%$." },
            { q: "–°–µ–∫—Ç–æ—Ä –∑–∞–π–º–∞—î $10\\%$ –∫—Ä—É–≥–∞. –Ø–∫–∏–π –π–æ–≥–æ –∫—É—Ç?", a: "36", hint: "$10 \\cdot 3.6$", sol: "$36^\\circ$." },
            { q: "–Ø–∫–∏–π –∫—É—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î $50\\%$ –∫—Ä—É–≥–∞?", a: "180", hint: "–ü–æ–ª–æ–≤–∏–Ω–∞ –∫—Ä—É–≥–∞.", sol: "$180^\\circ$." },
            { q: "–ó–Ω–∞–π–¥–∏ –ø–ª–æ—â—É —Å–µ–∫—Ç–æ—Ä–∞ $90^\\circ$, —è–∫—â–æ –ø–ª–æ—â–∞ –≤—Å—å–æ–≥–æ –∫—Ä—É–≥–∞ 400 —Å–º$^2$.", a: "100", hint: "–ü–æ–¥—ñ–ª–∏ –Ω–∞ 4.", sol: "$400 : 4 = 100$." },
            // –î–æ–¥–∞—Ç–∫–æ–≤—ñ –∑–∞–¥–∞—á—ñ –Ω–∞ —Ä–æ–∑—É–º—ñ–Ω–Ω—è
            { q: "–£ –∫–ª–∞—Å—ñ 30 —É—á–Ω—ñ–≤. 50% ‚Äî –¥—ñ–≤—á–∞—Ç–∞. –Ø–∫–∏–π –∫—É—Ç —Å–µ–∫—Ç–æ—Ä–∞ –Ω–∞ –¥—ñ–∞–≥—Ä–∞–º—ñ?", a: "180", hint: "50% = –ø–æ–ª–æ–≤–∏–Ω–∞.", sol: "$180^\\circ$." },
            { q: "–°–∫—ñ–ª—å–∫–∏ –≥—Ä–∞–¥—É—Å—ñ–≤ —É $1\\%$ –∫—Ä—É–≥–æ–≤–æ—ó –¥—ñ–∞–≥—Ä–∞–º–∏?", a: "3.6", hint: "$360 : 100$", sol: "$3.6^\\circ$." },
            { q: "–ö—É—Ç —Å–µ–∫—Ç–æ—Ä–∞ $36^\\circ$. –Ø–∫–∞ —Ü–µ —á–∞—Å—Ç–∏–Ω–∞ –∫—Ä—É–≥–∞ (–¥—Ä—ñ–±)?", opts: ["1/10", "1/5", "1/2"], a: "1/10", hint: "–°–∫—ñ–ª—å–∫–∏ —Ä–∞–∑—ñ–≤ 36 –≤–ª—ñ–∑–∞—î –≤ 360?", sol: "$\\frac{36}{360} = \\frac{1}{10}$." },
            { q: "–ü–ª–æ—â–∞ —Å–µ–∫—Ç–æ—Ä–∞ 5 —Å–º$^2$, —ñ —Ü–µ $1/6$ –∫—Ä—É–≥–∞. –Ø–∫–∞ –ø–æ–≤–Ω–∞ –ø–ª–æ—â–∞?", a: "30", hint: "$5 \\cdot 6$", sol: "$30$ —Å–º$^2$." },
            { q: "–°—É–º–∞ —Ç—Ä—å–æ—Ö —Å–µ–∫—Ç–æ—Ä—ñ–≤: $100^\\circ, 100^\\circ, 160^\\circ$. –¶–µ –ø–æ–≤–Ω–∏–π –∫—Ä—É–≥?", opts: ["–¢–∞–∫", "–ù—ñ"], a: "–¢–∞–∫", hint: "–°—É–º–∞ –º–∞—î –±—É—Ç–∏ 360.", sol: "$100+100+160 = 360$." }
          ]
        },
        {
          id: "t_final",
          type: "tasks",
          items: [
             { q: "–ë–æ–Ω—É—Å: –î–æ–≤–∂–∏–Ω–∞ –∫–æ–ª–∞ 6.28. –ó–Ω–∞–π–¥–∏ –ø–ª–æ—â—É –∫—Ä—É–≥–∞ ($S$).", a: "3.14", hint: "–ó–Ω–∞–π–¥–∏ $d$, –ø–æ—Ç—ñ–º $r$, –ø–æ—Ç—ñ–º $S$.", sol: "$d = 6.28:3.14=2$. $r=1$. $S=3.14 \\cdot 1^2 = 3.14$." },
             { q: "–ë–æ–Ω—É—Å: –°–µ–∫—Ç–æ—Ä 25%. –Ø–∫–∏–π –∫—É—Ç?", a: "90", hint: "–ß–≤–µ—Ä—Ç—å.", sol: "$90^\\circ$." },
             { q: "–ë–æ–Ω—É—Å: $5^2$ (–¥–ª—è –ø–ª–æ—â—ñ) —Ü–µ...", a: "25", hint: "5 –Ω–∞ 5", sol: "25." },
             { q: "–ë–æ–Ω—É—Å: $\\pi$ —Ü–µ –ø—Ä–∏–±–ª–∏–∑–Ω–æ...", a: "3.14", hint: "–¢—Ä–∏ —Ü—ñ–ª–∏—Ö...", sol: "3.14" },
             { q: "–ë–æ–Ω—É—Å: –Ø–∫—â–æ $r=2$, —Ç–æ $d=4$, –∞ $C=...$", a: "12.56", hint: "$3.14 \\cdot 4$", sol: "12.56" }
          ]
        }
      ];

      /* ================= –õ–û–ì–Ü–ö–ê –î–û–î–ê–¢–ö–£ ================= */
      
      let totalCorrect = 0;
      let totalWrong = 0;
      let tasksCount = 0;

      function renderContent() {
        const root = document.getElementById('content-root');
        
        lessonModules.forEach(mod => {
          if(mod.type === 'theory') {
            // –†–µ–Ω–¥–µ—Ä —Ç–µ–æ—Ä—ñ—ó
            const div = document.createElement('div');
            div.className = 'theory-block';
            div.innerHTML = `
              <h3 class="theory-title">üìö ${mod.title}</h3>
              <div class="theory-content">${mod.html}</div>
            `;
            root.appendChild(div);
          } else if (mod.type === 'tasks') {
            // –†–µ–Ω–¥–µ—Ä –≥—Ä—É–ø–∏ –∑–∞–≤–¥–∞–Ω—å
            const groupDiv = document.createElement('div');
            groupDiv.className = 'tasks-group';
            
            mod.items.forEach((item, idx) => {
              tasksCount++;
              const uid = `${mod.id}_${idx}`;
              
              let interactionHTML = '';
              if(item.opts) {
                interactionHTML = `<div class="input-area">
                  ${item.opts.map(opt => `<button class="btn-check" style="background:white; color:var(--text); border:1px solid var(--border);" onclick="checkOpt(this, '${opt}', '${item.a}', '${uid}')">${opt}</button>`).join('')}
                </div>`;
              } else {
                interactionHTML = `<div class="input-area">
                  <input type="text" class="ans-input" id="in_${uid}" placeholder="..." onkeydown="if(event.key==='Enter') checkInput('${uid}', '${item.a}')">
                  <button class="btn-check" onclick="checkInput('${uid}', '${item.a}')">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
                </div>`;
              }

              const taskCard = document.createElement('div');
              taskCard.className = 'task-card';
              taskCard.id = `card_${uid}`;
              taskCard.innerHTML = `
                <div class="task-q">${tasksCount}. ${item.q}</div>
                ${interactionHTML}
                <div class="help-area">
                   <button class="help-btn" onclick="toggle('hint_${uid}')">–ü—ñ–¥–∫–∞–∑–∫–∞</button>
                   <button class="help-btn" onclick="toggle('sol_${uid}')">–†–æ–∑–≤'—è–∑–∞–Ω–Ω—è</button>
                   <div id="hint_${uid}" class="hint-text">üí° ${item.hint}</div>
                   <div id="sol_${uid}" class="sol-text">üìù ${item.sol}</div>
                </div>
              `;
              groupDiv.appendChild(taskCard);
            });
            root.appendChild(groupDiv);
          }
        });

        // –ó–∞–ø—É—Å–∫ —Ä–µ–Ω–¥–µ—Ä—É —Ñ–æ—Ä–º—É–ª
        renderMathInElement(document.body, {
          delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "$", right: "$", display: false}
          ],
          throwOnError: false
        });
      }

      function checkInput(uid, correct) {
        const inp = document.getElementById(`in_${uid}`);
        const card = document.getElementById(`card_${uid}`);
        if(inp.disabled) return;
        
        let val = inp.value.trim().replace(',', '.');
        if(!val) return;

        inp.disabled = true;
        if(Math.abs(parseFloat(val) - parseFloat(correct)) < 0.1 || val === correct) {
          card.classList.add('solved-correct');
          totalCorrect++;
        } else {
          card.classList.add('solved-wrong');
          totalWrong++;
          document.getElementById(`sol_${uid}`).style.display = 'block';
        }
        updateStats();
      }

      function checkOpt(btn, val, correct, uid) {
        const card = document.getElementById(`card_${uid}`);
        if(card.getAttribute('data-done')) return;
        
        card.setAttribute('data-done', 'true');
        const btns = card.querySelectorAll('button.btn-check'); // —Å–µ–ª–µ–∫—Ç–æ—Ä –∫–Ω–æ–ø–æ–∫ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤
        
        if(val === correct) {
          btn.style.background = 'var(--success)';
          btn.style.color = 'white';
          card.classList.add('solved-correct');
          totalCorrect++;
        } else {
          btn.style.background = 'var(--error)';
          btn.style.color = 'white';
          card.classList.add('solved-wrong');
          totalWrong++;
          document.getElementById(`sol_${uid}`).style.display = 'block';
        }
        updateStats();
      }

      function toggle(id) {
        const el = document.getElementById(id);
        el.style.display = el.style.display === 'block' ? 'none' : 'block';
        renderMathInElement(el);
      }

      function updateStats() {
        document.getElementById('s-correct').innerText = totalCorrect;
        document.getElementById('s-wrong').innerText = totalWrong;
      }

      function finishLesson() {
        const modal = document.getElementById('result-modal');
        const h = document.getElementById('modal-h');
        const t = document.getElementById('modal-t');
        
        let score = Math.round((totalCorrect / tasksCount) * 12);
        if(tasksCount === 0) score = 0;

        h.innerText = `–í–∞—à–∞ –æ—Ü—ñ–Ω–∫–∞: ${score} / 12`;
        
        if(score >= 10) t.innerText = "–ß—É–¥–æ–≤–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –¢–∏ —Å–ø—Ä–∞–≤–∂–Ω—ñ–π –ø—Ä–æ—Ñ—ñ! üöÄ";
        else if(score >= 7) t.innerText = "–ì–∞—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞! –¢–∏ –¥–æ–±—Ä–µ –∑–∞—Å–≤–æ—ó–≤ —Ç–µ–º—É. üëç";
        else t.innerText = "–í–∞—Ä—Ç–æ —â–µ —Ç—Ä–æ—Ö–∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏ —Ñ–æ—Ä–º—É–ª–∏. –ù–µ –∑–¥–∞–≤–∞–π—Å—è! üí™";

        modal.style.display = 'flex';
      }

      /* ================= –î–û–®–ö–ê (WHITEBOARD) ================= */
      const canvas = document.getElementById('board');
      const ctx = canvas.getContext('2d');
      const section = document.getElementById('board-section');
      let painting = false;
      let currentTool = 'pen';

      function resize() {
        const oldImg = canvas.toDataURL();
        canvas.width = section.offsetWidth;
        canvas.height = section.offsetHeight;
        
        const img = new Image();
        img.src = oldImg;
        img.onload = () => ctx.drawImage(img, 0, 0);
        
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';
      }
      window.addEventListener('resize', resize);
      window.addEventListener('load', () => { resize(); renderContent(); });

      function getPos(e) {
        const r = canvas.getBoundingClientRect();
        return {
          x: (e.touches ? e.touches[0].clientX : e.clientX) - r.left,
          y: (e.touches ? e.touches[0].clientY : e.clientY) - r.top
        };
      }

      canvas.addEventListener('mousedown', start);
      canvas.addEventListener('touchstart', start);
      canvas.addEventListener('mouseup', stop);
      canvas.addEventListener('touchend', stop);
      canvas.addEventListener('mousemove', draw);
      canvas.addEventListener('touchmove', draw);

      function start(e) { painting = true; draw(e); }
      function stop() { painting = false; ctx.beginPath(); }
      function draw(e) {
        if(!painting) return;
        const {x, y} = getPos(e);
        
        ctx.lineWidth = currentTool === 'pen' ? 2 : 20;
        ctx.strokeStyle = currentTool === 'pen' ? '#4f46e5' : '#fff';
        
        ctx.lineTo(x, y);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(x, y);
      }

      function setTool(t) {
        currentTool = t;
        document.getElementById('btn-pen').classList.toggle('active', t==='pen');
        document.getElementById('btn-eraser').classList.toggle('active', t==='eraser');
      }

      function clearBoard() {
        ctx.clearRect(0,0,canvas.width, canvas.height);
      }

      function drawGrid() {
        ctx.beginPath();
        ctx.strokeStyle = '#e2e8f0';
        ctx.lineWidth = 1;
        for(let x=0; x<canvas.width; x+=20) { ctx.moveTo(x,0); ctx.lineTo(x,canvas.height); }
        for(let y=0; y<canvas.height; y+=20) { ctx.moveTo(0,y); ctx.lineTo(canvas.width,y); }
        ctx.stroke();
      }

      function drawCircleTool() {
        const cx = canvas.width/2;
        const cy = canvas.height/2;
        ctx.beginPath();
        ctx.lineWidth = 2;
        ctx.strokeStyle = '#000';
        ctx.arc(cx, cy, 100, 0, Math.PI*2);
        ctx.stroke();
        ctx.beginPath();
        ctx.arc(cx, cy, 3, 0, Math.PI*2);
        ctx.fillStyle='#000'; ctx.fill();
        ctx.fillText("R", cx+50, cy-5);
        ctx.beginPath();
        ctx.moveTo(cx, cy); ctx.lineTo(cx+100, cy);
        ctx.stroke();
        setTool('pen');
      }
    </script>
  </body>
</html>
