<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fraction Hacker v2.0</title>
    <style>
        :root {
            --neon-green: #00ff41;
            --dark-bg: #0d0208;
            --panel-bg: #1a1a1a;
            --text-color: #e0e0e0;
            --accent: #008f11;
        }

        body, html {
            margin: 0; padding: 0;
            height: 100%;
            font-family: 'Courier New', Courier, monospace;
            background: var(--dark-bg);
            color: var(--text-color);
            overflow: hidden;
        }

        /* --- LAYOUT --- */
        .main-container {
            display: flex;
            height: 100vh;
        }

        /* LEFT SIDE: GAME CONTENT */
        .content-area {
            flex: 1;
            height: 100%;
            overflow-y: auto;
            border-right: 2px solid var(--neon-green);
            padding: 20px;
            box-sizing: border-box;
            scrollbar-width: thin;
            scrollbar-color: var(--neon-green) transparent;
        }

        /* RIGHT SIDE: WHITEBOARD */
        .whiteboard-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #fff;
        }

        /* --- FRACTION CSS (THE REAL LOOK) --- */
        .fraction {
            display: inline-flex;
            flex-direction: column;
            vertical-align: middle;
            align-items: center;
            font-weight: bold;
            font-size: 1.2em;
            margin: 0 5px;
        }
        .fraction .num {
            border-bottom: 2px solid var(--neon-green);
            padding: 0 5px;
        }
        .fraction .den {
            padding: 0 5px;
        }
        .whole-num {
            font-size: 1.5em;
            margin-right: 2px;
            vertical-align: middle;
        }
        .math-row {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 15px 0;
            background: rgba(0, 255, 65, 0.05);
            padding: 10px;
            border-radius: 8px;
        }

        /* --- UI COMPONENTS --- */
        .theory-block {
            background: var(--panel-bg);
            border: 1px solid var(--accent);
            padding: 15px;
            margin-bottom: 25px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.2);
        }

        .task-card {
            background: #222;
            border: 1px solid #444;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 10px;
            transition: 0.3s;
        }
        .task-card.correct { border-color: var(--neon-green); }
        .task-card.wrong { border-color: #ff3131; }

        input {
            background: #000;
            border: 1px solid var(--neon-green);
            color: var(--neon-green);
            padding: 8px;
            width: 80px;
            text-align: center;
            font-size: 1.1em;
        }

        .btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 10px 15px;
            cursor: pointer;
            text-transform: uppercase;
            font-weight: bold;
            border-radius: 4px;
        }
        .btn:hover { background: var(--neon-green); color: black; }

        .hint-btn { background: #555; font-size: 0.8em; margin-left: 5px; }

        /* --- WHITEBOARD --- */
        .tools {
            background: #333;
            padding: 10px;
            display: flex;
            gap: 10px;
        }
        canvas { flex: 1; cursor: crosshair; background: #fff; }

        /* --- TEST --- */
        #final-test {
            display: none;
            text-align: center;
            background: #000;
            padding: 40px;
            border: 3px solid var(--neon-green);
        }

        .hidden { display: none; }
    </style>
</head>
<body>

<div class="main-container">
    <div class="content-area" id="content">
        <h1 style="color: var(--neon-green); text-align: center;">‚ö° FRACTION HACKER: MISSION 6 ‚ö°</h1>
        
        <div id="progress" style="margin-bottom: 20px; text-align: center; color: var(--neon-green);">
            –ü–†–û–ì–†–ï–° –ó–õ–ê–ú–£: <span id="solved-count">0</span> / 30
        </div>

        <div class="theory-block">
            <h3>üìÇ LEVEL 1: –ü–ï–†–ï–ö–û–î–£–í–ê–ù–ù–Ø (–ú—ñ—à–∞–Ω—ñ —á–∏—Å–ª–∞)</h3>
            <p>–£—è–≤–∏, —â–æ —Ü—ñ–ª–µ —á–∏—Å–ª–æ ‚Äî —Ü–µ –∫–æ—Ä–æ–±–∫–∞, –∞ –¥—Ä—ñ–± ‚Äî —Ü–µ –∑–∞–ª–∏—à–∫–∏. –©–æ–± "–∑–ª–∞–º–∞—Ç–∏" –º—ñ—à–∞–Ω–µ —á–∏—Å–ª–æ —ñ –∑—Ä–æ–±–∏—Ç–∏ –π–æ–≥–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–º –¥—Ä–æ–±–æ–º:</p>
            <p>1. –ü–æ–º–Ω–æ–∂ <b>–¶—ñ–ª–µ</b> –Ω–∞ <b>–ù–∏–∂–Ω—é —á–∞—Å—Ç–∏–Ω—É</b> (–∑–Ω–∞–º–µ–Ω–Ω–∏–∫).<br>
               2. –î–æ–¥–∞–π <b>–í–µ—Ä—Ö–Ω—é —á–∞—Å—Ç–∏–Ω—É</b> (—á–∏—Å–µ–ª—å–Ω–∏–∫).<br>
               3. –ó–∞–ø–∏—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–≤–µ—Ä—Ö—É, –∞ –Ω–∏–∑ –∑–∞–ª–∏—à–∏ —è–∫ –±—É–≤!</p>
            <div class="math-row">
                <span class="whole-num">2</span>
                <div class="fraction"><div class="num">1</div><div class="den">3</div></div>
                <span> = </span>
                <div class="fraction"><div class="num">2 √ó 3 + 1</div><div class="den">3</div></div>
                <span> = </span>
                <div class="fraction"><div class="num">7</div><div class="den">3</div></div>
            </div>
        </div>
        <div id="tasks-l1"></div>

        <div class="theory-block">
            <h3>üìÇ LEVEL 2: –°–ü–Ü–õ–¨–ù–ò–ô –ö–ê–ù–ê–õ (–ó–Ω–∞–º–µ–Ω–Ω–∏–∫–∏)</h3>
            <p>–ú–∏ –Ω–µ –º–æ–∂–µ–º–æ –¥–æ–¥–∞–≤–∞—Ç–∏ –¥—Ä–æ–±–∏, —è–∫—â–æ –≤ –Ω–∏—Ö —Ä—ñ–∑–Ω—ñ –∑–Ω–∞–º–µ–Ω–Ω–∏–∫–∏ (–Ω–∏–∂–Ω—ñ —Ü–∏—Ñ—Ä–∏). –¶–µ —è–∫ –Ω–∞–º–∞–≥–∞—Ç–∏—Å—è –∑'—î–¥–Ω–∞—Ç–∏ –¥–µ—Ç–∞–ª—ñ –≤—ñ–¥ —Ä—ñ–∑–Ω–∏—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ñ–≤.</p>
            <p><b>–•–∞–∫–µ—Ä—Å—å–∫–∏–π —Ç—Ä—é–∫:</b> –ó–Ω–∞–π–¥–∏ —á–∏—Å–ª–æ, —è–∫–µ –¥—ñ–ª–∏—Ç—å—Å—è –Ω–∞ –æ–±–∏–¥–≤–∞ –∑–Ω–∞–º–µ–Ω–Ω–∏–∫–∏. –ü–æ–º–Ω–æ–∂ –≤–µ—Ä—Ö —ñ –Ω–∏–∑ –∫–æ–∂–Ω–æ–≥–æ –¥—Ä–æ–±—É –Ω–∞ –ø–æ—Ç—Ä—ñ–±–Ω–µ —á–∏—Å–ª–æ.</p>
        </div>
        <div id="tasks-l2"></div>

        <div class="theory-block">
            <h3>üìÇ LEVEL 3: –§–Ü–ù–ê–õ–¨–ù–ò–ô –ó–õ–ê–ú (–ú–Ω–æ–∂–µ–Ω–Ω—è/–î—ñ–ª–µ–Ω–Ω—è)</h3>
            <p><b>–ú–Ω–æ–∂–µ–Ω–Ω—è:</b> –ü—Ä–æ—Å—Ç–æ –º–Ω–æ–∂ –≤–µ—Ä—Ö –Ω–∞ –≤–µ—Ä—Ö, –Ω–∏–∑ –Ω–∞ –Ω–∏–∑. –ù–∞–π–ª–µ–≥—à–∞ –º—ñ—Å—ñ—è!<br>
               <b>–î—ñ–ª–µ–Ω–Ω—è:</b> –ü–µ—Ä–µ–≤–µ—Ä–Ω–∏ –¥—Ä—É–≥–∏–π –¥—Ä—ñ–± (–∑—Ä–æ–±–∏ –π–æ–≥–æ "–¥–æ–≥–æ—Ä–∏ –Ω–æ–≥–∞–º–∏") —ñ —Ç–æ–¥—ñ –º–Ω–æ–∂!</p>
        </div>
        <div id="tasks-l3"></div>

        <div style="text-align: center; margin: 50px 0;">
            <button class="btn" style="padding: 20px 40px; font-size: 1.5em;" onclick="openTest()">üî• –ó–ê–ü–£–°–¢–ò–¢–ò –§–Ü–ù–ê–õ–¨–ù–ò–ô –¢–ï–°–¢</button>
        </div>

        <div id="final-test">
            <h2 style="color: var(--neon-green);">‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–ò–ô –ó–õ–ê–ú ‚ö†Ô∏è</h2>
            <div id="test-content"></div>
            <br>
            <button class="btn" onclick="finishLesson()">–ó–ê–í–ï–†–®–ò–¢–ò –ú–Ü–°–Ü–Æ</button>
        </div>
    </div>

    <div class="whiteboard-area">
        <div class="tools">
            <button class="btn" onclick="setMode('draw')">‚úèÔ∏è –û–ª—ñ–≤–µ—Ü—å</button>
            <button class="btn" onclick="setMode('erase')">üßΩ –ì—É–º–∫–∞</button>
            <button class="btn" onclick="clearBoard()" style="background: #900;">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏</button>
            <button class="btn" onclick="drawGrid()" style="background: #005fbd;">üåê –°—ñ—Ç–∫–∞</button>
        </div>
        <canvas id="board"></canvas>
    </div>
</div>

<script>
    // --- –ì–ï–ù–ï–†–ê–¶–Ü–Ø –ó–ê–í–î–ê–ù–¨ ---
    const tasks = [
        // Level 1: Conversion (10 tasks)
        { id: 1, q: '–ü–µ—Ä–µ—Ç–≤–æ—Ä–∏ <span class="whole-num">1</span><div class="fraction"><div class="num">1</div><div class="den">2</div></div>', a: "3/2", h: "1*2+1" },
        { id: 2, q: '–ü–µ—Ä–µ—Ç–≤–æ—Ä–∏ <span class="whole-num">2</span><div class="fraction"><div class="num">1</div><div class="den">3</div></div>', a: "7/3", h: "2*3+1" },
        { id: 3, q: '–ü–µ—Ä–µ—Ç–≤–æ—Ä–∏ <span class="whole-num">3</span><div class="fraction"><div class="num">2</div><div class="den">5</div></div>', a: "17/5", h: "3*5+2" },
        { id: 4, q: '–í–∏–¥—ñ–ª–∏ —Ü—ñ–ª—É —á–∞—Å—Ç–∏–Ω—É <div class="fraction"><div class="num">5</div><div class="den">2</div></div> (–Ω-—Ä: 2 1/2)', a: "2 1/2", h: "5 –¥—ñ–ª–∏–º–æ –Ω–∞ 2" },
        { id: 5, q: '–ü–µ—Ä–µ—Ç–≤–æ—Ä–∏ <span class="whole-num">4</span><div class="fraction"><div class="num">1</div><div class="den">4</div></div>', a: "17/4", h: "4*4+1" },
        { id: 6, q: '–ü–µ—Ä–µ—Ç–≤–æ—Ä–∏ <span class="whole-num">1</span><div class="fraction"><div class="num">5</div><div class="den">6</div></div>', a: "11/6", h: "1*6+5" },
        { id: 7, q: '–í–∏–¥—ñ–ª–∏ —Ü—ñ–ª—É —á–∞—Å—Ç–∏–Ω—É <div class="fraction"><div class="num">10</div><div class="den">3</div></div>', a: "3 1/3", h: "10 : 3" },
        { id: 8, q: '–ü–µ—Ä–µ—Ç–≤–æ—Ä–∏ <span class="whole-num">5</span><div class="fraction"><div class="num">1</div><div class="den">2</div></div>', a: "11/2", h: "5*2+1" },
        { id: 9, q: '–í–∏–¥—ñ–ª–∏ —Ü—ñ–ª—É —á–∞—Å—Ç–∏–Ω—É <div class="fraction"><div class="num">7</div><div class="den">4</div></div>', a: "1 3/4", h: "7 : 4" },
        { id: 10, q: '–ü–µ—Ä–µ—Ç–≤–æ—Ä–∏ <span class="whole-num">2</span><div class="fraction"><div class="num">3</div><div class="den">10</div></div>', a: "23/10", h: "2*10+3" },

        // Level 2: Adding/Sub (10 tasks)
        { id: 11, q: '<div class="fraction"><div class="num">1</div><div class="den">4</div></div> + <div class="fraction"><div class="num">1</div><div class="den">2</div></div>', a: "3/4", h: "–°–ø—ñ–ª—å–Ω–∏–π –∑–Ω–∞–º–µ–Ω–Ω–∏–∫ 4" },
        { id: 12, q: '<div class="fraction"><div class="num">1</div><div class="den">3</div></div> + <div class="fraction"><div class="num">1</div><div class="den">6</div></div>', a: "1/2", h: "–ë—É–¥–µ 3/6, —Å–∫–æ—Ä–æ—Ç–∏!" },
        { id: 13, q: '<div class="fraction"><div class="num">2</div><div class="den">3</div></div> - <div class="fraction"><div class="num">1</div><div class="den">3</div></div>', a: "1/3", h: "–ü—Ä–æ—Å—Ç–æ –≤—ñ–¥–Ω—ñ–º–∏ –≤–µ—Ä—Ö" },
        { id: 14, q: '<div class="fraction"><div class="num">1</div><div class="den">2</div></div> + <div class="fraction"><div class="num">1</div><div class="den">3</div></div>', a: "5/6", h: "–°–ø—ñ–ª—å–Ω–∏–π –∑–Ω–∞–º–µ–Ω–Ω–∏–∫ 6" },
        { id: 15, q: '<div class="fraction"><div class="num">3</div><div class="den">4</div></div> - <div class="fraction"><div class="num">1</div><div class="den">2</div></div>', a: "1/4", h: "1/2 —Ü–µ 2/4" },
        { id: 16, q: '<div class="fraction"><div class="num">5</div><div class="den">8</div></div> + <div class="fraction"><div class="num">1</div><div class="den">4</div></div>', a: "7/8", h: "1/4 = 2/8" },
        { id: 17, q: '1 - <div class="fraction"><div class="num">1</div><div class="den">3</div></div>', a: "2/3", h: "1 —Ü–µ 3/3" },
        { id: 18, q: '<div class="fraction"><div class="num">2</div><div class="den">5</div></div> + <div class="fraction"><div class="num">1</div><div class="den">10</div></div>', a: "1/2", h: "5/10 = 1/2" },
        { id: 19, q: '<div class="fraction"><div class="num">7</div><div class="den">9</div></div> - <div class="fraction"><div class="num">1</div><div class="den">3</div></div>', a: "4/9", h: "1/3 = 3/9" },
        { id: 20, q: '<div class="fraction"><div class="num">1</div><div class="den">6</div></div> + <div class="fraction"><div class="num">1</div><div class="den">2</div></div>', a: "2/3", h: "4/6 = 2/3" },

        // Level 3: Mult/Div (10 tasks)
        { id: 21, q: '<div class="fraction"><div class="num">1</div><div class="den">2</div></div> √ó <div class="fraction"><div class="num">1</div><div class="den">3</div></div>', a: "1/6", h: "–í–µ—Ä—Ö * –≤–µ—Ä—Ö, –Ω–∏–∑ * –Ω–∏–∑" },
        { id: 22, q: '<div class="fraction"><div class="num">2</div><div class="den">3</div></div> √ó <div class="fraction"><div class="num">3</div><div class="den">4</div></div>', a: "1/2", h: "–ë—É–¥–µ 6/12 = 1/2" },
        { id: 23, q: '<div class="fraction"><div class="num">1</div><div class="den">2</div></div> : 2', a: "1/4", h: "1/2 * 1/2" },
        { id: 24, q: '3 √ó <div class="fraction"><div class="num">1</div><div class="den">3</div></div>', a: "1", h: "3/3 = 1" },
        { id: 25, q: '<div class="fraction"><div class="num">4</div><div class="den">5</div></div> : <div class="fraction"><div class="num">4</div><div class="den">5</div></div>', a: "1", h: "–ß–∏—Å–ª–æ –¥—ñ–ª–∏—Ç–∏ —Å–∞–º–µ –Ω–∞ —Å–µ–±–µ" },
        { id: 26, q: '<div class="fraction"><div class="num">2</div><div class="den">7</div></div> √ó <div class="fraction"><div class="num">7</div><div class="den">2</div></div>', a: "1", h: "–í—Å–µ —Å–∫–æ—Ä–æ—á—É—î—Ç—å—Å—è" },
        { id: 27, q: '<div class="fraction"><div class="num">1</div><div class="den">10</div></div> √ó 5', a: "1/2", h: "5/10 = 1/2" },
        { id: 28, q: '<div class="fraction"><div class="num">3</div><div class="den">4</div></div> : <div class="fraction"><div class="num">1</div><div class="den">2</div></div>', a: "1 1/2", h: "3/4 * 2/1 = 6/4" },
        { id: 29, q: '<div class="fraction"><div class="num">1</div><div class="den">5</div></div> : <div class="fraction"><div class="num">1</div><div class="den">5</div></div>', a: "1", h: "–†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≤–∂–¥–∏ 1" },
        { id: 30, q: '<span class="whole-num">1</span><div class="fraction"><div class="num">1</div><div class="den">2</div></div> √ó 2', a: "3", h: "3/2 * 2 = 3" }
    ];

    let solvedCount = 0;

    function renderTasks() {
        tasks.forEach((t, i) => {
            let target = "tasks-l1";
            if (i >= 10) target = "tasks-l2";
            if (i >= 20) target = "tasks-l3";

            const card = document.createElement('div');
            card.className = 'task-card';
            card.id = `card-${t.id}`;
            card.innerHTML = `
                <div class="math-row">${t.q}</div>
                <div style="text-align:center">
                    <input type="text" id="ans-${t.id}" placeholder="?">
                    <button class="btn" onclick="check(${t.id}, '${t.a}')">OK</button>
                    <button class="btn hint-btn" onclick="alert('–ü—ñ–¥–∫–∞–∑–∫–∞: ${t.h}')">?</button>
                </div>
            `;
            document.getElementById(target).appendChild(card);
        });
    }

    function check(id, correct) {
        const input = document.getElementById(`ans-${id}`);
        const card = document.getElementById(`card-${id}`);
        if (input.value.trim() === correct) {
            if (!card.classList.contains('correct')) {
                solvedCount++;
                document.getElementById('solved-count').innerText = solvedCount;
            }
            card.classList.remove('wrong');
            card.classList.add('correct');
        } else {
            card.classList.add('wrong');
        }
    }

    // --- –§–Ü–ù–ê–õ–¨–ù–ò–ô –¢–ï–°–¢ ---
    const testQuestions = [
        { q: "–û–±—á–∏—Å–ª–∏: 1/2 + 1/3", a: "5/6" },
        { q: "–û–±—á–∏—Å–ª–∏: 2/5 * 5/2", a: "1" },
        { q: "–ü–µ—Ä–µ—Ç–≤–æ—Ä–∏ 2 1/4", a: "9/4" },
        { q: "–û–±—á–∏—Å–ª–∏: 1 - 1/5", a: "4/5" }
    ];

    function openTest() {
        const area = document.getElementById('test-content');
        area.innerHTML = "";
        testQuestions.forEach((t, i) => {
            area.innerHTML += `
                <div style="margin: 15px 0;">
                    <label>${i+1}. ${t.q} = </label>
                    <input type="text" id="test-${i}">
                </div>
            `;
        });
        document.getElementById('final-test').style.display = "block";
        document.getElementById('final-test').scrollIntoView();
    }

    function finishLesson() {
        let score = 0;
        testQuestions.forEach((t, i) => {
            if (document.getElementById(`test-${i}`).value.trim() === t.a) score++;
        });

        const totalGrade = Math.round((solvedCount / 30) * 8 + (score / 4) * 4);
        alert(`–ú–Ü–°–Ü–Ø –í–ò–ö–û–ù–ê–ù–ê!\n–¢–≤–æ—è –æ—Ü—ñ–Ω–∫–∞: ${totalGrade}/12\n\n–¢–∏ —Å–ø—Ä–∞–≤–∂–Ω—ñ–π –º–∞–π—Å—Ç–µ—Ä –¥—Ä–æ–±—ñ–≤! –ö–æ—Ä–æ–ª—ñ–≤—Å—Ç–≤–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ —Ç–µ–ø–µ—Ä —É –±–µ–∑–ø–µ—Ü—ñ –∑–∞–≤–¥—è–∫–∏ —Ç–æ–±—ñ! üöÄ`);
    }

    // --- WHITEBOARD (CANVAS) ---
    const canvas = document.getElementById('board');
    const ctx = canvas.getContext('2d');
    let drawing = false;
    let mode = 'draw';

    function initBoard() {
        canvas.width = canvas.parentElement.clientWidth;
        canvas.height = canvas.parentElement.clientHeight - 60;
    }

    canvas.addEventListener('mousedown', () => drawing = true);
    canvas.addEventListener('mouseup', () => { drawing = false; ctx.beginPath(); });
    canvas.addEventListener('mousemove', draw);

    function draw(e) {
        if (!drawing) return;
        ctx.lineWidth = mode === 'draw' ? 3 : 20;
        ctx.lineCap = 'round';
        ctx.strokeStyle = mode === 'draw' ? '#000' : '#fff';

        ctx.lineTo(e.offsetX, e.offsetY);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(e.offsetX, e.offsetY);
    }

    function setMode(m) { mode = m; }
    function clearBoard() { ctx.clearRect(0, 0, canvas.width, canvas.height); }

    function drawGrid() {
        ctx.strokeStyle = "#ddd";
        ctx.lineWidth = 1;
        for(let x=0; x<canvas.width; x+=30) { ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,canvas.height); ctx.stroke(); }
        for(let y=0; y<canvas.height; y+=30) { ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(canvas.width,y); ctx.stroke(); }
    }

    window.onload = () => {
        renderTasks();
        initBoard();
        drawGrid();
    };
    window.onresize = initBoard;
</script>

</body>
</html>
