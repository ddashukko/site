<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Алгебра 8 клас: Функція y=x²</title>

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
    />
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
    ></script>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    ></script>

    <style>
      :root {
        --primary: #2563eb;
        --primary-light: #eff6ff;
        --success: #16a34a;
        --error: #dc2626;
        --bg: #f8fafc;
        --card: #ffffff;
        --text: #1e293b;
        --border: #e2e8f0;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background-color: var(--bg);
        color: var(--text);
        margin: 0;
        padding: 0;
      }

      header {
        background: var(--card);
        padding: 15px 20px;
        border-bottom: 1px solid var(--border);
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: sticky;
        top: 0;
        z-index: 100;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.03);
      }

      .header-title {
        font-weight: 700;
        font-size: 1.2rem;
        color: var(--primary);
      }

      .stats-container {
        display: flex;
        gap: 15px;
        font-weight: 600;
      }
      .stat-correct {
        color: var(--success);
      }
      .stat-wrong {
        color: var(--error);
      }

      .main-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        padding-bottom: 100px;
      }

      .exercise-block {
        background: var(--card);
        border-radius: 12px;
        border: 1px solid var(--border);
        margin-bottom: 30px;
        overflow: hidden;
      }

      .exercise-header {
        background: var(--primary-light);
        padding: 15px 20px;
        border-bottom: 1px solid var(--border);
      }

      .exercise-title {
        margin: 0;
        font-size: 1.1rem;
        font-weight: 700;
        color: var(--primary);
      }

      .exercise-desc {
        margin: 5px 0 0 0;
        font-size: 0.9rem;
        color: #64748b;
      }

      /* Стиль для SVG */
      .visual-container {
        display: flex;
        justify-content: center;
        padding: 20px;
        background: #fff;
        border-bottom: 1px solid var(--border);
      }

      .task-list {
        display: flex;
        flex-direction: column;
      }

      .task-row {
        padding: 15px 20px;
        border-bottom: 1px solid var(--border);
        display: flex;
        flex-direction: column;
        gap: 12px;
      }
      .task-row:last-child {
        border-bottom: none;
      }

      .task-row.solved-correct {
        background-color: #f0fdf4;
      }
      .task-row.solved-wrong {
        background-color: #fef2f2;
      }

      .task-content {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .task-number {
        font-weight: 600;
        color: #94a3b8;
        min-width: 20px;
      }
      .task-question {
        font-size: 1.1rem;
        font-weight: 500;
      }

      .options-container {
        display: flex;
        flex-wrap: nowrap;
        gap: 10px;
        overflow-x: auto;
        padding-bottom: 5px;
        -webkit-overflow-scrolling: touch;
      }

      .option-btn {
        flex: 1;
        background: white;
        border: 1px solid #cbd5e1;
        border-radius: 8px;
        padding: 10px 15px;
        font-size: 1rem;
        cursor: pointer;
        min-width: 70px;
        white-space: nowrap;
        text-align: center;
        transition: all 0.2s;
      }

      .option-btn:hover:not(:disabled) {
        border-color: var(--primary);
        color: var(--primary);
        background: var(--primary-light);
      }

      .option-btn.selected-correct {
        background: var(--success);
        color: white;
        border-color: var(--success);
      }
      .option-btn.selected-correct .katex {
        color: white !important;
      }

      .option-btn.selected-wrong {
        background: var(--error);
        color: white;
        border-color: var(--error);
      }
      .option-btn.selected-wrong .katex {
        color: white !important;
      }

      .input-group {
        display: flex;
        gap: 10px;
      }
      .input-answer {
        padding: 10px;
        border: 1px solid #cbd5e1;
        border-radius: 8px;
        width: 120px;
        font-size: 1rem;
      }
      .btn-check {
        padding: 10px 20px;
        background: var(--primary);
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
      }
      .input-answer.correct {
        border-color: var(--success);
        background: #f0fdf4;
        color: var(--success);
      }
      .input-answer.wrong {
        border-color: var(--error);
        background: #fef2f2;
      }
    </style>
  </head>
  <body>
    <header>
      <div class="header-title">Dasha Tutor: y = x²</div>
      <div class="stats-container">
        <span class="stat-correct">✅ <span id="val-correct">0</span></span>
        <span class="stat-wrong">❌ <span id="val-wrong">0</span></span>
      </div>
    </header>

    <div class="main-container" id="quiz-root"></div>

    <script>
      const exercises = [
        {
          id: "13.1",
          title: "13.1. (Усно) Види графіків",
          desc: "Визначте фігуру графіка функції:",
          tasks: [
            {
              id: "1)",
              q: "$y = \\frac{15}{x}$",
              a: "Гіпербола",
              opts: ["Пряма", "Парабола", "Гіпербола"],
            },
            {
              id: "2)",
              q: "$y = 9x$",
              a: "Пряма",
              opts: ["Пряма", "Парабола", "Гіпербола"],
            },
            {
              id: "3)",
              q: "$y = 20$",
              a: "Пряма",
              opts: ["Пряма", "Парабола", "Гіпербола"],
            },
            {
              id: "4)",
              q: "$y = x^2$",
              a: "Парабола",
              opts: ["Пряма", "Парабола", "Гіпербола"],
            },
            {
              id: "5)",
              q: "$y = 2x - 5$",
              a: "Пряма",
              opts: ["Пряма", "Парабола", "Гіпербола"],
            },
            {
              id: "6)",
              q: "$y = -\\frac{8}{x}$",
              a: "Гіпербола",
              opts: ["Пряма", "Парабола", "Гіпербола"],
            },
          ],
        },
        {
          id: "13.2",
          title: "13.2. Обчислення значень",
          desc: "Знайдіть значення $y$ для функції $y=x^2$:",
          tasks: [
            { id: "1)", q: "Якщо $x = -4$", a: ["16"], type: "input" },
            { id: "2)", q: "Якщо $x = 0$", a: ["0"], type: "input" },
            { id: "3)", q: "Якщо $x = 6$", a: ["36"], type: "input" },
          ],
        },
        {
          id: "13.4",
          title: "13.4. Робота з графіком",
          desc: "За графіком $y=x^2$ знайдіть:",
          tasks: [
            {
              id: "1)",
              q: "Значення $y$, якщо $x = -1.5$",
              a: "2.25",
              opts: ["1.5", "-2.25", "2.25"],
            },
            {
              id: "2)",
              q: "Значення $x$, якщо $y = 4$",
              a: "2; -2",
              opts: ["2", "-2", "2; -2"],
            },
            {
              id: "3)",
              q: "Кількість цілих $x$, де $y < 5$",
              a: "5",
              opts: ["4", "5", "3"],
            },
          ],
        },
        {
          id: "13.6",
          title: "13.6. Побудова графіка",
          desc: "Уявно побудуйте графік $y=x^2$ на цій координатній площині та знайдіть область значень:",
          // SVG: Фіксована піксельна сітка, початок координат (150, 250)
          visual: `
            <svg width="300" height="300" viewBox="0 0 300 300" style="background:#fff; border:1px solid #ccc; display:block; margin: 0 auto;">
              <defs>
                <pattern id="grid" width="25" height="25" patternUnits="userSpaceOnUse">
                  <path d="M 25 0 L 0 0 0 25" fill="none" stroke="#f1f5f9" stroke-width="1"/>
                </pattern>
              </defs>
              <rect width="100%" height="100%" fill="url(#grid)" />

              <line x1="0" y1="250" x2="300" y2="250" stroke="#334155" stroke-width="2" />
              <line x1="150" y1="300" x2="150" y2="0" stroke="#334155" stroke-width="2" />

              <polygon points="300,250 290,245 290,255" fill="#334155" />
              <polygon points="150,0 145,10 155,10" fill="#334155" />

              <line x1="175" y1="245" x2="175" y2="255" stroke="#334155" stroke-width="2" />
              <text x="170" y="270" font-family="Arial" font-size="14" fill="#475569">1</text>

              <line x1="145" y1="225" x2="155" y2="225" stroke="#334155" stroke-width="2" />
              <text x="130" y="230" font-family="Arial" font-size="14" fill="#475569">1</text>
              
              <text x="135" y="270" font-family="Arial" font-size="14" fill="#475569">0</text>

              <text x="280" y="240" font-family="Arial" font-size="16" font-weight="bold" fill="#334155">x</text>
              <text x="160" y="20" font-family="Arial" font-size="16" font-weight="bold" fill="#334155">y</text>
            </svg>
          `,
          tasks: [
            {
              id: "1)",
              q: "Якщо $-2 \\le x \\le 3$, то область значень $y$:",
              a: "$0 \\le y \\le 9$",
              opts: [
                "$4 \\le y \\le 9$",
                "$0 \\le y \\le 9$",
                "$-2 \\le y \\le 9$",
              ],
            },
          ],
        },
        {
          id: "13.8",
          title: "13.8. Перевірка точок",
          desc: "Чи проходить графік $y=x^2$ через точку:",
          tasks: [
            { id: "1)", q: "$A(-3; -9)$", a: "Ні", opts: ["Так", "Ні"] },
            { id: "2)", q: "$B(-5; 25)$", a: "Так", opts: ["Так", "Ні"] },
            { id: "3)", q: "$C(0; 0)$", a: "Так", opts: ["Так", "Ні"] },
            { id: "4)", q: "$D(12; 4)$", a: "Ні", opts: ["Так", "Ні"] },
          ],
        },
        {
          id: "13.10",
          title: "13.10. Область значень",
          desc: "Знайдіть межі $y$ для заданого проміжку $x$:",
          tasks: [
            {
              id: "1)",
              q: "$-4 \\le x \\le 0$",
              a: "$0 \\le y \\le 16$",
              opts: [
                "$0 \\le y \\le 16$",
                "$-16 \\le y \\le 0$",
                "$0 \\le y \\le 4$",
              ],
            },
            {
              id: "2)",
              q: "$-1 \\le x \\le 2$",
              a: "$0 \\le y \\le 4$",
              opts: [
                "$1 \\le y \\le 4$",
                "$0 \\le y \\le 4$",
                "$0 \\le y \\le 2$",
              ],
            },
          ],
        },
        {
          id: "13.11",
          title: "13.11. Порівняння значень",
          desc: "Порівняйте значення функції (не обчислюючи):",
          tasks: [
            {
              id: "1)",
              q: "$x=3.1$ і $x=-3.1$",
              a: "=",
              opts: [">", "<", "="],
            },
            {
              id: "2)",
              q: "$x=-1.5$ і $x=1.3$",
              a: ">",
              opts: [">", "<", "="],
            },
            { id: "3)", q: "$x=0$ і $x=-2$", a: "<", opts: [">", "<", "="] },
            {
              id: "4)",
              q: "$x=-1.2$ і $x=1.3$",
              a: "<",
              opts: [">", "<", "="],
            },
          ],
        },
        {
          id: "13.12",
          title: "13.12. Графічні рівняння",
          desc: "Знайдіть $x$ (точки перетину графіків):",
          tasks: [
            { id: "1)", q: "$x^2 = 2x$", a: "0; 2", opts: ["0", "2", "0; 2"] },
            {
              id: "2)",
              q: "$x^2 = -\\frac{8}{x}$",
              a: "-2",
              opts: ["2", "-2", "4"],
            },
          ],
        },
        {
          id: "13.14",
          title: "13.14. Побудова з ОДЗ",
          desc: "Спростіть вираз і вкажіть 'виколоту' точку:",
          tasks: [
            {
              id: "1)",
              q: "$y = \\frac{x^3 + x^2}{x + 1}$",
              a: "$x \\ne -1$",
              opts: ["$x \\ne 1$", "$x \\ne -1$", "$x \\ne 0$"],
            },
            {
              id: "2)",
              q: "$y = \\frac{4x^2 - x^4}{4 - x^2}$",
              a: "$x \\ne \\pm 2$",
              opts: ["$x \\ne 2$", "$x \\ne \\pm 2$", "$x \\ne 4$"],
            },
          ],
        },
      ];

      let totalCorrect = 0;
      let totalWrong = 0;

      document.addEventListener("DOMContentLoaded", () => {
        const root = document.getElementById("quiz-root");

        exercises.forEach((ex) => {
          const exBlock = document.createElement("div");
          exBlock.className = "exercise-block";

          let headerHTML = `
            <div class="exercise-header">
              <h3 class="exercise-title">${ex.title}</h3>
              <p class="exercise-desc">${ex.desc}</p>
            </div>
          `;
          exBlock.innerHTML = headerHTML;

          // Додаємо візуалізацію (графік), якщо вона є в об'єкті
          if (ex.visual) {
            const visualDiv = document.createElement("div");
            visualDiv.className = "visual-container";
            visualDiv.innerHTML = ex.visual;
            exBlock.appendChild(visualDiv);
          }

          const taskList = document.createElement("div");
          taskList.className = "task-list";

          ex.tasks.forEach((task) => {
            const row = document.createElement("div");
            row.className = "task-row";

            let contentHTML = `
              <div class="task-content">
                <div class="task-number">${task.id}</div>
                <div class="task-question">${task.q}</div>
              </div>
            `;

            let actionHTML = "";
            if (task.type === "input") {
              const answers = task.a.join("|");
              actionHTML = `
                <div class="input-group">
                  <input type="text" class="input-answer" placeholder="?" onkeypress="if(event.key==='Enter') this.nextElementSibling.click()">
                  <button class="btn-check" onclick="checkInput(this, '${answers}')">OK</button>
                </div>
              `;
            } else {
              actionHTML = `<div class="options-container">`;
              task.opts.forEach((opt) => {
                const safeOpt = opt.replace(/"/g, "&quot;");
                const safeAns = task.a.replace(/"/g, "&quot;");
                actionHTML += `<button class="option-btn" onclick="checkOpt(this, '${safeOpt}', '${safeAns}')">${opt}</button>`;
              });
              actionHTML += `</div>`;
            }

            row.innerHTML =
              contentHTML + `<div style="margin-top:10px;">${actionHTML}</div>`;
            taskList.appendChild(row);
          });

          exBlock.appendChild(taskList);
          root.appendChild(exBlock);
        });

        renderMathInElement(document.body, {
          delimiters: [{ left: "$", right: "$", display: false }],
        });
      });

      function checkOpt(btn, val, ans) {
        const row = btn.closest(".task-row");
        if (row.classList.contains("done")) return;
        row.classList.add("done");

        const v = val.replace(/\\/g, "");
        const a = ans.replace(/\\/g, "");

        row.querySelectorAll(".option-btn").forEach((b) => (b.disabled = true));

        if (v === a) {
          btn.classList.add("selected-correct");
          row.classList.add("solved-correct");
          totalCorrect++;
        } else {
          btn.classList.add("selected-wrong");
          row.classList.add("solved-wrong");
          totalWrong++;
        }
        updateStats();
      }

      function checkInput(btn, ansStr) {
        const row = btn.closest(".task-row");
        const input = row.querySelector("input");
        if (row.classList.contains("done")) return;

        const val = input.value.trim().replace(",", ".");
        const correctArr = ansStr.split("|");

        row.classList.add("done");
        input.disabled = true;
        btn.disabled = true;

        if (correctArr.includes(val)) {
          input.classList.add("correct");
          row.classList.add("solved-correct");
          totalCorrect++;
        } else {
          input.classList.add("wrong");
          row.classList.add("solved-wrong");
          totalWrong++;
        }
        updateStats();
      }

      function updateStats() {
        document.getElementById("val-correct").innerText = totalCorrect;
        document.getElementById("val-wrong").innerText = totalWrong;
      }
    </script>
  </body>
</html>
