<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π —É—Ä–æ–∫ | Dasha Tutor</title>

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
    />

    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
    ></script>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    ></script>

    <style>
      :root {
        --primary: #4a90e2;
        --primary-hover: #357abd;
        --success: #28a745;
        --error: #dc3545;
        --bg: #f0f2f5;
        --card: #ffffff;
        --text: #2c3e50;
        --border-radius: 16px;
        --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.05);
        --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -1px rgba(0, 0, 0, 0.06);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
          0 4px 6px -2px rgba(0, 0, 0, 0.05);
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background-color: var(--bg);
        color: var(--text);
        margin: 0;
        display: flex;
        flex-direction: column;
        height: 100vh;
        overflow: hidden;
      }

      header {
        background: var(--card);
        padding: 0 30px;
        box-shadow: var(--shadow-sm);
        display: flex;
        justify-content: space-between;
        align-items: center;
        height: 64px;
        flex-shrink: 0;
        z-index: 10;
        position: relative;
      }

      .header-title {
        font-weight: 800;
        font-size: 1.3rem;
        color: var(--primary);
        letter-spacing: -0.5px;
      }

      .stats {
        display: flex;
        gap: 12px;
        font-weight: 600;
        font-size: 0.95rem;
      }
      .stat-box {
        padding: 6px 16px;
        border-radius: 99px;
        display: flex;
        align-items: center;
        gap: 6px;
        transition: transform 0.2s;
      }
      .stat-box:hover {
        transform: scale(1.05);
      }
      .stat-correct {
        background: #ecfdf5;
        color: #059669;
        border: 1px solid #a7f3d0;
      }
      .stat-wrong {
        background: #fef2f2;
        color: #dc2626;
        border: 1px solid #fecaca;
      }
      .slide-counter {
        color: #64748b;
        font-size: 0.9rem;
        font-weight: 600;
        background: #f1f5f9;
        padding: 6px 12px;
        border-radius: 8px;
      }

      .slide-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        flex-grow: 1;
        overflow-y: auto;
        padding: 30px 20px 100px 20px;
        scroll-behavior: smooth;
      }

      .content-wrapper {
        width: 100%;
        max-width: 800px;
        display: flex;
        flex-direction: column;
        gap: 24px;
      }

      .task-header-card {
        background: var(--card);
        border-radius: var(--border-radius);
        padding: 30px;
        box-shadow: var(--shadow-sm);
        border-top: 6px solid var(--primary);
      }

      .task-header-card h3 {
        margin-top: 0;
        font-size: 1.4rem;
        color: #1e293b;
        margin-bottom: 15px;
      }

      .task-header-card p {
        color: #64748b;
        font-size: 1.05rem;
        line-height: 1.6;
        margin: 0;
      }

      .subtask-row {
        background: var(--card);
        padding: 30px;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow-md);
        border: 2px solid transparent;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        position: relative;
        overflow: hidden;
      }

      .subtask-row:hover {
        box-shadow: var(--shadow-lg);
      }

      .subtask-row.solved {
        border-color: var(--success);
        background: #f0fdf4;
      }

      .subtask-row.solved::after {
        content: "‚úì";
        position: absolute;
        top: 15px;
        right: 20px;
        font-size: 2rem;
        color: var(--success);
        opacity: 0.2;
        font-weight: bold;
      }

      .question-header {
        display: flex;
        align-items: baseline;
        margin-bottom: 25px;
        gap: 15px;
      }

      .label {
        font-weight: 800;
        color: var(--primary);
        font-size: 1.2rem;
        background: #eff6ff;
        padding: 4px 12px;
        border-radius: 8px;
        flex-shrink: 0;
      }

      .question-text {
        font-weight: 500;
        font-size: 1.4rem;
        color: #334155;
      }

      .options-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 16px;
        width: 100%;
      }

      .choice-btn {
        background: white;
        border: 2px solid #e2e8f0;
        padding: 16px;
        border-radius: 12px;
        cursor: pointer;

        font-size: 1.3rem;
        font-weight: 600;
        color: var(--text);

        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 64px;

        transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);
        position: relative;
        overflow: hidden;
      }

      .choice-btn:hover:not(:disabled) {
        border-color: var(--primary);
        color: var(--primary);
        background-color: #f8fafc;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(74, 144, 226, 0.15);
      }

      .choice-btn.selected-correct {
        background: var(--success);
        color: white;
        border-color: var(--success);
        box-shadow: 0 4px 12px rgba(34, 197, 94, 0.4);
      }

      .choice-btn.selected-correct .katex {
        color: white !important;
      }
      .choice-btn.selected-wrong .katex {
        color: white !important;
      }

      .choice-btn.selected-wrong {
        background: var(--error);
        color: white;
        border-color: var(--error);
        animation: shake 0.4s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
      }

      .input-wrapper {
        display: flex;
        justify-content: center;
        gap: 12px;
        align-items: center;
        background: #f8fafc;
        padding: 20px;
        border-radius: 12px;
      }

      input[type="text"] {
        padding: 12px 20px;
        border: 2px solid #cbd5e1;
        border-radius: 10px;
        width: 140px;
        text-align: center;
        font-size: 1.3rem;
        transition: all 0.2s;
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05);
      }
      input:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 4px rgba(74, 144, 226, 0.1);
        background: white;
      }
      input.correct {
        border-color: var(--success);
        background: #ecfdf5;
        color: var(--success);
        font-weight: bold;
      }
      input.wrong {
        border-color: var(--error);
        background: #fef2f2;
      }

      button.check-btn {
        background: var(--primary);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 10px;
        font-size: 1.1rem;
        cursor: pointer;
        font-weight: 600;
        transition: transform 0.1s, background 0.2s;
        box-shadow: 0 4px 6px rgba(74, 144, 226, 0.2);
      }
      button.check-btn:hover {
        background: var(--primary-hover);
        transform: translateY(-1px);
      }
      button.check-btn:active {
        transform: translateY(1px);
      }

      footer {
        height: 80px;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        border-top: 1px solid #e2e8f0;
        display: flex;
        justify-content: center;
        gap: 20px;
        align-items: center;
        padding: 0 20px;
        flex-shrink: 0;
        position: fixed;
        bottom: 0;
        width: 100%;
        box-sizing: border-box;
        z-index: 100;
      }

      .nav-btn {
        background: white;
        color: var(--text);
        border: 2px solid #e2e8f0;
        padding: 12px 30px;
        font-size: 1.05rem;
        font-weight: 700;
        border-radius: 50px;
        cursor: pointer;
        transition: all 0.2s;
        min-width: 140px;
      }
      .nav-btn:hover:not(:disabled) {
        border-color: var(--primary);
        color: var(--primary);
        background: #f8fafc;
      }
      .nav-btn.primary {
        background: var(--primary);
        color: white;
        border-color: var(--primary);
        box-shadow: 0 4px 15px rgba(74, 144, 226, 0.4);
      }
      .nav-btn.primary:hover:not(:disabled) {
        background: var(--primary-hover);
        border-color: var(--primary-hover);
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(74, 144, 226, 0.5);
      }

      .nav-btn:disabled {
        background: #f1f5f9;
        color: #cbd5e1;
        border-color: transparent;
        cursor: not-allowed;
        box-shadow: none;
      }

      .results-view {
        text-align: center;
        width: 100%;
        animation: fadeIn 0.5s ease;
      }

      @keyframes shake {
        10%,
        90% {
          transform: translate3d(-1px, 0, 0);
        }
        20%,
        80% {
          transform: translate3d(2px, 0, 0);
        }
        30%,
        50%,
        70% {
          transform: translate3d(-4px, 0, 0);
        }
        40%,
        60% {
          transform: translate3d(4px, 0, 0);
        }
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @media (max-width: 600px) {
        .task-header-card {
          padding: 20px;
        }
        .subtask-row {
          padding: 20px;
        }
        .options-grid {
          grid-template-columns: 1fr;
        }
        .header-title {
          font-size: 1rem;
        }
        .stats {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <div class="header-title">Dasha Tutor</div>
      <div class="stats">
        <div class="stat-box stat-correct">
          ‚úÖ <span id="val-correct">0</span>
        </div>
        <div class="stat-box stat-wrong">‚ùå <span id="val-wrong">0</span></div>
      </div>
      <div class="slide-counter" id="slide-counter">Start</div>
    </header>

    <div class="slide-container" id="slide-root"></div>

    <footer id="footer-nav">
      <button class="nav-btn" id="btn-prev" onclick="changeSlide(-1)">
        ‚Üê –ù–∞–∑–∞–¥
      </button>
      <button class="nav-btn primary" id="btn-next" onclick="changeSlide(1)">
        –î–∞–ª—ñ ‚Üí
      </button>
    </footer>

    <script>
      /*
    ================================================================================
    ü§ñ –û–ù–û–í–õ–ï–ù–ò–ô –ö–û–î (–ó–ê–í–î–ê–ù–ù–Ø –ü–†–û –§–£–ù–ö–¶–Ü–Æ y=x¬≤)
    ================================================================================
    */

      // =========================================================
      // –î–ê–ù–Ü –£–†–û–ö–£ (–¢–µ–º–∞: –§—É–Ω–∫—Ü—ñ—è y=x¬≤)
      // =========================================================
      const lessonData = [
        {
          id: "13.1",
          title: "13.1. –í–∏–¥–∏ –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ —Ñ—É–Ω–∫—Ü—ñ–π (–£—Å–Ω–æ)",
          description:
            "–í–∏–∑–Ω–∞—á—Ç–µ, —è–∫–æ—é –≥–µ–æ–º–µ—Ç—Ä–∏—á–Ω–æ—é —Ñ—ñ–≥—É—Ä–æ—é —î –≥—Ä–∞—Ñ—ñ–∫ –∑–∞–¥–∞–Ω–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó (–ì—ñ–ø–µ—Ä–±–æ–ª–∞, –ü–∞—Ä–∞–±–æ–ª–∞ —á–∏ –ü—Ä—è–º–∞).",
          type: "choice",
          tasks: [
            {
              label: "1)",
              q: "$y = x^2$",
              a: "–ü–∞—Ä–∞–±–æ–ª–∞",
              opts: ["–ü—Ä—è–º–∞", "–ì—ñ–ø–µ—Ä–±–æ–ª–∞", "–ü–∞—Ä–∞–±–æ–ª–∞"],
            },
            {
              label: "2)",
              q: "$y = 4x - 3$",
              a: "–ü—Ä—è–º–∞",
              opts: ["–ü–∞—Ä–∞–±–æ–ª–∞", "–ü—Ä—è–º–∞", "–ì—ñ–ø–µ—Ä–±–æ–ª–∞"],
            },
            {
              label: "3)",
              q: "$y = \\frac{12}{x}$",
              a: "–ì—ñ–ø–µ—Ä–±–æ–ª–∞",
              opts: ["–ì—ñ–ø–µ—Ä–±–æ–ª–∞", "–ü–∞—Ä–∞–±–æ–ª–∞", "–ü—Ä—è–º–∞"],
            },
            {
              label: "4)",
              q: "$y = -2x$",
              a: "–ü—Ä—è–º–∞",
              opts: ["–ü—Ä—è–º–∞", "–ì—ñ–ø–µ—Ä–±–æ–ª–∞", "–ü–∞—Ä–∞–±–æ–ª–∞"],
            },
          ],
        },
        {
          id: "13.2",
          title: "13.2. –û–±—á–∏—Å–ª–µ–Ω–Ω—è –∑–Ω–∞—á–µ–Ω—å —Ñ—É–Ω–∫—Ü—ñ—ó y = x¬≤",
          description:
            "–î–ª—è —Ñ—É–Ω–∫—Ü—ñ—ó $y = x^2$ –∑–Ω–∞–π–¥—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è $y$, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞–¥–∞–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–Ω—é $x$.",
          type: "mixed",
          tasks: [
            {
              label: "1)",
              q: "–Ø–∫—â–æ $x = 3$, —Ç–æ $y = ...$",
              a: ["9"],
              opts: null,
            },
            {
              label: "2)",
              q: "–Ø–∫—â–æ $x = -5$, —Ç–æ $y = ...$",
              a: ["25"],
              opts: null,
            },
            {
              label: "3)",
              q: "–Ø–∫—â–æ $x = 0.4$, —Ç–æ $y = ...$",
              a: ["0.16", "0,16"],
              opts: null,
            },
            {
              label: "4)",
              q: "–Ø–∫—â–æ $x = -\\frac{1}{2}$, —Ç–æ $y = ...$",
              a: ["0.25", "1/4", "0,25"],
              opts: null,
            },
          ],
        },
        {
          id: "13.8",
          title: "13.8. –ß–∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –≥—Ä–∞—Ñ—ñ–∫ —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É?",
          description:
            "–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Ç–æ—á–∫–∞ –≥—Ä–∞—Ñ—ñ–∫—É —Ñ—É–Ω–∫—Ü—ñ—ó $y = x^2$. –ü—ñ–¥—Å—Ç–∞–≤—Ç–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ —É —Ä—ñ–≤–Ω—è–Ω–Ω—è.",
          type: "choice",
          tasks: [
            {
              label: "1)",
              q: "$A(-2; 4)$",
              a: "–¢–∞–∫",
              opts: ["–¢–∞–∫", "–ù—ñ"],
            },
            {
              label: "2)",
              q: "$B(-3; -9)$",
              a: "–ù—ñ",
              opts: ["–¢–∞–∫", "–ù—ñ"],
            },
            {
              label: "3)",
              q: "$C(5; 25)$",
              a: "–¢–∞–∫",
              opts: ["–¢–∞–∫", "–ù—ñ"],
            },
            {
              label: "4)",
              q: "$D(0.1; 0.1)$",
              a: "–ù—ñ",
              opts: ["–¢–∞–∫", "–ù—ñ"],
            },
          ],
        },
        {
          id: "13.11",
          title: "13.11. –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑–Ω–∞—á–µ–Ω—å —Ñ—É–Ω–∫—Ü—ñ—ó",
          description:
            "–ù–µ –æ–±—á–∏—Å–ª—é—é—á–∏ –∑–Ω–∞—á–µ–Ω—å, –ø–æ—Ä—ñ–≤–Ω—è–π—Ç–µ $y_1$ —Ç–∞ $y_2$ –¥–ª—è —Ñ—É–Ω–∫—Ü—ñ—ó $y = x^2$, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —ó—ó –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ (–ø–∞—Ä–Ω—ñ—Å—Ç—å, –∑—Ä–æ—Å—Ç–∞–Ω–Ω—è).",
          type: "choice",
          tasks: [
            {
              label: "1)",
              q: "–ü–æ—Ä—ñ–≤–Ω—è–π—Ç–µ –∑–Ω–∞—á–µ–Ω–Ω—è –ø—Ä–∏ $x = -2.7$ —Ç–∞ $x = 2.7$",
              a: "–†—ñ–≤–Ω—ñ",
              opts: ["–ë—ñ–ª—å—à–µ –ø–µ—Ä—à–µ", "–†—ñ–≤–Ω—ñ", "–ë—ñ–ª—å—à–µ –¥—Ä—É–≥–µ"],
            },
            {
              label: "2)",
              q: "–ü–æ—Ä—ñ–≤–Ω—è–π—Ç–µ –∑–Ω–∞—á–µ–Ω–Ω—è –ø—Ä–∏ $x = -4$ —Ç–∞ $x = -5$",
              a: "$y(-5) > y(-4)$",
              opts: ["$y(-4) > y(-5)$", "$y(-5) > y(-4)$", "–†—ñ–≤–Ω—ñ"],
            },
            {
              label: "3)",
              q: "–ü–æ—Ä—ñ–≤–Ω—è–π—Ç–µ –∑–Ω–∞—á–µ–Ω–Ω—è –ø—Ä–∏ $x = 3$ —Ç–∞ $x = 0$",
              a: "$y(3) > y(0)$",
              opts: ["$y(3) > y(0)$", "$y(0) > y(3)$", "–†—ñ–≤–Ω—ñ"],
            },
          ],
        },
        {
          id: "13.10",
          title: "13.10. –û–±–ª–∞—Å—Ç—å –∑–Ω–∞—á–µ–Ω—å —Ñ—É–Ω–∫—Ü—ñ—ó",
          description:
            "–ó–Ω–∞–π–¥—ñ—Ç—å –æ–±–ª–∞—Å—Ç—å –∑–Ω–∞—á–µ–Ω—å —Ñ—É–Ω–∫—Ü—ñ—ó $y = x^2$ (–º–µ–∂—ñ $y$), —è–∫—â–æ $x$ –Ω–∞–ª–µ–∂–∏—Ç—å –∑–∞–¥–∞–Ω–æ–º—É –ø—Ä–æ–º—ñ–∂–∫—É.",
          type: "choice",
          tasks: [
            {
              label: "1)",
              q: "–Ø–∫—â–æ $-2 \\le x \\le 2$",
              a: "$0 \\le y \\le 4$",
              opts: [
                "$-4 \\le y \\le 4$",
                "$0 \\le y \\le 4$",
                "$4 \\le y \\le 4$",
              ],
            },
            {
              label: "2)",
              q: "–Ø–∫—â–æ $1 \\le x \\le 3$",
              a: "$1 \\le y \\le 9$",
              opts: [
                "$1 \\le y \\le 9$",
                "$1 \\le y \\le 3$",
                "$0 \\le y \\le 9$",
              ],
            },
            {
              label: "3)",
              q: "–Ø–∫—â–æ $-4 \\le x \\le -1$",
              a: "$1 \\le y \\le 16$",
              opts: [
                "$-16 \\le y \\le -1$",
                "$1 \\le y \\le 4$",
                "$1 \\le y \\le 16$",
              ],
            },
          ],
        },
        {
          id: "13.12",
          title: "13.12. –û–±–µ—Ä–Ω–µ–Ω–∞ –∑–∞–¥–∞—á–∞",
          description:
            "–ó–Ω–∞–π–¥—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è –∞—Ä–≥—É–º–µ–Ω—Ç—É $x$, —è–∫—â–æ –≤—ñ–¥–æ–º–µ –∑–Ω–∞—á–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó $y = x^2$.",
          type: "choice",
          tasks: [
            {
              label: "1)",
              q: "–ó–Ω–∞–π–¥—ñ—Ç—å $x$, —è–∫—â–æ $y = 36$",
              a: "$x = 6$ –∞–±–æ $x = -6$",
              opts: [
                "–¢—ñ–ª—å–∫–∏ $x = 6$",
                "$x = 6$ –∞–±–æ $x = -6$",
                "–¢—ñ–ª—å–∫–∏ $x = -6$",
              ],
            },
            {
              label: "2)",
              q: "–ó–Ω–∞–π–¥—ñ—Ç—å $x$, —è–∫—â–æ $y = 0$",
              a: "$x = 0$",
              opts: ["$x = 0$", "$x = 1$", "–ù–µ–º–∞—î —Ä–æ–∑–≤'—è–∑–∫—ñ–≤"],
            },
            {
              label: "3)",
              q: "–ó–Ω–∞–π–¥—ñ—Ç—å $x$, —è–∫—â–æ $y = 81$",
              a: "$\\pm 9$",
              opts: ["9", "-9", "$\\pm 9$"],
            },
            {
              label: "4)",
              q: "–ó–Ω–∞–π–¥—ñ—Ç—å $x$, —è–∫—â–æ $y = -4$",
              a: "–ö–æ—Ä–µ–Ω—ñ–≤ –Ω–µ–º–∞—î",
              opts: ["2", "-2", "–ö–æ—Ä–µ–Ω—ñ–≤ –Ω–µ–º–∞—î"],
            },
          ],
        },
      ];

      // =========================================================

      let currentIndex = 0;
      let correctTotal = 0;
      let wrongTotal = 0;

      const root = document.getElementById("slide-root");
      const counter = document.getElementById("slide-counter");
      const statCorrect = document.getElementById("val-correct");
      const statWrong = document.getElementById("val-wrong");
      const btnPrev = document.getElementById("btn-prev");
      const btnNext = document.getElementById("btn-next");
      const footer = document.getElementById("footer-nav");

      // –î–æ–ø–æ–º—ñ–∂–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥—É –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏
      function renderMath() {
        if (typeof renderMathInElement === "function") {
          renderMathInElement(document.body, {
            delimiters: [
              { left: "$$", right: "$$", display: true },
              { left: "$", right: "$", display: false },
            ],
            throwOnError: false,
          });
        }
      }

      function init() {
        if (lessonData.length > 0) {
          renderSlide(0);
        } else {
          root.innerHTML =
            "<h2 style='text-align:center; margin-top:50px; color:#555;'>–î–∞–Ω—ñ —É—Ä–æ–∫—É —â–µ –Ω–µ –¥–æ–¥–∞–Ω–æ.</h2>";
        }
      }

      function renderSlide(index) {
        currentIndex = index;
        const data = lessonData[index];

        counter.innerText = `${index + 1} –∑ ${lessonData.length}`;
        btnPrev.disabled = index === 0;
        btnNext.innerText =
          index === lessonData.length - 1 ? "–ó–∞–≤–µ—Ä—à–∏—Ç–∏" : "–î–∞–ª—ñ ‚Üí";
        btnNext.disabled = false;

        let subTasksHTML = "";

        data.tasks.forEach((task) => {
          let inputHTML = "";

          // –Ø–∫—â–æ —î options
          if (task.opts && task.opts.length > 0) {
            let btnsHTML = "";
            task.opts.forEach((opt) => {
              const cleanOpt = opt.replace(/"/g, "&quot;");
              const cleanA = Array.isArray(task.a) ? task.a[0] : task.a;
              btnsHTML += `<button class="choice-btn" onclick="checkChoice(this, '${cleanOpt.replace(
                /\\/g,
                "\\\\"
              )}', '${cleanA.replace(
                /\\/g,
                "\\\\"
              )}', this.parentElement.parentElement.parentElement)">${opt}</button>`;
            });
            inputHTML = `<div class="options-grid">${btnsHTML}</div>`;
          } else {
            // –ü–æ–ª–µ –≤–≤–æ–¥—É
            const answerStr = Array.isArray(task.a) ? task.a.join("|") : task.a;
            inputHTML = `
                        <div class="input-wrapper">
                            <input type="text" placeholder="?" onkeypress="handleEnter(event, this)">
                            <button class="check-btn" onclick="checkInput(this.previousElementSibling, '${answerStr}', this.parentElement.parentElement.parentElement)">OK</button>
                        </div>
                    `;
          }

          subTasksHTML += `
                    <div class="subtask-row">
                        <div class="question-header">
                            <div class="label">${task.label}</div>
                            <div class="question-text">${task.q}</div>
                        </div>
                        <div class="interaction-area">${inputHTML}</div>
                    </div>
                `;
        });

        // –°–¢–†–£–ö–¢–£–†–ê: –û–¥–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ –ø–æ —Ü–µ–Ω—Ç—Ä—É (content-wrapper)
        root.innerHTML = `
            <div class="content-wrapper">
                <div class="task-header-card">
                    <h3>${data.title}</h3>
                    <p>${data.description}</p>
                </div>
                
                ${subTasksHTML}
            </div>
            `;

        renderMath();
        // –°–∫—Ä–æ–ª–∏–º–æ –Ω–∞–≤–µ—Ä—Ö –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Å–ª–∞–π–¥—É
        document.querySelector(".slide-container").scrollTop = 0;
      }

      function changeSlide(dir) {
        const next = currentIndex + dir;
        if (next >= lessonData.length) {
          showResults();
          return;
        }
        if (next >= 0 && next < lessonData.length) {
          renderSlide(next);
        }
      }

      function showResults() {
        footer.style.display = "none";
        counter.innerText = "–§—ñ–Ω—ñ—à";
        let detailsHTML = "";
        lessonData.forEach((task) => {
          const mistakes = task.errorCount || 0;
          const rowStyle =
            mistakes === 0
              ? "color:var(--success); font-weight:bold;"
              : "color:var(--error);";
          const rowText = mistakes === 0 ? "–í—ñ–¥–º—ñ–Ω–Ω–æ!" : `${mistakes} –ø–æ–º–∏–ª–æ–∫`;
          detailsHTML += `
            <div style="display:flex; justify-content:space-between; padding:15px 0; border-bottom:1px solid #f1f5f9;">
                <span style="font-weight:600; color:#475569;">–ó–∞–≤–¥–∞–Ω–Ω—è ${task.id}</span>
                <span style="${rowStyle}">${rowText}</span>
            </div>`;
        });

        root.innerHTML = `
                <div class="content-wrapper">
                    <div class="task-header-card" style="text-align:center; padding: 40px;">
                        <h1 style="font-size: 2.5rem; margin-bottom: 10px;">–í—ñ—Ç–∞—é! üéâ</h1>
                        <p style="font-size: 1.2rem;">–í–∏ –ø—Ä–æ–π—à–ª–∏ –≤—Å—ñ –∑–∞–≤–¥–∞–Ω–Ω—è.</p>
                        
                        <div style="display:flex; justify-content:center; gap:30px; margin: 40px 0;">
                             <div style="text-align:center;">
                                <div style="font-size:3.5rem; color:var(--success); font-weight:800; line-height:1;">${correctTotal}</div>
                                <div style="color:#64748b; font-weight:600;">–ü—Ä–∞–≤–∏–ª—å–Ω–æ</div>
                             </div>
                             <div style="text-align:center;">
                                <div style="font-size:3.5rem; color:var(--error); font-weight:800; line-height:1;">${wrongTotal}</div>
                                <div style="color:#64748b; font-weight:600;">–ü–æ–º–∏–ª–æ–∫</div>
                             </div>
                        </div>

                        <div style="text-align:left; background:#f8fafc; padding:20px; border-radius:12px; margin-bottom:30px;">
                            ${detailsHTML}
                        </div>

                        <button class="nav-btn primary" onclick="location.reload()">üîÑ –ü–æ—á–∞—Ç–∏ –∑–Ω–æ–≤—É</button>
                    </div>
                </div>
            `;
      }

      function checkInput(inputEl, correctValStr, rowEl) {
        if (rowEl.classList.contains("solved")) return;

        const val = inputEl.value.trim().replace(",", ".");
        const correctVariants = correctValStr.split("|");
        let isCorrect = correctVariants.includes(val);

        if (isCorrect) {
          inputEl.classList.add("correct");
          inputEl.classList.remove("wrong");
          rowEl.classList.add("solved");
          correctTotal++;
          inputEl.nextElementSibling.disabled = true;
          inputEl.nextElementSibling.style.opacity = "0.5";
        } else {
          inputEl.classList.add("wrong");
          wrongTotal++;
          lessonData[currentIndex].errorCount =
            (lessonData[currentIndex].errorCount || 0) + 1;
        }
        updateStats();
      }

      function checkChoice(btnEl, val, correctVal, rowEl) {
        if (rowEl.classList.contains("solved")) return;

        const cleanVal = val.replace(/\\\\/g, "\\");
        const cleanCorrectVal = correctVal.replace(/\\\\/g, "\\");

        if (cleanVal == cleanCorrectVal) {
          btnEl.classList.add("selected-correct");
          rowEl.classList.add("solved");
          correctTotal++;

          const btns = rowEl.querySelectorAll(".choice-btn");
          btns.forEach((b) => (b.disabled = true));
        } else {
          btnEl.classList.add("selected-wrong");
          wrongTotal++;
          lessonData[currentIndex].errorCount =
            (lessonData[currentIndex].errorCount || 0) + 1;
        }
        updateStats();
      }

      function handleEnter(e, inputEl) {
        if (e.key === "Enter") inputEl.nextElementSibling.click();
      }
      function updateStats() {
        statCorrect.innerText = correctTotal;
        statWrong.innerText = wrongTotal;
      }

      document.addEventListener("DOMContentLoaded", init);
    </script>
  </body>
</html>
