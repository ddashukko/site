<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–°—Ç–µ–ø–µ–Ω—ñ –∑ —Ü—ñ–ª–∏–º –ø–æ–∫–∞–∑–Ω–∏–∫–æ–º | Dasha Tutor</title>

    <style>
      :root {
        --primary: #4a90e2;
        --secondary: #50e3c2;
        --background: #f4f7f6;
        --success: #7ed321;
        --error: #d0021b;
        --text-color: #333;
        --border-color: #ccc;
      }

      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: var(--background);
        color: var(--text-color);
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      header {
        background: var(--primary);
        color: white;
        padding: 15px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .header-title {
        font-size: 1.5em;
        font-weight: bold;
      }

      .stats {
        display: flex;
        gap: 15px;
      }

      .stat-box {
        background: rgba(255, 255, 255, 0.2);
        padding: 5px 10px;
        border-radius: 5px;
        font-weight: bold;
      }

      .slide-container {
        flex-grow: 1;
        padding: 20px;
        max-width: 1000px;
        margin: 20px auto;
        background: white;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
      }

      footer {
        padding: 15px 20px;
        background: white;
        text-align: center;
        border-top: 1px solid var(--border-color);
        margin-top: auto;
      }

      .nav-btn {
        background: var(--primary);
        color: white;
        border: none;
        padding: 10px 20px;
        margin: 0 10px;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.3s;
      }

      .nav-btn:hover:not(:disabled) {
        background: #3b74b2;
      }

      .nav-btn:disabled {
        background: #aaa;
        cursor: not-allowed;
      }

      /* –°—Ç–∏–ª—ñ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç—É —Å–ª–∞–π–¥—É */
      .tasks-area h2 {
        color: var(--primary);
        border-bottom: 2px solid var(--border-color);
        padding-bottom: 10px;
        margin-top: 0;
      }

      .instruction {
        font-style: italic;
        margin-bottom: 20px;
        color: #555;
      }

      .subtask-row {
        display: flex;
        align-items: center;
        padding: 10px 0;
        border-bottom: 1px dashed #eee;
        gap: 15px;
      }

      .subtask-row:last-child {
        border-bottom: none;
      }

      .label {
        font-weight: bold;
        width: 30px;
        flex-shrink: 0;
      }

      .question-text {
        flex-grow: 1;
        font-size: 1.1em;
      }

      .interaction-area {
        display: flex;
        align-items: center;
        flex-shrink: 0;
        gap: 5px;
      }

      /* –ö–Ω–æ–ø–∫–∏ –≤–∏–±–æ—Ä—É */
      .choice-btn {
        background: #eee;
        border: 1px solid var(--border-color);
        padding: 8px 15px;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.2s, border-color 0.2s;
      }

      .choice-btn:hover:not(:disabled) {
        background: #ddd;
      }

      .choice-btn:disabled {
        opacity: 0.6;
      }

      .selected-correct {
        background: var(--success) !important;
        color: white;
        border-color: var(--success);
      }

      .selected-wrong {
        background: var(--error) !important;
        color: white;
        border-color: var(--error);
      }

      /* –ü–æ–ª–µ –≤–≤–æ–¥—É */
      .interaction-area input[type="text"] {
        padding: 8px;
        border: 1px solid var(--border-color);
        border-radius: 5px;
        width: 80px;
        text-align: center;
      }

      .interaction-area input.correct {
        border-color: var(--success);
        background-color: #e6ffe6;
      }

      .interaction-area input.wrong {
        border-color: var(--error);
        background-color: #ffe6e6;
      }

      .check-btn {
        background: var(--secondary);
        color: var(--text-color);
        border: none;
        padding: 8px 15px;
        border-radius: 5px;
        cursor: pointer;
      }

      /* –°—Ç–∏–ª—ñ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ */
      .results-view {
        text-align: center;
        padding: 40px;
      }

      .results-view h1 {
        color: var(--primary);
      }

      .results-summary {
        display: flex;
        justify-content: center;
        gap: 30px;
        margin: 30px 0;
      }

      .res-card {
        padding: 20px;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        width: 150px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
      }

      .res-num {
        display: block;
        font-size: 3em;
        font-weight: bold;
        margin-bottom: 5px;
      }

      .results-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }

      .results-table th,
      .results-table td {
        border: 1px solid #ddd;
        padding: 10px;
      }

      .row-perfect {
        background-color: #e6ffe6;
        color: var(--success);
        font-weight: bold;
      }

      .row-bad {
        background-color: #ffe6e6;
        color: var(--error);
      }

      .btn-restart {
        background: var(--secondary);
        color: var(--text-color);
        border: none;
        padding: 12px 25px;
        margin-top: 30px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 1.1em;
      }
    </style>
  </head>
  <body>
    <header>
      <div class="header-title">Dasha Tutor: –°—Ç–µ–ø–µ–Ω—ñ</div>
      <div class="stats">
        <div class="stat-box stat-correct">
          ‚úÖ <span id="val-correct">0</span>
        </div>
        <div class="stat-box stat-wrong">‚ùå <span id="val-wrong">0</span></div>
      </div>
      <div class="slide-counter" id="slide-counter">Start</div>
    </header>

    <div class="slide-container" id="slide-root"></div>

    <footer id="footer-nav">
      <button class="nav-btn" id="btn-prev" onclick="changeSlide(-1)">
        ‚Üê –ù–∞–∑–∞–¥
      </button>
      <button class="nav-btn" id="btn-next" onclick="changeSlide(1)">
        –î–∞–ª—ñ ‚Üí
      </button>
    </footer>

    <script>
      // =========================================================
      // –î–ê–ù–Ü –£–†–û–ö–£
      // =========================================================
      const lessonData = [
        {
          id: "10.1",
          img: "/../../images/10.1.png",
          instruction:
            "–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å '–¢–∞–∫', —è–∫—â–æ —Ä—ñ–≤–Ω—ñ—Å—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–∞ (—î —Ç–æ—Ç–æ–∂–Ω—ñ—Å—Ç—é), —ñ '–ù—ñ', —è–∫—â–æ –ø–æ–º–∏–ª–∫–æ–≤–∞.",
          type: "choice",
          tasks: [
            { label: "1)", q: "x‚Å¥ ¬∑ x‚Åª‚Å∂ = x‚Åª¬≤‚Å¥", a: "–ù—ñ", opts: ["–¢–∞–∫", "–ù—ñ"] },
            { label: "2)", q: "b‚Åµ ¬∑ b‚Åª‚Å∏ = b‚Åª¬≥", a: "–¢–∞–∫", opts: ["–¢–∞–∫", "–ù—ñ"] },
            { label: "3)", q: "y¬≥ ¬∑ y‚Åª¬≥ = y", a: "–ù—ñ", opts: ["–¢–∞–∫", "–ù—ñ"] },
            { label: "4)", q: "k‚Åπ : k‚Åª¬≥ = k¬π¬≤", a: "–¢–∞–∫", opts: ["–¢–∞–∫", "–ù—ñ"] },
            { label: "5)", q: "p¬≤ : p‚Å∂ = p‚Å¥", a: "–ù—ñ", opts: ["–¢–∞–∫", "–ù—ñ"] },
            { label: "6)", q: "(c‚Å¥)‚Åª¬≤ = c‚Åª‚Å∏", a: "–¢–∞–∫", opts: ["–¢–∞–∫", "–ù—ñ"] },
          ],
        },
        {
          id: "10.2",
          img: "/../../images/10.2.png",
          instruction:
            "–ü–æ–¥–∞–π—Ç–µ —É –≤–∏–≥–ª—è–¥—ñ —Å—Ç–µ–ø–µ–Ω—è –¥–æ–±—É—Ç–æ–∫. –û–±–µ—Ä—ñ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å.",
          type: "choice",
          tasks: [
            {
              label: "1)",
              q: "x‚Å∂ ¬∑ x‚Åª¬≥",
              a: "x¬≥",
              opts: ["x¬≥", "x‚Åπ", "x‚Åª¬≥", "x¬≤"],
            },
            {
              label: "2)",
              q: "y‚Åª‚Åµ ¬∑ y‚Å∏",
              a: "y¬≥",
              opts: ["y‚Åª¬π¬≥", "y¬≥", "y‚Å¥‚Å∞", "y‚Åª¬≥"],
            },
            {
              label: "3)",
              q: "b¬π¬≤ ¬∑ b‚Åª¬π¬≤",
              a: "1",
              opts: ["b", "0", "1", "b¬≤‚Å¥"],
            },
            {
              label: "4)",
              q: "c‚Åª‚Å∂ ¬∑ c‚Åª¬≤",
              a: "c‚Åª‚Å∏",
              opts: ["c‚Åª‚Å¥", "c¬π¬≤", "c‚Åª‚Å∏", "c‚Å∏"],
            },
          ],
        },
        {
          id: "10.4",
          img: "/../../images/10.4.png",
          instruction: "–ü–æ–¥–∞–π—Ç–µ —É –≤–∏–≥–ª—è–¥—ñ —Å—Ç–µ–ø–µ–Ω—è —á–∞—Å—Ç–∫—É.",
          type: "choice",
          tasks: [
            {
              label: "1)",
              q: "a‚Å¥ : a‚Åª¬≥",
              a: "a‚Å∑",
              opts: ["a¬π", "a‚Å∑", "a‚Åª‚Å∑", "a¬π¬≤"],
            },
            {
              label: "2)",
              q: "b‚Å∑ : b‚Åπ",
              a: "b‚Åª¬≤",
              opts: ["b¬≤", "b¬π‚Å∂", "b‚Åª¬≤", "b‚Åª¬π‚Å∂"],
            },
            {
              label: "3)",
              q: "z‚Åª‚Åµ : z‚Åª‚Åµ",
              a: "1",
              opts: ["z", "0", "z‚Åª¬π‚Å∞", "1"],
            },
            {
              label: "4)",
              q: "n‚Åª¬≤ : n‚Åª¬π‚Å∞",
              a: "n‚Å∏",
              opts: ["n‚Åª¬π¬≤", "n‚Å∏", "n‚Åª‚Å∏", "n¬π¬≤"],
            },
          ],
        },
        {
          id: "10.6",
          img: "/../../images/10.6.png",
          instruction: "–ü—ñ–¥–Ω–µ—Å—ñ—Ç—å —Å—Ç–µ–ø—ñ–Ω—å –¥–æ —Å—Ç–µ–ø–µ–Ω—è.",
          type: "choice",
          tasks: [
            {
              label: "1)",
              q: "(y‚Åª¬≥)‚Åª‚Å¥",
              a: "y¬π¬≤",
              opts: ["y‚Åª‚Å∑", "y¬π¬≤", "y‚Åª¬π¬≤", "y‚Å∑"],
            },
            {
              label: "2)",
              q: "(m‚Åª¬≤)¬π¬≤",
              a: "m‚Åª¬≤‚Å¥",
              opts: ["m‚Åª¬π‚Å∞", "m¬π‚Å∞", "m‚Åª¬≤‚Å¥", "m¬≤‚Å¥"],
            },
            { label: "3)", q: "(x‚Å∞)‚Åª‚Å∏", a: "1", opts: ["x‚Åª‚Å∏", "0", "1", "x‚Å∏"] },
            {
              label: "4)",
              q: "(k‚Åµ)‚Åª¬≥",
              a: "k‚Åª¬π‚Åµ",
              opts: ["k¬≤", "k¬π‚Åµ", "k‚Åª¬π‚Åµ", "k‚Åª‚Å∏"],
            },
          ],
        },
        {
          id: "10.10",
          img: "/../../images/10.10.png",
          instruction:
            "–û–±—á–∏—Å–ª—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è –≤–∏—Ä–∞–∑—É. –í–≤–µ–¥—ñ—Ç—å —á–∏—Å–ª–æ –∞–±–æ –æ–±–µ—Ä—ñ—Ç—å –¥—Ä—ñ–±.",
          type: "mixed",
          tasks: [
            { label: "1)", q: "3‚Å∏ ¬∑ 3‚Åª‚Å∑", a: ["3"], opts: null },
            {
              label: "2)",
              q: "4‚Åª‚Åµ ¬∑ 4",
              a: "1/256",
              opts: ["1/64", "1/256", "1/16", "-16"],
            },
            { label: "3)", q: "(1/3)‚Åª‚Å∂ ¬∑ (1/3)‚Å¥", a: ["9"], opts: null },
            { label: "4)", q: "(1/5)‚Åª‚Åπ ¬∑ (1/5)‚Å∑", a: ["25"], opts: null },
            {
              label: "5)",
              q: "2¬π‚Å∞ : 2¬π¬π",
              a: ["0.5", "0,5", "1/2"],
              opts: null,
            },
            { label: "6)", q: "5‚Åª¬π¬≤ : 5‚Åª¬π¬≥", a: ["5"], opts: null },
            { label: "7)", q: "6 : 6‚Åª¬π", a: ["36"], opts: null },
            {
              label: "8)",
              q: "(3‚Åª¬≤)¬≥",
              a: "1/729",
              opts: ["1/243", "-729", "1/729", "1/9"],
            },
            {
              label: "9)",
              q: "((1/4)‚Åª¬π)‚Åª¬≥",
              a: "1/64",
              opts: ["64", "1/64", "12", "1/12"],
            },
          ],
        },
        {
          id: "10.12",
          img: "/../../images/10.12.png",
          instruction: "–°–ø—Ä–æ—Å—Ç—ñ—Ç—å –≤–∏—Ä–∞–∑ (–æ–±–µ—Ä—ñ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç).",
          type: "choice",
          tasks: [
            {
              label: "1)",
              q: "x‚Åπ : x‚Å¥ ¬∑ x‚Åª¬π‚Åµ",
              a: "x‚Åª¬π‚Å∞",
              opts: ["x‚Åª¬≤", "x‚Åª¬π‚Å∞", "x¬≤‚Å∞", "x¬π‚Å∞"],
            },
            {
              label: "2)",
              q: "(x‚Å¥)‚Åª¬≤ ¬∑ x¬π‚Å∞",
              a: "x¬≤",
              opts: ["x¬≤", "x‚Åª¬≤", "x¬π‚Å∏", "x‚Åª¬π‚Å∏"],
            },
            {
              label: "3)",
              q: "(x‚Åª‚Å∂)¬≤ : x‚Åµ",
              a: "x‚Åª¬π‚Å∑",
              opts: ["x‚Åª‚Å∑", "x‚Åª¬π‚Å∑", "x¬π‚Å∑", "x‚Åª¬π"],
            },
            {
              label: "4)",
              q: "x‚Å∞ ¬∑ (x‚Åª¬≤)‚Åµ ¬∑ x‚Å∏",
              a: "x‚Åª¬≤",
              opts: ["x¬≤", "x‚Åª¬≤", "x‚Åª¬π‚Å∞", "1"],
            },
            {
              label: "5)",
              q: "x‚Åª‚Å¥ ¬∑ x‚Å∞ : x¬≥ : x",
              a: "x‚Åª‚Å∏",
              opts: ["x‚Åª¬π", "x‚Åª‚Å∑", "x‚Åª‚Å∏", "x‚Å∞"],
            },
            {
              label: "6)",
              q: "(x¬≤)‚Åª‚Å¥ ¬∑ (x‚Åª¬π)‚Åª‚Åµ",
              a: "x‚Åª¬≥",
              opts: ["x‚Åª¬≥", "x‚Åª¬π¬≥", "x¬≥", "x¬π¬≥"],
            },
          ],
        },
        {
          id: "10.14",
          img: "/../../images/10.14.png",
          instruction: "–°–ø—Ä–æ—Å—Ç—ñ—Ç—å –≤–∏—Ä–∞–∑ –∑ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞–º–∏.",
          type: "choice",
          tasks: [
            {
              label: "1)",
              q: "3x‚Åª‚Åµy‚Å¥ ¬∑ 6x‚Å∏y‚Åª¬≤",
              a: "18x¬≥y¬≤",
              opts: ["18x¬≥y¬≤", "9x¬≥y¬≤", "18x‚Åª¬π¬≥y¬≤", "18x¬≥y‚Åª¬≤"],
            },
            {
              label: "2)",
              q: "5a‚Åª‚Å∏b¬≥ ¬∑ 0.2a¬π‚Å∞b‚Åª‚Å∑",
              a: "a¬≤b‚Åª‚Å¥",
              opts: ["a¬≤b‚Åª‚Å¥", "5a¬≤b‚Åª‚Å¥", "a‚Åª¬π‚Å∏b‚Å¥", "a¬≤b‚Å¥"],
            },
            {
              label: "3)",
              q: "0.25p‚Åª‚Å∂q‚Å∏ ¬∑ (-12p‚Å∑q‚Åª‚Åµ)",
              a: "-3pq¬≥",
              opts: ["-3pq¬≥", "3pq¬≥", "-3p‚Åª¬π¬≥q¬≥", "-48pq¬≥"],
            },
            {
              label: "4)",
              q: "(-3/5 x‚Åª‚Å¥y‚Åª¬≤) ¬∑ (-2.5 x‚Åª¬≥y‚Åª‚Åµ)",
              a: "1.5x‚Åª‚Å∑y‚Åª‚Å∑",
              opts: ["-1.5x‚Åª‚Å∑y‚Åª‚Å∑", "1.5x‚Åª‚Å∑y‚Åª‚Å∑", "1.5x¬π¬≤y¬π‚Å∞", "x‚Åª‚Å∑y‚Åª‚Å∑"],
            },
          ],
        },
        {
          id: "10.16",
          img: "/../../images/10.16.png",
          instruction: "–ü–æ–¥–∞–π—Ç–µ —É –≤–∏–≥–ª—è–¥—ñ –¥–æ–±—É—Ç–∫—É —Å—Ç–µ–ø–µ–Ω—ñ–≤.",
          type: "choice",
          tasks: [
            {
              label: "1)",
              q: "(mn)‚Åª¬≥",
              a: "m‚Åª¬≥n‚Åª¬≥",
              opts: ["m‚Åª¬≥n‚Åª¬≥", "mn‚Åª¬≥", "m‚Åª¬≥n", "m¬≥n¬≥"],
            },
            {
              label: "2)",
              q: "(xy‚Åª¬≥)‚Åª¬≤",
              a: "x‚Åª¬≤y‚Å∂",
              opts: ["x‚Åª¬≤y‚Åª‚Å∂", "x‚Åª¬≤y‚Å∂", "x¬≤y‚Å∂", "xy‚Å∂"],
            },
            {
              label: "3)",
              q: "(a‚Åª‚Åµb¬≤)‚Åª¬π",
              a: "a‚Åµb‚Åª¬≤",
              opts: ["a‚Åª‚Åµb‚Åª¬≤", "a‚Åµb¬≤", "a‚Åµb‚Åª¬≤", "a‚Åª‚Å∂b"],
            },
            {
              label: "4)",
              q: "(k‚Å∞z‚Åª‚Å¥)‚Åª¬≥",
              a: "z¬π¬≤",
              opts: ["k‚Åª¬≥z¬π¬≤", "z¬π¬≤", "z‚Åª¬π¬≤", "k‚Å∞z¬π¬≤"],
            },
          ],
        },
        {
          id: "10.18",
          img: "/../../images/10.18.png",
          instruction: "–ü–æ–¥–∞–π—Ç–µ —É –≤–∏–≥–ª—è–¥—ñ —Å—Ç–µ–ø–µ–Ω—è –≤–∏—Ä–∞–∑ (–æ–±–µ—Ä—ñ—Ç—å —Ç–æ—Ç–æ–∂–Ω–∏–π).",
          type: "choice",
          tasks: [
            {
              label: "1)",
              q: "125x‚Åª¬≥",
              a: "(5x‚Åª¬π)¬≥",
              opts: ["(5x)‚Åª¬≥", "(5x‚Åª¬π)¬≥", "(125x)‚Åª¬≥", "5x‚Åª¬≥"],
            },
            {
              label: "2)",
              q: "0.001y‚Åª‚Å∂",
              a: "(0.1y‚Åª¬≤)¬≥",
              opts: ["(0.1y‚Åª¬≤)¬≥", "(0.1y‚Åª‚Å∂)¬≥", "(0.01y¬≤)¬≥", "(0.1y)‚Åª‚Å∂"],
            },
            {
              label: "3)",
              q: "0.0081a‚Åª‚Å¥b¬π‚Å∂",
              a: "(0.3a‚Åª¬πb‚Å¥)‚Å¥",
              opts: ["(0.3a‚Åª¬πb‚Å¥)‚Å¥", "(0.03ab‚Åª‚Å¥)‚Å¥", "(0.9a‚Åª¬πb‚Å¥)‚Å¥", "(0.3ab)‚Å¥"],
            },
            {
              label: "4)",
              q: "2 7/9 p¬π‚Å¥q‚Åª¬π‚Å∏",
              a: "(5/3 p‚Å∑q‚Åª‚Åπ)¬≤",
              opts: [
                "(5/3 p‚Å∑q‚Åª‚Åπ)¬≤",
                "(25/9 p‚Å∑q‚Åª‚Åπ)¬≤",
                "(5/3 p¬π¬≤q‚Åª¬π‚Å∂)¬≤",
                "(1.6 p‚Å∑q‚Åª‚Åπ)¬≤",
              ],
            },
          ],
        },
        {
          id: "10.21",
          img: "/../../images/10.21.png",
          instruction:
            "–ó–Ω–∞–π–¥—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è –≤–∏—Ä–∞–∑—É. –í–≤–µ–¥—ñ—Ç—å —á–∏—Å–ª–æ –∞–±–æ –æ–±–µ—Ä—ñ—Ç—å –≤–∞—Ä—ñ–∞–Ω—Ç.",
          type: "mixed",
          tasks: [
            {
              label: "1)",
              q: "81 ¬∑ 3‚Åª‚Åµ",
              a: "1/3",
              opts: ["3", "1/3", "9", "-3"],
            },
            {
              label: "2)",
              q: "27 ¬∑ (3‚Åª¬≤)¬≥",
              a: "1/27",
              opts: ["1/27", "27", "1/9", "1"],
            },
            {
              label: "3)",
              q: "2‚Åª‚Åπ ¬∑ 4‚Å∂ : 16",
              a: ["0.5", "0,5", "1/2"],
              opts: null,
            },
            { label: "4)", q: "36‚Åª¬π ¬∑ (1/6)‚Åª‚Å¥", a: ["36"], opts: null },
            { label: "5)", q: "(25‚Åª‚Å¥ ¬∑ 5‚Åª‚Å∂) / (-5)‚Åª¬π‚Å∂", a: ["25"], opts: null },
            {
              label: "6)",
              q: "(10‚Åª‚Åµ ¬∑ 2‚Åª‚Å∏) / 32‚Åª¬≥",
              a: "4/3125",
              opts: ["4/3125", "125", "2/625", "0.005"],
            },
          ],
        },
      ];
      // =========================================================

      let currentIndex = 0;
      let correctTotal = 0;
      let wrongTotal = 0;

      const root = document.getElementById("slide-root");
      const counter = document.getElementById("slide-counter");
      const statCorrect = document.getElementById("val-correct");
      const statWrong = document.getElementById("val-wrong");
      const btnPrev = document.getElementById("btn-prev");
      const btnNext = document.getElementById("btn-next");
      const footer = document.getElementById("footer-nav");

      function init() {
        if (lessonData.length > 0) {
          renderSlide(0);
        } else {
          root.innerHTML =
            "<h2 style='text-align:center; margin-top:50px; color:#555;'>–î–∞–Ω—ñ —É—Ä–æ–∫—É —â–µ –Ω–µ –¥–æ–¥–∞–Ω–æ.</h2>";
        }
      }

      function renderSlide(index) {
        currentIndex = index;
        const data = lessonData[index];

        counter.innerText = `${index + 1} / ${lessonData.length}`;
        btnPrev.disabled = index === 0;
        btnNext.innerText =
          index === lessonData.length - 1 ? "–ó–∞–≤–µ—Ä—à–∏—Ç–∏" : "–î–∞–ª—ñ ‚Üí";
        btnNext.disabled = false;

        let subTasksHTML = "";

        data.tasks.forEach((task) => {
          let inputHTML = "";

          // –Ø–∫—â–æ —î options –∞–±–æ —Ç–∏–ø —Å–ª–∞–π–¥—É choice, –ø–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫–∏
          if (task.opts && task.opts.length > 0) {
            task.opts.forEach((opt) => {
              // –ï–∫—Ä–∞–Ω—É–≤–∞–Ω–Ω—è –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ –≤ —Ñ—É–Ω–∫—Ü—ñ—é
              const cleanOpt = opt.replace(/"/g, "&quot;");
              const cleanA = Array.isArray(task.a) ? task.a[0] : task.a;
              inputHTML += `<button class="choice-btn" onclick="checkChoice(this, '${cleanOpt}', '${cleanA}', this.parentElement.parentElement)">${opt}</button>`;
            });
          } else {
            // –Ü–Ω–∞–∫—à–µ –ø–æ–ª–µ –≤–≤–æ–¥—É
            // –ü–µ—Ä–µ–¥–∞—î–º–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —è–∫ —Ä—è–¥–æ–∫ –∑ —Ä–æ–∑–¥—ñ–ª—é–≤–∞—á–µ–º, —è–∫—â–æ —ó—Ö –¥–µ–∫—ñ–ª—å–∫–∞
            const answerStr = Array.isArray(task.a) ? task.a.join("|") : task.a;
            inputHTML = `
                        <input type="text" placeholder="?" onkeypress="handleEnter(event, this)">
                        <button class="check-btn" onclick="checkInput(this.previousElementSibling, '${answerStr}', this.parentElement)">OK</button>
                    `;
          }

          subTasksHTML += `
                    <div class="subtask-row">
                        <div class="label">${task.label}</div>
                        <div class="question-text">${task.q}</div>
                        <div class="interaction-area">${inputHTML}</div>
                    </div>
                `;
        });

        root.innerHTML = `
                <div class="image-area">
                    <img src="${data.img}" class="task-img" alt="–ó–∞–≤–¥–∞–Ω–Ω—è ${data.id}" onerror="this.src='https://placehold.co/400x300?text=–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è+–Ω–µ+–∑–Ω–∞–π–¥–µ–Ω–æ';">
                </div>
                <div class="tasks-area">
                    <h2>–ó–∞–≤–¥–∞–Ω–Ω—è ‚Ññ ${data.id}</h2>
                    <p class="instruction">${data.instruction}</p>
                    <div class="subtasks-list">
                        ${subTasksHTML}
                    </div>
                </div>
            `;
      }

      function changeSlide(dir) {
        const next = currentIndex + dir;
        if (next >= lessonData.length) {
          showResults();
          return;
        }
        if (next >= 0 && next < lessonData.length) {
          renderSlide(next);
        }
      }

      function showResults() {
        footer.style.display = "none";
        counter.innerText = "–†–µ–∑—É–ª—å—Ç–∞—Ç–∏";
        let detailsHTML = "";
        lessonData.forEach((task) => {
          const mistakes = task.errorCount || 0;
          const rowClass = mistakes === 0 ? "row-perfect" : "row-bad";
          const rowText =
            mistakes === 0 ? "0 –ø–æ–º–∏–ª–æ–∫ (–ß—É–¥–æ–≤–æ!)" : `${mistakes} –ø–æ–º–∏–ª–æ–∫`;
          detailsHTML += `<tr><td>–ó–∞–≤–¥–∞–Ω–Ω—è ‚Ññ ${task.id}</td><td class="${rowClass}">${rowText}</td></tr>`;
        });

        root.innerHTML = `
                <div class="results-view">
                    <h1>–í—ñ—Ç–∞—é —ñ–∑ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è–º! üéâ</h1>
                    <div class="results-summary">
                        <div class="res-card"><span class="res-num" style="color:var(--success)">${correctTotal}</span>–ü—Ä–∞–≤–∏–ª—å–Ω–æ</div>
                        <div class="res-card"><span class="res-num" style="color:var(--error)">${wrongTotal}</span>–ü–æ–º–∏–ª–æ–∫</div>
                    </div>
                    <h3>–î–µ—Ç–∞–ª—å–Ω–∏–π –∑–≤—ñ—Ç:</h3>
                    <table class="results-table">
                        <thead><tr><th>–ó–∞–≤–¥–∞–Ω–Ω—è</th><th>–†–µ–∑—É–ª—å—Ç–∞—Ç</th></tr></thead>
                        <tbody>${detailsHTML}</tbody>
                    </table>
                    <button class="btn-restart" onclick="location.reload()">üîÑ –ü–æ—á–∞—Ç–∏ –∑–Ω–æ–≤—É</button>
                </div>
            `;
      }

      function checkInput(inputEl, correctValStr, rowEl) {
        if (rowEl.classList.contains("solved")) return;

        // –û—á–∏—â–∞—î–º–æ –≤–≤—ñ–¥ (–∑–∞–º—ñ–Ω—é—î–º–æ –∫–æ–º—É –Ω–∞ –∫—Ä–∞–ø–∫—É, –≤–∏–¥–∞–ª—è—î–º–æ –ø—Ä–æ–±—ñ–ª–∏)
        const val = inputEl.value.trim().replace(",", ".");

        // –†–æ–∑–±–∏–≤–∞—î–º–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ "0.5|0,5|1/2")
        const correctVariants = correctValStr.split("|");

        let isCorrect = correctVariants.includes(val);

        if (isCorrect) {
          inputEl.classList.add("correct");
          inputEl.classList.remove("wrong");
          rowEl.classList.add("solved");
          correctTotal++;
          // –ë–ª–æ–∫—É—î–º–æ –∫–Ω–æ–ø–∫—É
          inputEl.nextElementSibling.disabled = true;
          inputEl.nextElementSibling.style.opacity = "0.5";
        } else {
          inputEl.classList.add("wrong");
          wrongTotal++;
          lessonData[currentIndex].errorCount =
            (lessonData[currentIndex].errorCount || 0) + 1;
        }
        updateStats();
      }

      function checkChoice(btnEl, val, correctVal, rowEl) {
        if (rowEl.classList.contains("solved")) return;
        if (val == correctVal) {
          btnEl.classList.add("selected-correct");
          rowEl.classList.add("solved");
          correctTotal++;
          // –í–∏–º–∏–∫–∞—î–º–æ —ñ–Ω—à—ñ –∫–Ω–æ–ø–∫–∏ –≤ —Ü—å–æ–º—É —Ä—è–¥–∫—É
          const btns = rowEl.querySelectorAll(".choice-btn");
          btns.forEach((b) => (b.disabled = true));
        } else {
          btnEl.classList.add("selected-wrong");
          wrongTotal++;
          lessonData[currentIndex].errorCount =
            (lessonData[currentIndex].errorCount || 0) + 1;
        }
        updateStats();
      }

      function handleEnter(e, inputEl) {
        if (e.key === "Enter") inputEl.nextElementSibling.click();
      }
      function updateStats() {
        statCorrect.innerText = correctTotal;
        statWrong.innerText = wrongTotal;
      }

      init();
    </script>
  </body>
</html>
