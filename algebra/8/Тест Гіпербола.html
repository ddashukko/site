<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–¢–µ—Å—Ç: –§—É–Ω–∫—Ü—ñ—è y = k/x</title>

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
    />
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
    ></script>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    ></script>

    <style>
      :root {
        --primary: #4f46e5;
        --primary-hover: #4338ca;
        --bg: #f3f4f6;
        --card: #ffffff;
        --text: #1f2937;
        --success: #16a34a;
        --success-bg: #dcfce7;
        --error: #dc2626;
        --error-bg: #fee2e2;
        --border: #e5e7eb;
        --grid-color: #e2e8f0;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background-color: var(--bg);
        color: var(--text);
        margin: 0;
        padding: 0;
        height: 100vh;
        display: flex;
        overflow: hidden; /* –©–æ–± –Ω–µ –±—É–ª–æ –ø–æ–¥–≤—ñ–π–Ω–æ–≥–æ —Å–∫—Ä–æ–ª—É */
      }

      /* --- –õ–Ü–í–ê –ß–ê–°–¢–ò–ù–ê (–¢–ï–°–¢) --- */
      #tasks-section {
        flex: 1;
        background: var(--bg);
        overflow-y: auto;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .container {
        width: 100%;
        max-width: 800px;
        padding-bottom: 50px;
      }

      header {
        background: var(--card);
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 15px;
        position: sticky;
        top: 0;
        z-index: 10;
      }

      .title {
        font-size: 1.5rem;
        font-weight: 800;
        color: var(--primary);
        margin: 0;
      }

      .timer {
        font-family: monospace;
        font-size: 1.2rem;
        background: #e0e7ff;
        color: var(--primary);
        padding: 5px 15px;
        border-radius: 8px;
        font-weight: bold;
      }

      .quiz-card {
        background: var(--card);
        border-radius: 12px;
        padding: 25px;
        margin-bottom: 20px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        border: 2px solid transparent;
        transition: transform 0.2s;
      }

      .question-number {
        font-size: 0.9rem;
        color: #6b7280;
        font-weight: 600;
        margin-bottom: 10px;
        text-transform: uppercase;
      }

      .question-text {
        font-size: 1.2rem;
        font-weight: 500;
        margin-bottom: 20px;
        line-height: 1.5;
      }

      .options-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
      }

      .option-label {
        display: flex;
        align-items: center;
        padding: 15px;
        border: 2px solid var(--border);
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s;
        font-size: 1.05rem;
        position: relative;
      }

      .option-label:hover {
        border-color: var(--primary);
        background: #eef2ff;
      }

      .option-input {
        margin-right: 12px;
        transform: scale(1.2);
        accent-color: var(--primary);
      }

      /* –°—Ç–∏–ª—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ */
      .quiz-card.checked-correct {
        border-color: var(--success);
      }
      .quiz-card.checked-wrong {
        border-color: var(--error);
      }

      .option-label.status-correct {
        background-color: var(--success-bg);
        border-color: var(--success);
        color: var(--success);
        font-weight: bold;
      }

      .option-label.status-wrong {
        background-color: var(--error-bg);
        border-color: var(--error);
        color: var(--error);
        text-decoration: line-through;
      }

      .option-label.status-missed {
        border-color: var(--success);
        background-color: #f0fdf4;
        box-shadow: 0 0 0 2px var(--success);
      }
      .option-label.status-missed::after {
        content: "üëà –¶–µ –ø—Ä–∞–≤–∏–ª—å–Ω–∞";
        position: absolute;
        right: 10px;
        font-size: 0.8rem;
        color: var(--success);
        font-weight: bold;
      }

      .text-answer {
        width: 100%;
        padding: 15px;
        font-size: 1.1rem;
        border: 2px solid var(--border);
        border-radius: 8px;
        box-sizing: border-box;
        outline: none;
      }
      .text-answer:focus {
        border-color: var(--primary);
      }

      .text-answer.status-correct {
        border-color: var(--success);
        background-color: var(--success-bg);
        color: #064e3b;
      }
      .text-answer.status-wrong {
        border-color: var(--error);
        background-color: var(--error-bg);
        color: #7f1d1d;
      }

      .correct-answer-text {
        margin-top: 10px;
        color: var(--error);
        font-weight: bold;
        font-size: 0.95rem;
      }

      .btn-submit {
        display: block;
        width: 100%;
        padding: 15px;
        background: var(--primary);
        color: white;
        border: none;
        border-radius: 10px;
        font-size: 1.2rem;
        font-weight: bold;
        cursor: pointer;
        margin-top: 30px;
        transition: background 0.2s;
      }
      .btn-submit:hover {
        background: var(--primary-hover);
      }
      .btn-submit:disabled {
        background: #9ca3af;
        cursor: not-allowed;
      }

      /* --- –ü–†–ê–í–ê –ß–ê–°–¢–ò–ù–ê (–î–û–®–ö–ê) --- */
      #board-section {
        flex: 1;
        position: relative;
        background-color: #fff;
        border-left: 4px solid #cbd5e1;
        background-image: linear-gradient(
            var(--grid-color) 1px,
            transparent 1px
          ),
          linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
        background-size: 25px 25px;
        cursor: crosshair;
        overflow: hidden;
      }

      canvas {
        display: block;
        width: 100%;
        height: 100%;
        touch-action: none;
      }

      .tools {
        position: absolute;
        top: 15px;
        left: 15px;
        display: flex;
        gap: 10px;
        background: rgba(255, 255, 255, 0.95);
        padding: 8px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        border: 1px solid var(--border);
        flex-wrap: wrap;
        z-index: 5;
      }

      .btn-tool {
        border: 1px solid #cbd5e1;
        background: white;
        padding: 8px 12px;
        border-radius: 5px;
        cursor: pointer;
        font-weight: bold;
        font-size: 1.2rem;
        transition: 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
        min-width: 40px;
      }
      .btn-tool:hover {
        background: #f1f5f9;
      }
      .btn-tool.active {
        background: var(--primary);
        color: white;
        border-color: var(--primary);
      }

      /* --- –ú–û–î–ê–õ–¨–ù–ï –í–Ü–ö–ù–û --- */
      .result-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(5px);
        z-index: 1000;
        justify-content: center;
        align-items: center;
      }

      .result-card {
        background: white;
        padding: 40px;
        border-radius: 20px;
        max-width: 500px;
        width: 90%;
        text-align: center;
        animation: slideUp 0.3s ease;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      }

      .score-circle {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        background: var(--primary);
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 2.5rem;
        font-weight: bold;
        margin: 0 auto 20px;
      }

      .modal-buttons {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin-top: 20px;
      }

      .btn-secondary {
        background: #374151;
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
      }
      .btn-secondary:hover {
        background: #1f2937;
      }

      .btn-restart {
        background: var(--primary);
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
      }
      .btn-restart:hover {
        background: var(--primary-hover);
      }

      @keyframes slideUp {
        from {
          transform: translateY(50px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å */
      @media (max-width: 768px) {
        body {
          flex-direction: column;
        }
        #board-section {
          height: 35vh;
          border-left: none;
          border-top: 4px solid #cbd5e1;
          order: 2;
        }
        #tasks-section {
          height: 65vh;
          order: 1;
        }
        .options-grid {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div id="tasks-section">
      <div class="container">
        <header>
          <div class="title">–ü—ñ–¥—Å—É–º–∫–æ–≤–∏–π —Ç–µ—Å—Ç: –ì—ñ–ø–µ—Ä–±–æ–ª–∞</div>
          <div class="timer" id="timer">00:00</div>
        </header>

        <form id="quiz-form"></form>

        <button
          type="button"
          id="submit-btn"
          class="btn-submit"
          onclick="finishTest()"
        >
          –ó–∞–≤–µ—Ä—à–∏—Ç–∏ —Ç–µ—Å—Ç
        </button>
      </div>
    </div>

    <div id="board-section">
      <div class="tools">
        <button
          class="btn-tool active"
          onclick="setTool('pen')"
          id="t-pen"
          title="–†—É—á–∫–∞"
        >
          üñäÔ∏è
        </button>
        <button
          class="btn-tool"
          onclick="setTool('eraser')"
          id="t-eraser"
          title="–ì—É–º–∫–∞"
        >
          üßπ
        </button>
        <button
          class="btn-tool"
          onclick="drawSystem()"
          title="–î–æ–¥–∞—Ç–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω—É –ø—Ä—è–º—É"
        >
          üìâ
        </button>
        <button
          class="btn-tool"
          onclick="clearCanvasSafe()"
          style="color: red; border-color: #fee2e2"
          title="–û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å–µ"
        >
          ‚ùå
        </button>
      </div>
      <canvas id="board"></canvas>
    </div>

    <div class="result-overlay" id="result-modal">
      <div class="result-card">
        <h2 style="margin-top: 0">–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è</h2>
        <div class="score-circle" id="final-score">0</div>
        <p style="font-size: 1.1rem; color: #4b5563; margin-bottom: 20px">
          –ü—Ä–∞–≤–∏–ª—å–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π: <span id="correct-count">0</span> –∑
          <span id="total-count">0</span>
        </p>
        <div
          id="feedback-msg"
          style="font-weight: bold; margin-bottom: 20px"
        ></div>

        <div class="modal-buttons">
          <button class="btn-secondary" onclick="closeModalReview()">
            –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ø–æ–º–∏–ª–∫–∏
          </button>
          <button class="btn-restart" onclick="location.reload()">
            –ü—Ä–æ–π—Ç–∏ —â–µ —Ä–∞–∑
          </button>
        </div>
      </div>
    </div>

    <script>
      /* --- 1. –õ–û–ì–Ü–ö–ê –î–û–®–ö–ò (CANVAS) --- */
      const canvas = document.getElementById("board");
      const ctx = canvas.getContext("2d");
      const boardSection = document.getElementById("board-section");
      let painting = false;
      let tool = "pen";

      function resizeCanvas() {
        const temp = document.createElement("canvas");
        const tempCtx = temp.getContext("2d");
        temp.width = canvas.width;
        temp.height = canvas.height;
        if (canvas.width > 0 && canvas.height > 0) {
          tempCtx.drawImage(canvas, 0, 0);
        }

        canvas.width = boardSection.offsetWidth;
        canvas.height = boardSection.offsetHeight;

        ctx.drawImage(temp, 0, 0);
        ctx.lineCap = "round";
        ctx.lineJoin = "round";
      }

      window.addEventListener("resize", resizeCanvas);
      window.addEventListener("load", resizeCanvas);

      function getMousePos(e) {
        const rect = canvas.getBoundingClientRect();
        const clientX = e.touches ? e.touches[0].clientX : e.clientX;
        const clientY = e.touches ? e.touches[0].clientY : e.clientY;
        return { x: clientX - rect.left, y: clientY - rect.top };
      }

      function startPosition(e) {
        painting = true;
        draw(e);
      }

      function finishedPosition() {
        painting = false;
        ctx.beginPath();
      }

      function draw(e) {
        if (!painting) return;
        const pos = getMousePos(e);

        if (tool === "pen") {
          ctx.lineWidth = 2;
          ctx.strokeStyle = "#4f46e5"; // Primary color
          ctx.globalCompositeOperation = "source-over";
        } else {
          ctx.lineWidth = 25;
          ctx.strokeStyle = "#ffffff";
          ctx.globalCompositeOperation = "destination-out";
        }

        ctx.lineTo(pos.x, pos.y);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(pos.x, pos.y);
      }

      canvas.addEventListener("mousedown", startPosition);
      canvas.addEventListener("mouseup", finishedPosition);
      canvas.addEventListener("mousemove", draw);
      canvas.addEventListener("mouseout", finishedPosition);
      canvas.addEventListener("touchstart", startPosition);
      canvas.addEventListener("touchend", finishedPosition);
      canvas.addEventListener("touchmove", draw);

      function setTool(t) {
        tool = t;
        document
          .getElementById("t-pen")
          .classList.toggle("active", t === "pen");
        document
          .getElementById("t-eraser")
          .classList.toggle("active", t === "eraser");
      }

      function clearCanvasSafe() {
        if (confirm("–û—á–∏—Å—Ç–∏—Ç–∏ –¥–æ—à–∫—É?")) {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
        }
      }

      function drawSystem() {
        const prevStrokeStyle = ctx.strokeStyle;
        const prevLineWidth = ctx.lineWidth;
        const prevComposite = ctx.globalCompositeOperation;

        ctx.globalCompositeOperation = "source-over";
        ctx.strokeStyle = "#334155";
        ctx.lineWidth = 2;
        ctx.fillStyle = "#334155";
        ctx.font = "16px Arial";

        const w = canvas.width;
        const h = canvas.height;
        const cx = Math.floor(w / 2);
        const cy = Math.floor(h / 2);
        const step = 25;

        // Draw Axes
        ctx.beginPath();
        ctx.moveTo(0, cy);
        ctx.lineTo(w, cy); // X
        ctx.moveTo(cx, h);
        ctx.lineTo(cx, 0); // Y
        ctx.stroke();

        // Draw Grid Marks
        ctx.beginPath();
        ctx.lineWidth = 1;
        for (let x = cx + step; x < w; x += step) {
          ctx.moveTo(x, cy - 3);
          ctx.lineTo(x, cy + 3);
        }
        for (let x = cx - step; x > 0; x -= step) {
          ctx.moveTo(x, cy - 3);
          ctx.lineTo(x, cy + 3);
        }
        for (let y = cy + step; y < h; y += step) {
          ctx.moveTo(cx - 3, y);
          ctx.lineTo(cx + 3, y);
        }
        for (let y = cy - step; y > 0; y -= step) {
          ctx.moveTo(cx - 3, y);
          ctx.lineTo(cx + 3, y);
        }
        ctx.stroke();

        // Restore state
        ctx.beginPath();
        ctx.strokeStyle = prevStrokeStyle;
        ctx.lineWidth = prevLineWidth;
        ctx.globalCompositeOperation = prevComposite;
        if (tool === "eraser") setTool("pen");
      }

      /* --- 2. –õ–û–ì–Ü–ö–ê –¢–ï–°–¢–£ --- */
      const questions = [
        {
          id: 1,
          type: "radio",
          q: "–û–±–µ—Ä—ñ—Ç—å —Ñ–æ—Ä–º—É–ª—É, —è–∫–æ—é –∑–∞–¥–∞—î—Ç—å—Å—è –æ–±–µ—Ä–Ω–µ–Ω–∞ –ø—Ä–æ–ø–æ—Ä—Ü—ñ–π–Ω—ñ—Å—Ç—å:",
          options: ["$y = kx$", "$y = \\frac{k}{x}$", "$y = x + k$"],
          correct: 1,
        },
        {
          id: 2,
          type: "radio",
          q: "–Ø–∫ –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è –≥—Ä–∞—Ñ—ñ–∫ —Ñ—É–Ω–∫—Ü—ñ—ó $y = \\frac{k}{x}$ ($k \\ne 0$)?",
          options: ["–ü–∞—Ä–∞–±–æ–ª–∞", "–ü—Ä—è–º–∞", "–ì—ñ–ø–µ—Ä–±–æ–ª–∞"],
          correct: 2,
        },
        {
          id: 3,
          type: "radio",
          q: "–£ —è–∫–∏—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω–∏—Ö –∫—É—Ç–∞—Ö —Ä–æ–∑–º—ñ—â–µ–Ω–∏–π –≥—Ä–∞—Ñ—ñ–∫ —Ñ—É–Ω–∫—Ü—ñ—ó $y = \\frac{15}{x}$?",
          options: ["I —ñ II", "I —ñ III", "II —ñ IV"],
          correct: 1,
        },
        {
          id: 4,
          type: "radio",
          q: "–£ —è–∫–∏—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω–∏—Ö –∫—É—Ç–∞—Ö —Ä–æ–∑–º—ñ—â–µ–Ω–∏–π –≥—Ä–∞—Ñ—ñ–∫ —Ñ—É–Ω–∫—Ü—ñ—ó $y = -\\frac{9}{x}$?",
          options: ["I —ñ III", "II —ñ IV", "I —ñ IV"],
          correct: 1,
        },
        {
          id: 5,
          type: "input",
          q: "–§—É–Ω–∫—Ü—ñ—é –∑–∞–¥–∞–Ω–æ —Ñ–æ—Ä–º—É–ª–æ—é $y = \\frac{24}{x}$. –ó–Ω–∞–π–¥—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫—â–æ $x = -6$.",
          correct: ["-4"],
        },
        {
          id: 6,
          type: "input",
          q: "–§—É–Ω–∫—Ü—ñ—é –∑–∞–¥–∞–Ω–æ —Ñ–æ—Ä–º—É–ª–æ—é $y = -\\frac{16}{x}$. –ó–Ω–∞–π–¥—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è –∞—Ä–≥—É–º–µ–Ω—Ç—É, –ø—Ä–∏ —è–∫–æ–º—É $y = 4$.",
          correct: ["-4"],
        },
        {
          id: 7,
          type: "radio",
          q: "–ß–∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –≥—Ä–∞—Ñ—ñ–∫ —Ñ—É–Ω–∫—Ü—ñ—ó $y = \\frac{50}{x}$ —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É $A(5; 10)$?",
          options: ["–¢–∞–∫", "–ù—ñ"],
          correct: 0,
        },
        {
          id: 8,
          type: "radio",
          q: "–ß–∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –≥—Ä–∞—Ñ—ñ–∫ —Ñ—É–Ω–∫—Ü—ñ—ó $y = -\\frac{12}{x}$ —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É $B(4; 3)$?",
          options: ["–¢–∞–∫", "–ù—ñ"],
          correct: 1,
        },
        {
          id: 9,
          type: "input",
          q: "–ì—Ä–∞—Ñ—ñ–∫ –æ–±–µ—Ä–Ω–µ–Ω–æ—ó –ø—Ä–æ–ø–æ—Ä—Ü—ñ–π–Ω–æ—Å—Ç—ñ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É $M(-2; 8)$. –ó–Ω–∞–π–¥—ñ—Ç—å –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç $k$.",
          correct: ["-16"],
        },
        {
          id: 10,
          type: "radio",
          q: "–î–∞–Ω–æ —Ñ—É–Ω–∫—Ü—ñ—é $y = \\frac{10}{x}$. –ü–æ—Ä—ñ–≤–Ω—è–π—Ç–µ –∑–Ω–∞—á–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è $x_1 = 2$ —Ç–∞ $x_2 = 5$.",
          options: ["$y(2) > y(5)$", "$y(2) < y(5)$", "$y(2) = y(5)$"],
          correct: 0,
        },
        {
          id: 11,
          type: "input",
          q: "–Ø–∫–µ —á–∏—Å–ª–æ –Ω–µ –≤—Ö–æ–¥–∏—Ç—å –¥–æ –æ–±–ª–∞—Å—Ç—ñ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó $y = \\frac{k}{x}$?",
          correct: ["0"],
        },
        {
          id: 12,
          type: "radio",
          q: "–Ø–∫—â–æ $x$ –∑–±—ñ–ª—å—à–∏—Ç–∏ –≤ 3 —Ä–∞–∑–∏ (–ø—Ä–∏ –Ω–µ–∑–º—ñ–Ω–Ω–æ–º—É –¥–æ–¥–∞—Ç–Ω–æ–º—É $k$), —Ç–æ –∑–Ω–∞—á–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó $y = \\frac{k}{x}$...",
          options: [
            "–∑–±—ñ–ª—å—à–∏—Ç—å—Å—è –≤ 3 —Ä–∞–∑–∏",
            "–∑–º–µ–Ω—à–∏—Ç—å—Å—è –≤ 3 —Ä–∞–∑–∏",
            "–Ω–µ –∑–º—ñ–Ω–∏—Ç—å—Å—è",
          ],
          correct: 1,
        },
      ];

      const form = document.getElementById("quiz-form");
      let timerInterval;

      // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –ø–∏—Ç–∞–Ω—å
      questions.forEach((item, index) => {
        const card = document.createElement("div");
        card.className = "quiz-card";
        card.id = `card-${index}`;

        const number = document.createElement("div");
        number.className = "question-number";
        number.textContent = `–ü–∏—Ç–∞–Ω–Ω—è ${index + 1} –∑ ${questions.length}`;

        const text = document.createElement("div");
        text.className = "question-text";
        text.innerHTML = item.q;

        card.appendChild(number);
        card.appendChild(text);

        if (item.type === "radio") {
          const grid = document.createElement("div");
          grid.className = "options-grid";

          item.options.forEach((opt, i) => {
            const label = document.createElement("label");
            label.className = "option-label";
            label.id = `opt-label-${index}-${i}`;

            const input = document.createElement("input");
            input.type = "radio";
            input.name = `q${item.id}`;
            input.value = i;
            input.className = "option-input";

            const span = document.createElement("span");
            span.innerHTML = opt;

            label.appendChild(input);
            label.appendChild(span);
            grid.appendChild(label);
          });
          card.appendChild(grid);
        } else if (item.type === "input") {
          const input = document.createElement("input");
          input.type = "text";
          input.className = "text-answer";
          input.placeholder = "–í–≤–µ–¥—ñ—Ç—å –≤–∞—à—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å...";
          input.name = `q${item.id}`;
          input.id = `input-${index}`;
          input.setAttribute("autocomplete", "off");
          card.appendChild(input);

          const feedbackDiv = document.createElement("div");
          feedbackDiv.id = `feedback-${index}`;
          feedbackDiv.className = "correct-answer-text";
          card.appendChild(feedbackDiv);
        }

        form.appendChild(card);
      });

      // –¢–∞–π–º–µ—Ä
      let seconds = 0;
      timerInterval = setInterval(() => {
        seconds++;
        const mins = Math.floor(seconds / 60)
          .toString()
          .padStart(2, "0");
        const secs = (seconds % 60).toString().padStart(2, "0");
        document.getElementById("timer").textContent = `${mins}:${secs}`;
      }, 1000);

      // KaTeX
      document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
          delimiters: [
            { left: "$$", right: "$$", display: true },
            { left: "$", right: "$", display: false },
          ],
        });
      });

      // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞
      function finishTest() {
        if (!confirm("–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –∑–∞–≤–µ—Ä—à–∏—Ç–∏ —Ç–µ—Å—Ç?")) return;

        clearInterval(timerInterval);
        document.getElementById("submit-btn").disabled = true;

        let correctAnswers = 0;
        const total = questions.length;
        const scale = 12;

        questions.forEach((item, index) => {
          const card = document.getElementById(`card-${index}`);
          let isCorrect = false;

          if (item.type === "radio") {
            const inputs = document.querySelectorAll(
              `input[name="q${item.id}"]`
            );
            let userSelected = -1;

            inputs.forEach((input) => {
              input.disabled = true;
              if (input.checked) userSelected = parseInt(input.value);
            });

            if (userSelected === item.correct) {
              isCorrect = true;
              const correctLabel = document.getElementById(
                `opt-label-${index}-${item.correct}`
              );
              correctLabel.classList.add("status-correct");
            } else {
              if (userSelected !== -1) {
                const wrongLabel = document.getElementById(
                  `opt-label-${index}-${userSelected}`
                );
                wrongLabel.classList.add("status-wrong");
              }
              const missedLabel = document.getElementById(
                `opt-label-${index}-${item.correct}`
              );
              missedLabel.classList.add("status-missed");
            }
          } else if (item.type === "input") {
            const input = document.getElementById(`input-${index}`);
            const feedback = document.getElementById(`feedback-${index}`);
            const val = input.value.trim().replace(",", ".");

            input.disabled = true;

            if (item.correct.includes(val)) {
              isCorrect = true;
              input.classList.add("status-correct");
            } else {
              input.classList.add("status-wrong");
              feedback.textContent = `–ü—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å: ${item.correct[0]}`;
            }
          }

          if (isCorrect) {
            correctAnswers++;
            card.classList.add("checked-correct");
          } else {
            card.classList.add("checked-wrong");
          }
        });

        const finalScore = Math.round((correctAnswers / total) * scale);

        document.getElementById("final-score").textContent = finalScore;
        document.getElementById("correct-count").textContent = correctAnswers;
        document.getElementById("total-count").textContent = total;

        const msgDiv = document.getElementById("feedback-msg");
        if (finalScore >= 10) {
          msgDiv.textContent = "–ß—É–¥–æ–≤–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –¢–∏ –ø—Ä–æ—Ñ—ñ! üèÜ";
          msgDiv.style.color = "var(--success)";
        } else if (finalScore >= 7) {
          msgDiv.textContent = "–î–æ–±—Ä–µ! –ê–ª–µ —î –Ω–∞–¥ —á–∏–º –ø—Ä–∞—Ü—é–≤–∞—Ç–∏. üëç";
          msgDiv.style.color = "#d97706";
        } else {
          msgDiv.textContent = "–í–∞—Ä—Ç–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏ —Ç–µ–º—É —â–µ —Ä–∞–∑. üìö";
          msgDiv.style.color = "var(--error)";
        }

        document.getElementById("result-modal").style.display = "flex";
      }

      function closeModalReview() {
        document.getElementById("result-modal").style.display = "none";
        // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ —Ç—ñ–ª—å–∫–∏ –ª—ñ–≤–æ—ó —á–∞—Å—Ç–∏–Ω–∏ (—Ç–µ—Å—Ç—É)
        const tasksSection = document.getElementById("tasks-section");
        tasksSection.scrollTo({ top: 0, behavior: "smooth" });
      }
    </script>
  </body>
</html>
