<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–µ–æ–º–µ—Ç—Ä–∏—á–Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å—ñ—è: –Ü–Ω—Ç–µ–Ω—Å–∏–≤</title>
    
    <script>
        window.MathJax = {
            tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$']] },
            svg: { fontCache: 'global' }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        :root {
            --primary: #4f46e5;
            --primary-light: #e0e7ff;
            --success: #10b981;
            --danger: #ef4444;
            --bg: #f9fafb;
            --text-main: #1f2937;
            --text-muted: #6b7280;
            --white: #ffffff;
            --radius: 16px;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Inter', system-ui, -apple-system, sans-serif; background: var(--bg); color: var(--text-main); height: 100vh; overflow: hidden; }

        .app-wrapper { display: flex; height: 100vh; width: 100vw; }

        /* –õ–Ü–í–ê –ß–ê–°–¢–ò–ù–ê - –ö–û–ù–¢–ï–ù–¢ */
        .content-section {
            flex: 1.2;
            overflow-y: auto;
            padding: 40px;
            background: var(--white);
            border-right: 1px solid #e5e7eb;
            scroll-behavior: smooth;
        }

        header { margin-bottom: 30px; }
        .badge { background: var(--primary-light); color: var(--primary); padding: 4px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: 700; margin-bottom: 10px; display: inline-block; }
        h1 { font-size: 2.2rem; font-weight: 800; letter-spacing: -0.025em; }

        .theory-details {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: var(--radius);
            margin-bottom: 30px;
            overflow: hidden;
        }
        .theory-details summary { padding: 20px; font-weight: 700; cursor: pointer; list-style: none; display: flex; align-items: center; gap: 10px; }
        .theory-details summary::before { content: 'üìò'; }
        .theory-content { padding: 0 20px 20px 20px; line-height: 1.6; }

        .task-card {
            background: var(--white);
            border: 1px solid #f1f5f9;
            border-radius: var(--radius);
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        .task-card:hover { transform: translateY(-3px); box-shadow: var(--shadow); border-color: var(--primary-light); }
        .task-num { color: var(--primary); font-weight: 800; font-size: 1.1rem; margin-bottom: 12px; display: block; }

        /* –í–ê–†–Ü–ê–ù–¢–ò –í–Ü–î–ü–û–í–Ü–î–ï–ô */
        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
            margin: 20px 0;
        }
        .option-btn {
            padding: 14px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            background: var(--white);
            cursor: pointer;
            text-align: center;
            font-weight: 600;
            transition: all 0.2s;
        }
        .option-btn:hover { border-color: var(--primary); background: var(--primary-light); }
        .option-btn.selected { border-color: var(--primary); background: var(--primary); color: white; }
        .option-btn.correct { border-color: var(--success); background: var(--success); color: white; }
        .option-btn.wrong { border-color: var(--danger); background: var(--danger); color: white; }

        .controls { display: flex; gap: 10px; margin-top: 15px; }
        .btn { padding: 10px 18px; border-radius: 10px; border: none; font-weight: 700; cursor: pointer; transition: 0.2s; font-size: 0.9rem; }
        .btn-check { background: var(--primary); color: white; }
        .btn-hint { background: #f3f4f6; color: var(--text-muted); }
        .btn-sol { background: #fff7ed; color: #9a3412; }

        .info-panel { display: none; margin-top: 15px; padding: 15px; border-radius: 10px; font-size: 0.95rem; line-height: 1.5; }
        .hint-panel { background: #f0fdfa; border-left: 4px solid var(--success); }
        .sol-panel { background: #eff6ff; border-left: 4px solid var(--primary); }

        /* –ü–†–ê–í–ê –ß–ê–°–¢–ò–ù–ê - –î–û–®–ö–ê */
        .whiteboard-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #ffffff;
            position: relative;
        }
        .wb-toolbar {
            background: #1e293b;
            padding: 12px;
            display: flex;
            gap: 12px;
            align-items: center;
            justify-content: center;
        }
        .wb-tool { background: #334155; border: none; padding: 10px 15px; border-radius: 8px; color: white; cursor: pointer; font-weight: 600; transition: 0.2s; }
        .wb-tool:hover { background: #475569; }
        .wb-tool.active { background: var(--primary); box-shadow: 0 0 10px var(--primary); }
        
        #canvas { flex-grow: 1; cursor: crosshair; touch-action: none; background: #fafafa; }

        @media (max-width: 1024px) {
            .app-wrapper { flex-direction: column; overflow-y: auto; }
            .content-section, .whiteboard-section { height: auto; min-height: 100vh; flex: none; width: 100%; }
            .whiteboard-section { height: 500px; border-top: 4px solid #ddd; }
        }

        .finish-screen { display: none; text-align: center; padding: 60px 20px; }
    </style>
</head>
<body>

<div class="app-wrapper">
    <div class="content-section" id="scroll-container">
        <header>
            <span class="badge">–ê–ª–≥–µ–±—Ä–∞ 9 –∫–ª–∞—Å</span>
            <h1>–ì–µ–æ–º–µ—Ç—Ä–∏—á–Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å—ñ—è</h1>
            <p style="color: var(--text-muted); margin-top: 5px;">–ü–æ–≤–Ω–∏–π —Ä–æ–∑–±—ñ—Ä –∑–∞–≤–¥–∞–Ω—å ‚Ññ 18.7 ‚Äî 18.44</p>
        </header>

        <details class="theory-details">
            <summary>–®–ø–∞—Ä–≥–∞–ª–∫–∞ (–¢–µ–æ—Ä—ñ—è)</summary>
            <div class="theory-content">
                <p>1. <b>–§–æ—Ä–º—É–ª–∞ $n$-–≥–æ —á–ª–µ–Ω–∞:</b> $b_n = b_1 \cdot q^{n-1}$</p>
                <p>2. <b>–ó–Ω–∞–º–µ–Ω–Ω–∏–∫:</b> $q = \frac{b_{n+1}}{b_n}$</p>
                <p>3. <b>–í–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å:</b> $b_n^2 = b_{n-1} \cdot b_{n+1}$</p>
                <p>4. <b>–°—É–º–∞ $n$ –ø–µ—Ä—à–∏—Ö —á–ª–µ–Ω—ñ–≤:</b> $S_n = \frac{b_1(q^n - 1)}{q - 1}$</p>
            </div>
        </details>

        <div id="tasks-mount"></div>

        <div id="footer-actions" style="padding: 40px 0;">
            <button class="btn btn-check" style="width: 100%; padding: 20px; font-size: 1.2rem;" onclick="finishLesson()">–ó–∞–≤–µ—Ä—à–∏—Ç–∏ —É—Ä–æ–∫ —Ç–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –æ—Ü—ñ–Ω–∫—É</button>
        </div>

        <div id="finish-screen" class="finish-screen">
            <h2 style="font-size: 3rem; color: var(--primary);">–ì–æ—Ç–æ–≤–æ! üöÄ</h2>
            <p id="final-stats" style="font-size: 1.2rem; margin: 20px 0;"></p>
            <p id="praise-text" style="font-weight: bold; color: var(--success); font-size: 1.4rem;"></p>
            <button class="btn btn-check" style="margin-top: 30px;" onclick="location.reload()">–ü–æ–≤—Ç–æ—Ä–∏—Ç–∏ —ñ–Ω—Ç–µ–Ω—Å–∏–≤</button>
        </div>
    </div>

    <div class="whiteboard-section">
        <div class="wb-toolbar">
            <button class="wb-tool active" id="tool-pen" onclick="setTool('pen')">‚úèÔ∏è –û–ª—ñ–≤–µ—Ü—å</button>
            <button class="wb-tool" id="tool-eraser" onclick="setTool('eraser')">üßº –ì—É–º–∫–∞</button>
            <button class="wb-tool" onclick="quickTriangle()">üìê –¢—Ä–∏–∫—É—Ç–Ω–∏–∫</button>
            <button class="wb-tool" onclick="clearCanvas()" style="background: var(--danger);">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏</button>
        </div>
        <canvas id="canvas"></canvas>
    </div>
</div>

<script>
    const taskData = [
        { id: "18.7", q: "–°—å–æ–º–∏–π —á–ª–µ–Ω –¥–æ—Ä—ñ–≤–Ω—é—î $1/2$, –∑–Ω–∞–º–µ–Ω–Ω–∏–∫ $4$. –ó–Ω–∞–π–¥—ñ—Ç—å $b_6$.", options: ["1/8", "2", "1/4", "1"], correct: "1/8", hint: "$b_6 = b_7 / q$", sol: "$b_6 = \\frac{1}{2} : 4 = \\frac{1}{8}$" },
        { id: "18.8", q: "–ó–Ω–∞–π–¥—ñ—Ç—å —á–µ—Ç–≤–µ—Ä—Ç–∏–π —á–ª–µ–Ω –ø—Ä–æ–≥—Ä–µ—Å—ñ—ó $(x_n)$, —è–∫—â–æ $x_1 = 0.2, q = -5$.", options: ["-25", "25", "-5", "10"], correct: "-25", hint: "$x_4 = x_1 \\cdot q^3$", sol: "$0.2 \\cdot (-5)^3 = 0.2 \\cdot (-125) = -25$" },
        { id: "18.10", q: "–£ –ø—Ä–æ–≥—Ä–µ—Å—ñ—ó $y_1=64, q=-1/2$. –ó–Ω–∞–π–¥—ñ—Ç—å $y_3$.", options: ["16", "-16", "32", "-32"], correct: "16", hint: "$y_3 = y_1 \\cdot q^2$", sol: "$64 \\cdot (-1/2)^2 = 64 \\cdot 1/4 = 16$" },
        { id: "18.13", q: "–ó–Ω–∞–π–¥—ñ—Ç—å –∑–Ω–∞–º–µ–Ω–Ω–∏–∫ $q$ –¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—ñ—ó: $1/216, 1/36, 1/6, \\dots$", options: ["6", "1/6", "36", "1/36"], correct: "6", hint: "$q = b_2 / b_1$", sol: "$\\frac{1}{36} : \\frac{1}{216} = \\frac{216}{36} = 6$" },
        { id: "18.14", q: "–ó–Ω–∞–π–¥—ñ—Ç—å –∑–Ω–∞–º–µ–Ω–Ω–∏–∫ –ø—Ä–æ–≥—Ä–µ—Å—ñ—ó $18, 12, 8, \\dots$", options: ["2/3", "3/2", "1/2", "4/3"], correct: "2/3", hint: "$q = 12/18$", sol: "$q = \\frac{12}{18} = \\frac{2}{3}$" },
        { id: "18.17", q: "–í–∫–ª–∞–¥ 5000 –≥—Ä–Ω –ø—ñ–¥ 8% —Ä—ñ—á–Ω–∏—Ö. –°–∫—ñ–ª—å–∫–∏ –±—É–¥–µ —á–µ—Ä–µ–∑ 3 —Ä–æ–∫–∏? (–û–∫—Ä—É–≥–ª–∏—Ç–∏)", options: ["6299 –≥—Ä–Ω", "6000 –≥—Ä–Ω", "5800 –≥—Ä–Ω", "6500 –≥—Ä–Ω"], correct: "6299 –≥—Ä–Ω", hint: "$S = 5000 \\cdot (1.08)^3$", sol: "$5000 \\cdot 1.2597 \\approx 6298.56$" },
        { id: "18.19", q: "–¶—ñ–Ω–∞ –ø—ñ—Å–ª—è –¥–≤–æ—Ö –∑–Ω–∏–∂–æ–∫ –Ω–∞ 10% —Å—Ç–∞–ª–∞ 2916 –≥—Ä–Ω. –ü–æ—á–∞—Ç–∫–æ–≤–∞ —Ü—ñ–Ω–∞?", options: ["3600 –≥—Ä–Ω", "3200 –≥—Ä–Ω", "3500 –≥—Ä–Ω", "4000 –≥—Ä–Ω"], correct: "3600 –≥—Ä–Ω", hint: "$x \\cdot 0.9^2 = 2916$", sol: "$x = 2916 / 0.81 = 3600$" },
        { id: "18.25", q: "–ó–Ω–∞–π–¥—ñ—Ç—å $q$, —è–∫—â–æ $b_1 = 1/2, b_8 = 64$.", options: ["2", "4", "2.5", "3"], correct: "2", hint: "$q^7 = b_8 / b_1$", sol: "$q^7 = 64 / (1/2) = 128 = 2^7$" },
        { id: "18.27", q: "–ó–Ω–∞–π–¥—ñ—Ç—å –Ω–æ–º–µ—Ä —á–ª–µ–Ω–∞ 486 —É –ø—Ä–æ–≥—Ä–µ—Å—ñ—ó $2, 6, 18, \\dots$", options: ["6", "5", "7", "8"], correct: "6", hint: "$486 = 2 \\cdot 3^{n-1}$", sol: "$243 = 3^5 \\implies n-1=5 \\implies n=6$" },
        { id: "18.34", q: "–ü—Ä–∏ —è–∫–æ–º—É $x$ —á–∏—Å–ª–∞ $x, 3x, 18$ —î –≥–µ–æ–º–µ—Ç—Ä–∏—á–Ω–æ—é –ø—Ä–æ–≥—Ä–µ—Å—ñ—î—é?", options: ["2", "4", "6", "1"], correct: "2", hint: "$(3x)^2 = 18x$", sol: "$9x^2 = 18x \\implies x = 2$" },
        { id: "18.36", q: "$b_2 = 6$. –ó–Ω–∞–π–¥—ñ—Ç—å –¥–æ–±—É—Ç–æ–∫ –ø–µ—Ä—à–∏—Ö —Ç—Ä—å–æ—Ö —á–ª–µ–Ω—ñ–≤.", options: ["216", "36", "18", "108"], correct: "216", hint: "$b_1 b_2 b_3 = b_2^3$", sol: "$6^3 = 216$" },
        { id: "18.43", q: "–í—Å—Ç–∞–≤—Ç–µ 3 —á–∏—Å–ª–∞ –º—ñ–∂ 80 —ñ 5, —â–æ–± —É—Ç–≤–æ—Ä–∏–ª–∞—Å—å –ø—Ä–æ–≥—Ä–µ—Å—ñ—è.", options: ["40, 20, 10", "60, 40, 20", "40, 30, 15", "50, 25, 12"], correct: "40, 20, 10", hint: "$b_1=80, b_5=5$. –ó–Ω–∞–π–¥—ñ—Ç—å $q$.", sol: "$q^4 = 5/80 = 1/16 \\implies q=1/2$" }
    ];

    const tasksMount = document.getElementById('tasks-mount');
    let userAnswers = {};

    taskData.forEach((task, index) => {
        const card = document.createElement('div');
        card.className = 'task-card';
        card.innerHTML = `
            <span class="task-num">–ó–∞–≤–¥–∞–Ω–Ω—è ‚Ññ ${task.id}</span>
            <p>${task.q}</p>
            <div class="options-grid" id="opts-${index}">
                ${task.options.map(opt => `
                    <div class="option-btn" onclick="selectOption(${index}, '${opt}', this)">${opt}</div>
                `).join('')}
            </div>
            <div class="controls">
                <button class="btn btn-check" onclick="checkTask(${index})">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
                <button class="btn btn-hint" onclick="toggleInfo('hint-${index}')">–ü—ñ–¥–∫–∞–∑–∫–∞</button>
                <button class="btn btn-sol" onclick="toggleInfo('sol-${index}')">–†–æ–∑–≤'—è–∑–∞–Ω–Ω—è</button>
            </div>
            <div id="hint-${index}" class="info-panel hint-panel">üí° ${task.hint}</div>
            <div id="sol-${index}" class="info-panel sol-panel">‚úÖ <b>–•—ñ–¥ –¥—É–º–æ–∫:</b> ${task.sol}</div>
        `;
        tasksMount.appendChild(card);
    });

    function selectOption(idx, val, el) {
        const parent = document.getElementById(`opts-${idx}`);
        parent.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
        el.classList.add('selected');
        userAnswers[idx] = val;
    }

    function checkTask(idx) {
        const parent = document.getElementById(`opts-${idx}`);
        const selected = parent.querySelector('.option-btn.selected');
        if (!selected) return;

        const isCorrect = userAnswers[idx] === taskData[idx].correct;
        selected.classList.remove('selected');
        selected.classList.add(isCorrect ? 'correct' : 'wrong');
        
        if (!isCorrect) {
            parent.querySelectorAll('.option-btn').forEach(b => {
                if (b.innerText === taskData[idx].correct) b.classList.add('correct');
            });
        }
    }

    function toggleInfo(id) {
        const el = document.getElementById(id);
        el.style.display = el.style.display === 'block' ? 'none' : 'block';
    }

    function finishLesson() {
        document.getElementById('tasks-mount').style.display = 'none';
        document.getElementById('footer-actions').style.display = 'none';
        const finish = document.getElementById('finish-screen');
        finish.style.display = 'block';

        let correctCount = 0;
        Object.keys(userAnswers).forEach(idx => {
            if(userAnswers[idx] === taskData[idx].correct) correctCount++;
        });

        const score = Math.round((correctCount / taskData.length) * 12);
        document.getElementById('final-stats').innerText = `–í–∏ –≤—ñ—Ä–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–ª–∏ –Ω–∞ ${correctCount} –∑ ${taskData.length} –ø–∏—Ç–∞–Ω—å. –í–∞—à–∞ –æ—Ü—ñ–Ω–∫–∞: ${score}/12`;
        
        const phrases = ["–§–∞–Ω—Ç–∞—Å—Ç–∏—á–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! üî•", "–¢–∏ ‚Äî –º–∞–π—Å—Ç–µ—Ä –ø—Ä–æ–≥—Ä–µ—Å—ñ–π! üèÜ", "–ß—É–¥–æ–≤–∞ —Ä–æ–±–æ—Ç–∞, —Ç–∞–∫ —Ç—Ä–∏–º–∞—Ç–∏! üåü", "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ —Ç–µ–±–µ –ª—é–±–∏—Ç—å! üìà"];
        document.getElementById('praise-text').innerText = phrases[Math.floor(Math.random()*phrases.length)];
    }

    // --- –î–û–®–ö–ê ---
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let drawing = false;
    let tool = 'pen';

    function resize() {
        canvas.width = canvas.offsetWidth;
        canvas.height = canvas.offsetHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    function setTool(t) {
        tool = t;
        document.querySelectorAll('.wb-tool').forEach(b => b.classList.remove('active'));
        document.getElementById(`tool-${t}`).classList.add('active');
    }

    canvas.addEventListener('mousedown', start);
    canvas.addEventListener('mousemove', move);
    canvas.addEventListener('mouseup', end);

    function start(e) { drawing = true; draw(e); }
    function end() { drawing = false; ctx.beginPath(); }
    function move(e) { if (drawing) draw(e); }

    function draw(e) {
        const rect = canvas.getBoundingClientRect();
        ctx.lineWidth = tool === 'eraser' ? 40 : 3;
        ctx.lineCap = 'round';
        ctx.strokeStyle = tool === 'eraser' ? '#fafafa' : '#4f46e5';

        ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
    }

    function clearCanvas() { ctx.clearRect(0, 0, canvas.width, canvas.height); }

    function quickTriangle() {
        ctx.strokeStyle = '#4f46e5';
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(100, 100); ctx.lineTo(50, 200); ctx.lineTo(150, 200); ctx.closePath();
        ctx.stroke();
    }
</script>

</body>
</html>